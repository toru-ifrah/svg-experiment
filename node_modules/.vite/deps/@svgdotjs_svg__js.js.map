{
  "version": 3,
  "sources": ["../../@svgdotjs/svg.js/src/utils/methods.js", "../../@svgdotjs/svg.js/src/utils/utils.js", "../../@svgdotjs/svg.js/src/modules/core/namespaces.js", "../../@svgdotjs/svg.js/src/utils/window.js", "../../@svgdotjs/svg.js/src/types/Base.js", "../../@svgdotjs/svg.js/src/utils/adopter.js", "../../@svgdotjs/svg.js/src/modules/optional/arrange.js", "../../@svgdotjs/svg.js/src/modules/core/regex.js", "../../@svgdotjs/svg.js/src/modules/optional/class.js", "../../@svgdotjs/svg.js/src/modules/optional/css.js", "../../@svgdotjs/svg.js/src/modules/optional/data.js", "../../@svgdotjs/svg.js/src/modules/optional/memory.js", "../../@svgdotjs/svg.js/src/types/Color.js", "../../@svgdotjs/svg.js/src/types/Point.js", "../../@svgdotjs/svg.js/src/types/Matrix.js", "../../@svgdotjs/svg.js/src/modules/core/parser.js", "../../@svgdotjs/svg.js/src/types/Box.js", "../../@svgdotjs/svg.js/src/types/List.js", "../../@svgdotjs/svg.js/src/modules/core/selector.js", "../../@svgdotjs/svg.js/src/modules/core/event.js", "../../@svgdotjs/svg.js/src/types/EventTarget.js", "../../@svgdotjs/svg.js/src/modules/core/defaults.js", "../../@svgdotjs/svg.js/src/types/SVGArray.js", "../../@svgdotjs/svg.js/src/types/SVGNumber.js", "../../@svgdotjs/svg.js/src/modules/core/attr.js", "../../@svgdotjs/svg.js/src/elements/Dom.js", "../../@svgdotjs/svg.js/src/elements/Element.js", "../../@svgdotjs/svg.js/src/modules/optional/sugar.js", "../../@svgdotjs/svg.js/src/modules/optional/transform.js", "../../@svgdotjs/svg.js/src/elements/Container.js", "../../@svgdotjs/svg.js/src/elements/Defs.js", "../../@svgdotjs/svg.js/src/elements/Shape.js", "../../@svgdotjs/svg.js/src/modules/core/circled.js", "../../@svgdotjs/svg.js/src/elements/Ellipse.js", "../../@svgdotjs/svg.js/src/elements/Fragment.js", "../../@svgdotjs/svg.js/src/modules/core/gradiented.js", "../../@svgdotjs/svg.js/src/elements/Gradient.js", "../../@svgdotjs/svg.js/src/elements/Pattern.js", "../../@svgdotjs/svg.js/src/elements/Image.js", "../../@svgdotjs/svg.js/src/types/PointArray.js", "../../@svgdotjs/svg.js/src/modules/core/pointed.js", "../../@svgdotjs/svg.js/src/elements/Line.js", "../../@svgdotjs/svg.js/src/elements/Marker.js", "../../@svgdotjs/svg.js/src/animation/Controller.js", "../../@svgdotjs/svg.js/src/utils/pathParser.js", "../../@svgdotjs/svg.js/src/types/PathArray.js", "../../@svgdotjs/svg.js/src/animation/Morphable.js", "../../@svgdotjs/svg.js/src/elements/Path.js", "../../@svgdotjs/svg.js/src/modules/core/poly.js", "../../@svgdotjs/svg.js/src/elements/Polygon.js", "../../@svgdotjs/svg.js/src/elements/Polyline.js", "../../@svgdotjs/svg.js/src/elements/Rect.js", "../../@svgdotjs/svg.js/src/animation/Queue.js", "../../@svgdotjs/svg.js/src/animation/Animator.js", "../../@svgdotjs/svg.js/src/animation/Timeline.js", "../../@svgdotjs/svg.js/src/animation/Runner.js", "../../@svgdotjs/svg.js/src/elements/Svg.js", "../../@svgdotjs/svg.js/src/elements/Symbol.js", "../../@svgdotjs/svg.js/src/modules/core/textable.js", "../../@svgdotjs/svg.js/src/elements/Text.js", "../../@svgdotjs/svg.js/src/elements/Tspan.js", "../../@svgdotjs/svg.js/src/elements/Circle.js", "../../@svgdotjs/svg.js/src/elements/ClipPath.js", "../../@svgdotjs/svg.js/src/elements/ForeignObject.js", "../../@svgdotjs/svg.js/src/modules/core/containerGeometry.js", "../../@svgdotjs/svg.js/src/elements/G.js", "../../@svgdotjs/svg.js/src/elements/A.js", "../../@svgdotjs/svg.js/src/elements/Mask.js", "../../@svgdotjs/svg.js/src/elements/Stop.js", "../../@svgdotjs/svg.js/src/elements/Style.js", "../../@svgdotjs/svg.js/src/elements/TextPath.js", "../../@svgdotjs/svg.js/src/elements/Use.js", "../../@svgdotjs/svg.js/src/main.js"],
  "sourcesContent": ["const methods = {}\nconst names = []\n\nexport function registerMethods (name, m) {\n  if (Array.isArray(name)) {\n    for (const _name of name) {\n      registerMethods(_name, m)\n    }\n    return\n  }\n\n  if (typeof name === 'object') {\n    for (const _name in name) {\n      registerMethods(_name, name[_name])\n    }\n    return\n  }\n\n  addMethodNames(Object.getOwnPropertyNames(m))\n  methods[name] = Object.assign(methods[name] || {}, m)\n}\n\nexport function getMethodsFor (name) {\n  return methods[name] || {}\n}\n\nexport function getMethodNames () {\n  return [ ...new Set(names) ]\n}\n\nexport function addMethodNames (_names) {\n  names.push(..._names)\n}\n", "// Map function\nexport function map (array, block) {\n  let i\n  const il = array.length\n  const result = []\n\n  for (i = 0; i < il; i++) {\n    result.push(block(array[i]))\n  }\n\n  return result\n}\n\n// Filter function\nexport function filter (array, block) {\n  let i\n  const il = array.length\n  const result = []\n\n  for (i = 0; i < il; i++) {\n    if (block(array[i])) {\n      result.push(array[i])\n    }\n  }\n\n  return result\n}\n\n// Degrees to radians\nexport function radians (d) {\n  return d % 360 * Math.PI / 180\n}\n\n// Radians to degrees\nexport function degrees (r) {\n  return r * 180 / Math.PI % 360\n}\n\n// Convert dash-separated-string to camelCase\nexport function camelCase (s) {\n  return s.toLowerCase().replace(/-(.)/g, function (m, g) {\n    return g.toUpperCase()\n  })\n}\n\n// Convert camel cased string to dash separated\nexport function unCamelCase (s) {\n  return s.replace(/([A-Z])/g, function (m, g) {\n    return '-' + g.toLowerCase()\n  })\n}\n\n// Capitalize first letter of a string\nexport function capitalize (s) {\n  return s.charAt(0).toUpperCase() + s.slice(1)\n}\n\n// Calculate proportional width and height values when necessary\nexport function proportionalSize (element, width, height, box) {\n  if (width == null || height == null) {\n    box = box || element.bbox()\n\n    if (width == null) {\n      width = box.width / box.height * height\n    } else if (height == null) {\n      height = box.height / box.width * width\n    }\n  }\n\n  return {\n    width: width,\n    height: height\n  }\n}\n\n/**\n * This function adds support for string origins.\n * It searches for an origin in o.origin o.ox and o.originX.\n * This way, origin: {x: 'center', y: 50} can be passed as well as ox: 'center', oy: 50\n**/\nexport function getOrigin (o, element) {\n  const origin = o.origin\n  // First check if origin is in ox or originX\n  let ox = o.ox != null\n    ? o.ox\n    : o.originX != null\n      ? o.originX\n      : 'center'\n  let oy = o.oy != null\n    ? o.oy\n    : o.originY != null\n      ? o.originY\n      : 'center'\n\n  // Then check if origin was used and overwrite in that case\n  if (origin != null) {\n    [ ox, oy ] = Array.isArray(origin)\n      ? origin\n      : typeof origin === 'object'\n        ? [ origin.x, origin.y ]\n        : [ origin, origin ]\n  }\n\n  // Make sure to only call bbox when actually needed\n  const condX = typeof ox === 'string'\n  const condY = typeof oy === 'string'\n  if (condX || condY) {\n    const { height, width, x, y } = element.bbox()\n\n    // And only overwrite if string was passed for this specific axis\n    if (condX) {\n      ox = ox.includes('left')\n        ? x\n        : ox.includes('right')\n          ? x + width\n          : x + width / 2\n    }\n\n    if (condY) {\n      oy = oy.includes('top')\n        ? y\n        : oy.includes('bottom')\n          ? y + height\n          : y + height / 2\n    }\n  }\n\n  // Return the origin as it is if it wasn't a string\n  return [ ox, oy ]\n}\n", "// Default namespaces\nexport const svg = 'http://www.w3.org/2000/svg'\nexport const html = 'http://www.w3.org/1999/xhtml'\nexport const xmlns = 'http://www.w3.org/2000/xmlns/'\nexport const xlink = 'http://www.w3.org/1999/xlink'\nexport const svgjs = 'http://svgjs.dev/svgjs'\n", "export const globals = {\n  window: typeof window === 'undefined' ? null : window,\n  document: typeof document === 'undefined' ? null : document\n}\n\nexport function registerWindow (win = null, doc = null) {\n  globals.window = win\n  globals.document = doc\n}\n\nconst save = {}\n\nexport function saveWindow () {\n  save.window = globals.window\n  save.document = globals.document\n}\n\nexport function restoreWindow () {\n  globals.window = save.window\n  globals.document = save.document\n}\n\nexport function withWindow (win, fn) {\n  saveWindow()\n  registerWindow(win, win.document)\n  fn(win, win.document)\n  restoreWindow()\n}\n\nexport function getWindow () {\n  return globals.window\n}\n", "export default class Base {\n  // constructor (node/*, {extensions = []} */) {\n  //   // this.tags = []\n  //   //\n  //   // for (let extension of extensions) {\n  //   //   extension.setup.call(this, node)\n  //   //   this.tags.push(extension.name)\n  //   // }\n  // }\n}\n", "import { addMethodNames } from './methods.js'\nimport { capitalize } from './utils.js'\nimport { svg } from '../modules/core/namespaces.js'\nimport { globals } from '../utils/window.js'\nimport Base from '../types/Base.js'\n\nconst elements = {}\nexport const root = '___SYMBOL___ROOT___'\n\n// Method for element creation\nexport function create (name, ns = svg) {\n  // create element\n  return globals.document.createElementNS(ns, name)\n}\n\nexport function makeInstance (element, isHTML = false) {\n  if (element instanceof Base) return element\n\n  if (typeof element === 'object') {\n    return adopter(element)\n  }\n\n  if (element == null) {\n    return new elements[root]()\n  }\n\n  if (typeof element === 'string' && element.charAt(0) !== '<') {\n    return adopter(globals.document.querySelector(element))\n  }\n\n  // Make sure, that HTML elements are created with the correct namespace\n  const wrapper = isHTML ? globals.document.createElement('div') : create('svg')\n  wrapper.innerHTML = element\n\n  // We can use firstChild here because we know,\n  // that the first char is < and thus an element\n  element = adopter(wrapper.firstChild)\n\n  // make sure, that element doesn't have its wrapper attached\n  wrapper.removeChild(wrapper.firstChild)\n  return element\n}\n\nexport function nodeOrNew (name, node) {\n  return (node && node.ownerDocument && node instanceof node.ownerDocument.defaultView.Node) ? node : create(name)\n}\n\n// Adopt existing svg elements\nexport function adopt (node) {\n  // check for presence of node\n  if (!node) return null\n\n  // make sure a node isn't already adopted\n  if (node.instance instanceof Base) return node.instance\n\n  if (node.nodeName === '#document-fragment') {\n    return new elements.Fragment(node)\n  }\n\n  // initialize variables\n  let className = capitalize(node.nodeName || 'Dom')\n\n  // Make sure that gradients are adopted correctly\n  if (className === 'LinearGradient' || className === 'RadialGradient') {\n    className = 'Gradient'\n\n  // Fallback to Dom if element is not known\n  } else if (!elements[className]) {\n    className = 'Dom'\n  }\n\n  return new elements[className](node)\n}\n\nlet adopter = adopt\n\nexport function mockAdopt (mock = adopt) {\n  adopter = mock\n}\n\nexport function register (element, name = element.name, asRoot = false) {\n  elements[name] = element\n  if (asRoot) elements[root] = element\n\n  addMethodNames(Object.getOwnPropertyNames(element.prototype))\n\n  return element\n}\n\nexport function getClass (name) {\n  return elements[name]\n}\n\n// Element id sequence\nlet did = 1000\n\n// Get next named element id\nexport function eid (name) {\n  return 'Svgjs' + capitalize(name) + (did++)\n}\n\n// Deep new id assignment\nexport function assignNewId (node) {\n  // do the same for SVG child nodes as well\n  for (let i = node.children.length - 1; i >= 0; i--) {\n    assignNewId(node.children[i])\n  }\n\n  if (node.id) {\n    node.id = eid(node.nodeName)\n    return node\n  }\n\n  return node\n}\n\n// Method for extending objects\nexport function extend (modules, methods) {\n  let key, i\n\n  modules = Array.isArray(modules) ? modules : [ modules ]\n\n  for (i = modules.length - 1; i >= 0; i--) {\n    for (key in methods) {\n      modules[i].prototype[key] = methods[key]\n    }\n  }\n}\n\nexport function wrapWithAttrCheck (fn) {\n  return function (...args) {\n    const o = args[args.length - 1]\n\n    if (o && o.constructor === Object && !(o instanceof Array)) {\n      return fn.apply(this, args.slice(0, -1)).attr(o)\n    } else {\n      return fn.apply(this, args)\n    }\n  }\n}\n", "import { makeInstance } from '../../utils/adopter.js'\nimport { registerMethods } from '../../utils/methods.js'\n\n// Get all siblings, including myself\nexport function siblings () {\n  return this.parent().children()\n}\n\n// Get the current position siblings\nexport function position () {\n  return this.parent().index(this)\n}\n\n// Get the next element (will return null if there is none)\nexport function next () {\n  return this.siblings()[this.position() + 1]\n}\n\n// Get the next element (will return null if there is none)\nexport function prev () {\n  return this.siblings()[this.position() - 1]\n}\n\n// Send given element one step forward\nexport function forward () {\n  const i = this.position()\n  const p = this.parent()\n\n  // move node one step forward\n  p.add(this.remove(), i + 1)\n\n  return this\n}\n\n// Send given element one step backward\nexport function backward () {\n  const i = this.position()\n  const p = this.parent()\n\n  p.add(this.remove(), i ? i - 1 : 0)\n\n  return this\n}\n\n// Send given element all the way to the front\nexport function front () {\n  const p = this.parent()\n\n  // Move node forward\n  p.add(this.remove())\n\n  return this\n}\n\n// Send given element all the way to the back\nexport function back () {\n  const p = this.parent()\n\n  // Move node back\n  p.add(this.remove(), 0)\n\n  return this\n}\n\n// Inserts a given element before the targeted element\nexport function before (element) {\n  element = makeInstance(element)\n  element.remove()\n\n  const i = this.position()\n\n  this.parent().add(element, i)\n\n  return this\n}\n\n// Inserts a given element after the targeted element\nexport function after (element) {\n  element = makeInstance(element)\n  element.remove()\n\n  const i = this.position()\n\n  this.parent().add(element, i + 1)\n\n  return this\n}\n\nexport function insertBefore (element) {\n  element = makeInstance(element)\n  element.before(this)\n  return this\n}\n\nexport function insertAfter (element) {\n  element = makeInstance(element)\n  element.after(this)\n  return this\n}\n\nregisterMethods('Dom', {\n  siblings,\n  position,\n  next,\n  prev,\n  forward,\n  backward,\n  front,\n  back,\n  before,\n  after,\n  insertBefore,\n  insertAfter\n})\n", "// Parse unit value\nexport const numberAndUnit = /^([+-]?(\\d+(\\.\\d*)?|\\.\\d+)(e[+-]?\\d+)?)([a-z%]*)$/i\n\n// Parse hex value\nexport const hex = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i\n\n// Parse rgb value\nexport const rgb = /rgb\\((\\d+),(\\d+),(\\d+)\\)/\n\n// Parse reference id\nexport const reference = /(#[a-z_][a-z0-9\\-_]*)/i\n\n// splits a transformation chain\nexport const transforms = /\\)\\s*,?\\s*/\n\n// Whitespace\nexport const whitespace = /\\s/g\n\n// Test hex value\nexport const isHex = /^#[a-f0-9]{3}$|^#[a-f0-9]{6}$/i\n\n// Test rgb value\nexport const isRgb = /^rgb\\(/\n\n// Test for blank string\nexport const isBlank = /^(\\s+)?$/\n\n// Test for numeric string\nexport const isNumber = /^[+-]?(\\d+(\\.\\d*)?|\\.\\d+)(e[+-]?\\d+)?$/i\n\n// Test for image url\nexport const isImage = /\\.(jpg|jpeg|png|gif|svg)(\\?[^=]+.*)?/i\n\n// split at whitespace and comma\nexport const delimiter = /[\\s,]+/\n\n// Test for path letter\nexport const isPathLetter = /[MLHVCSQTAZ]/i\n", "import { delimiter } from '../core/regex.js'\nimport { registerMethods } from '../../utils/methods.js'\n\n// Return array of classes on the node\nexport function classes () {\n  const attr = this.attr('class')\n  return attr == null ? [] : attr.trim().split(delimiter)\n}\n\n// Return true if class exists on the node, false otherwise\nexport function hasClass (name) {\n  return this.classes().indexOf(name) !== -1\n}\n\n// Add class to the node\nexport function addClass (name) {\n  if (!this.hasClass(name)) {\n    const array = this.classes()\n    array.push(name)\n    this.attr('class', array.join(' '))\n  }\n\n  return this\n}\n\n// Remove class from the node\nexport function removeClass (name) {\n  if (this.hasClass(name)) {\n    this.attr('class', this.classes().filter(function (c) {\n      return c !== name\n    }).join(' '))\n  }\n\n  return this\n}\n\n// Toggle the presence of a class on the node\nexport function toggleClass (name) {\n  return this.hasClass(name) ? this.removeClass(name) : this.addClass(name)\n}\n\nregisterMethods('Dom', {\n  classes, hasClass, addClass, removeClass, toggleClass\n})\n", "import { camelCase } from '../../utils/utils.js'\nimport { isBlank } from '../core/regex.js'\nimport { registerMethods } from '../../utils/methods.js'\n\n// Dynamic style generator\nexport function css (style, val) {\n  const ret = {}\n  if (arguments.length === 0) {\n    // get full style as object\n    this.node.style.cssText.split(/\\s*;\\s*/)\n      .filter(function (el) {\n        return !!el.length\n      })\n      .forEach(function (el) {\n        const t = el.split(/\\s*:\\s*/)\n        ret[t[0]] = t[1]\n      })\n    return ret\n  }\n\n  if (arguments.length < 2) {\n    // get style properties as array\n    if (Array.isArray(style)) {\n      for (const name of style) {\n        const cased = camelCase(name)\n        ret[name] = this.node.style[cased]\n      }\n      return ret\n    }\n\n    // get style for property\n    if (typeof style === 'string') {\n      return this.node.style[camelCase(style)]\n    }\n\n    // set styles in object\n    if (typeof style === 'object') {\n      for (const name in style) {\n        // set empty string if null/undefined/'' was given\n        this.node.style[camelCase(name)]\n          = (style[name] == null || isBlank.test(style[name])) ? '' : style[name]\n      }\n    }\n  }\n\n  // set style for property\n  if (arguments.length === 2) {\n    this.node.style[camelCase(style)]\n      = (val == null || isBlank.test(val)) ? '' : val\n  }\n\n  return this\n}\n\n// Show element\nexport function show () {\n  return this.css('display', '')\n}\n\n// Hide element\nexport function hide () {\n  return this.css('display', 'none')\n}\n\n// Is element visible?\nexport function visible () {\n  return this.css('display') !== 'none'\n}\n\nregisterMethods('Dom', {\n  css, show, hide, visible\n})\n", "import { registerMethods } from '../../utils/methods.js'\nimport { filter, map } from '../../utils/utils.js'\n\n// Store data values on svg nodes\nexport function data (a, v, r) {\n  if (a == null) {\n    // get an object of attributes\n    return this.data(map(filter(this.node.attributes, (el) => el.nodeName.indexOf('data-') === 0), (el) => el.nodeName.slice(5)))\n  } else if (a instanceof Array) {\n    const data = {}\n    for (const key of a) {\n      data[key] = this.data(key)\n    }\n    return data\n  } else if (typeof a === 'object') {\n    for (v in a) {\n      this.data(v, a[v])\n    }\n  } else if (arguments.length < 2) {\n    try {\n      return JSON.parse(this.attr('data-' + a))\n    } catch (e) {\n      return this.attr('data-' + a)\n    }\n  } else {\n    this.attr('data-' + a,\n      v === null\n        ? null\n        : r === true || typeof v === 'string' || typeof v === 'number'\n          ? v\n          : JSON.stringify(v)\n    )\n  }\n\n  return this\n}\n\nregisterMethods('Dom', { data })\n", "import { registerMethods } from '../../utils/methods.js'\n\n// Remember arbitrary data\nexport function remember (k, v) {\n  // remember every item in an object individually\n  if (typeof arguments[0] === 'object') {\n    for (const key in k) {\n      this.remember(key, k[key])\n    }\n  } else if (arguments.length === 1) {\n    // retrieve memory\n    return this.memory()[k]\n  } else {\n    // store memory\n    this.memory()[k] = v\n  }\n\n  return this\n}\n\n// Erase a given memory\nexport function forget () {\n  if (arguments.length === 0) {\n    this._memory = {}\n  } else {\n    for (let i = arguments.length - 1; i >= 0; i--) {\n      delete this.memory()[arguments[i]]\n    }\n  }\n  return this\n}\n\n// This triggers creation of a new hidden class which is not performant\n// However, this function is not rarely used so it will not happen frequently\n// Return local memory object\nexport function memory () {\n  return (this._memory = this._memory || {})\n}\n\nregisterMethods('Dom', { remember, forget, memory })\n", "\nimport { hex, isHex, isRgb, rgb, whitespace } from '../modules/core/regex.js'\n\nfunction sixDigitHex (hex) {\n  return hex.length === 4\n    ? [ '#',\n      hex.substring(1, 2), hex.substring(1, 2),\n      hex.substring(2, 3), hex.substring(2, 3),\n      hex.substring(3, 4), hex.substring(3, 4)\n    ].join('')\n    : hex\n}\n\nfunction componentHex (component) {\n  const integer = Math.round(component)\n  const bounded = Math.max(0, Math.min(255, integer))\n  const hex = bounded.toString(16)\n  return hex.length === 1 ? '0' + hex : hex\n}\n\nfunction is (object, space) {\n  for (let i = space.length; i--;) {\n    if (object[space[i]] == null) {\n      return false\n    }\n  }\n  return true\n}\n\nfunction getParameters (a, b) {\n  const params = is(a, 'rgb')\n    ? { _a: a.r, _b: a.g, _c: a.b, _d: 0, space: 'rgb' }\n    : is(a, 'xyz')\n      ? { _a: a.x, _b: a.y, _c: a.z, _d: 0, space: 'xyz' }\n      : is(a, 'hsl')\n        ? { _a: a.h, _b: a.s, _c: a.l, _d: 0, space: 'hsl' }\n        : is(a, 'lab')\n          ? { _a: a.l, _b: a.a, _c: a.b, _d: 0, space: 'lab' }\n          : is(a, 'lch')\n            ? { _a: a.l, _b: a.c, _c: a.h, _d: 0, space: 'lch' }\n            : is(a, 'cmyk')\n              ? { _a: a.c, _b: a.m, _c: a.y, _d: a.k, space: 'cmyk' }\n              : { _a: 0, _b: 0, _c: 0, space: 'rgb' }\n\n  params.space = b || params.space\n  return params\n}\n\nfunction cieSpace (space) {\n  if (space === 'lab' || space === 'xyz' || space === 'lch') {\n    return true\n  } else {\n    return false\n  }\n}\n\nfunction hueToRgb (p, q, t) {\n  if (t < 0) t += 1\n  if (t > 1) t -= 1\n  if (t < 1 / 6) return p + (q - p) * 6 * t\n  if (t < 1 / 2) return q\n  if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6\n  return p\n}\n\nexport default class Color {\n  constructor (...inputs) {\n    this.init(...inputs)\n  }\n\n  // Test if given value is a color\n  static isColor (color) {\n    return color && (\n      color instanceof Color\n      || this.isRgb(color)\n      || this.test(color)\n    )\n  }\n\n  // Test if given value is an rgb object\n  static isRgb (color) {\n    return color && typeof color.r === 'number'\n      && typeof color.g === 'number'\n      && typeof color.b === 'number'\n  }\n\n  /*\n  Generating random colors\n  */\n  static random (mode = 'vibrant', t, u) {\n\n    // Get the math modules\n    const { random, round, sin, PI: pi } = Math\n\n    // Run the correct generator\n    if (mode === 'vibrant') {\n\n      const l = (81 - 57) * random() + 57\n      const c = (83 - 45) * random() + 45\n      const h = 360 * random()\n      const color = new Color(l, c, h, 'lch')\n      return color\n\n    } else if (mode === 'sine') {\n\n      t = t == null ? random() : t\n      const r = round(80 * sin(2 * pi * t / 0.5 + 0.01) + 150)\n      const g = round(50 * sin(2 * pi * t / 0.5 + 4.6) + 200)\n      const b = round(100 * sin(2 * pi * t / 0.5 + 2.3) + 150)\n      const color = new Color(r, g, b)\n      return color\n\n    } else if (mode === 'pastel') {\n\n      const l = (94 - 86) * random() + 86\n      const c = (26 - 9) * random() + 9\n      const h = 360 * random()\n      const color = new Color(l, c, h, 'lch')\n      return color\n\n    } else if (mode === 'dark') {\n\n      const l = 10 + 10 * random()\n      const c = (125 - 75) * random() + 86\n      const h = 360 * random()\n      const color = new Color(l, c, h, 'lch')\n      return color\n\n    } else if (mode === 'rgb') {\n\n      const r = 255 * random()\n      const g = 255 * random()\n      const b = 255 * random()\n      const color = new Color(r, g, b)\n      return color\n\n    } else if (mode === 'lab') {\n\n      const l = 100 * random()\n      const a = 256 * random() - 128\n      const b = 256 * random() - 128\n      const color = new Color(l, a, b, 'lab')\n      return color\n\n    } else if (mode === 'grey') {\n\n      const grey = 255 * random()\n      const color = new Color(grey, grey, grey)\n      return color\n\n    } else {\n\n      throw new Error('Unsupported random color mode')\n\n    }\n  }\n\n  // Test if given value is a color string\n  static test (color) {\n    return (typeof color === 'string')\n      && (isHex.test(color) || isRgb.test(color))\n  }\n\n  cmyk () {\n\n    // Get the rgb values for the current color\n    const { _a, _b, _c } = this.rgb()\n    const [ r, g, b ] = [ _a, _b, _c ].map(v => v / 255)\n\n    // Get the cmyk values in an unbounded format\n    const k = Math.min(1 - r, 1 - g, 1 - b)\n\n    if (k === 1) {\n      // Catch the black case\n      return new Color(0, 0, 0, 1, 'cmyk')\n    }\n\n    const c = (1 - r - k) / (1 - k)\n    const m = (1 - g - k) / (1 - k)\n    const y = (1 - b - k) / (1 - k)\n\n    // Construct the new color\n    const color = new Color(c, m, y, k, 'cmyk')\n    return color\n  }\n\n  hsl () {\n\n    // Get the rgb values\n    const { _a, _b, _c } = this.rgb()\n    const [ r, g, b ] = [ _a, _b, _c ].map(v => v / 255)\n\n    // Find the maximum and minimum values to get the lightness\n    const max = Math.max(r, g, b)\n    const min = Math.min(r, g, b)\n    const l = (max + min) / 2\n\n    // If the r, g, v values are identical then we are grey\n    const isGrey = max === min\n\n    // Calculate the hue and saturation\n    const delta = max - min\n    const s = isGrey\n      ? 0\n      : l > 0.5\n        ? delta / (2 - max - min)\n        : delta / (max + min)\n    const h = isGrey\n      ? 0\n      : max === r\n        ? ((g - b) / delta + (g < b ? 6 : 0)) / 6\n        : max === g\n          ? ((b - r) / delta + 2) / 6\n          : max === b\n            ? ((r - g) / delta + 4) / 6\n            : 0\n\n    // Construct and return the new color\n    const color = new Color(360 * h, 100 * s, 100 * l, 'hsl')\n    return color\n  }\n\n  init (a = 0, b = 0, c = 0, d = 0, space = 'rgb') {\n    // This catches the case when a falsy value is passed like ''\n    a = !a ? 0 : a\n\n    // Reset all values in case the init function is rerun with new color space\n    if (this.space) {\n      for (const component in this.space) {\n        delete this[this.space[component]]\n      }\n    }\n\n    if (typeof a === 'number') {\n      // Allow for the case that we don't need d...\n      space = typeof d === 'string' ? d : space\n      d = typeof d === 'string' ? 0 : d\n\n      // Assign the values straight to the color\n      Object.assign(this, { _a: a, _b: b, _c: c, _d: d, space })\n    // If the user gave us an array, make the color from it\n    } else if (a instanceof Array) {\n      this.space = b || (typeof a[3] === 'string' ? a[3] : a[4]) || 'rgb'\n      Object.assign(this, { _a: a[0], _b: a[1], _c: a[2], _d: a[3] || 0 })\n    } else if (a instanceof Object) {\n      // Set the object up and assign its values directly\n      const values = getParameters(a, b)\n      Object.assign(this, values)\n    } else if (typeof a === 'string') {\n      if (isRgb.test(a)) {\n        const noWhitespace = a.replace(whitespace, '')\n        const [ _a, _b, _c ] = rgb.exec(noWhitespace)\n          .slice(1, 4).map(v => parseInt(v))\n        Object.assign(this, { _a, _b, _c, _d: 0, space: 'rgb' })\n      } else if (isHex.test(a)) {\n        const hexParse = v => parseInt(v, 16)\n        const [ , _a, _b, _c ] = hex.exec(sixDigitHex(a)).map(hexParse)\n        Object.assign(this, { _a, _b, _c, _d: 0, space: 'rgb' })\n      } else throw Error('Unsupported string format, can\\'t construct Color')\n    }\n\n    // Now add the components as a convenience\n    const { _a, _b, _c, _d } = this\n    const components = this.space === 'rgb'\n      ? { r: _a, g: _b, b: _c }\n      : this.space === 'xyz'\n        ? { x: _a, y: _b, z: _c }\n        : this.space === 'hsl'\n          ? { h: _a, s: _b, l: _c }\n          : this.space === 'lab'\n            ? { l: _a, a: _b, b: _c }\n            : this.space === 'lch'\n              ? { l: _a, c: _b, h: _c }\n              : this.space === 'cmyk'\n                ? { c: _a, m: _b, y: _c, k: _d }\n                : {}\n    Object.assign(this, components)\n  }\n\n  lab () {\n    // Get the xyz color\n    const { x, y, z } = this.xyz()\n\n    // Get the lab components\n    const l = (116 * y) - 16\n    const a = 500 * (x - y)\n    const b = 200 * (y - z)\n\n    // Construct and return a new color\n    const color = new Color(l, a, b, 'lab')\n    return color\n  }\n\n  lch () {\n\n    // Get the lab color directly\n    const { l, a, b } = this.lab()\n\n    // Get the chromaticity and the hue using polar coordinates\n    const c = Math.sqrt(a ** 2 + b ** 2)\n    let h = 180 * Math.atan2(b, a) / Math.PI\n    if (h < 0) {\n      h *= -1\n      h = 360 - h\n    }\n\n    // Make a new color and return it\n    const color = new Color(l, c, h, 'lch')\n    return color\n  }\n  /*\n  Conversion Methods\n  */\n\n  rgb () {\n    if (this.space === 'rgb') {\n      return this\n    } else if (cieSpace(this.space)) {\n      // Convert to the xyz color space\n      let { x, y, z } = this\n      if (this.space === 'lab' || this.space === 'lch') {\n        // Get the values in the lab space\n        let { l, a, b } = this\n        if (this.space === 'lch') {\n          const { c, h } = this\n          const dToR = Math.PI / 180\n          a = c * Math.cos(dToR * h)\n          b = c * Math.sin(dToR * h)\n        }\n\n        // Undo the nonlinear function\n        const yL = (l + 16) / 116\n        const xL = a / 500 + yL\n        const zL = yL - b / 200\n\n        // Get the xyz values\n        const ct = 16 / 116\n        const mx = 0.008856\n        const nm = 7.787\n        x = 0.95047 * ((xL ** 3 > mx) ? xL ** 3 : (xL - ct) / nm)\n        y = 1.00000 * ((yL ** 3 > mx) ? yL ** 3 : (yL - ct) / nm)\n        z = 1.08883 * ((zL ** 3 > mx) ? zL ** 3 : (zL - ct) / nm)\n      }\n\n      // Convert xyz to unbounded rgb values\n      const rU = x * 3.2406 + y * -1.5372 + z * -0.4986\n      const gU = x * -0.9689 + y * 1.8758 + z * 0.0415\n      const bU = x * 0.0557 + y * -0.2040 + z * 1.0570\n\n      // Convert the values to true rgb values\n      const pow = Math.pow\n      const bd = 0.0031308\n      const r = (rU > bd) ? (1.055 * pow(rU, 1 / 2.4) - 0.055) : 12.92 * rU\n      const g = (gU > bd) ? (1.055 * pow(gU, 1 / 2.4) - 0.055) : 12.92 * gU\n      const b = (bU > bd) ? (1.055 * pow(bU, 1 / 2.4) - 0.055) : 12.92 * bU\n\n      // Make and return the color\n      const color = new Color(255 * r, 255 * g, 255 * b)\n      return color\n    } else if (this.space === 'hsl') {\n      // https://bgrins.github.io/TinyColor/docs/tinycolor.html\n      // Get the current hsl values\n      let { h, s, l } = this\n      h /= 360\n      s /= 100\n      l /= 100\n\n      // If we are grey, then just make the color directly\n      if (s === 0) {\n        l *= 255\n        const color = new Color(l, l, l)\n        return color\n      }\n\n      // TODO I have no idea what this does :D If you figure it out, tell me!\n      const q = l < 0.5 ? l * (1 + s) : l + s - l * s\n      const p = 2 * l - q\n\n      // Get the rgb values\n      const r = 255 * hueToRgb(p, q, h + 1 / 3)\n      const g = 255 * hueToRgb(p, q, h)\n      const b = 255 * hueToRgb(p, q, h - 1 / 3)\n\n      // Make a new color\n      const color = new Color(r, g, b)\n      return color\n    } else if (this.space === 'cmyk') {\n      // https://gist.github.com/felipesabino/5066336\n      // Get the normalised cmyk values\n      const { c, m, y, k } = this\n\n      // Get the rgb values\n      const r = 255 * (1 - Math.min(1, c * (1 - k) + k))\n      const g = 255 * (1 - Math.min(1, m * (1 - k) + k))\n      const b = 255 * (1 - Math.min(1, y * (1 - k) + k))\n\n      // Form the color and return it\n      const color = new Color(r, g, b)\n      return color\n    } else {\n      return this\n    }\n  }\n\n  toArray () {\n    const { _a, _b, _c, _d, space } = this\n    return [ _a, _b, _c, _d, space ]\n  }\n\n  toHex () {\n    const [ r, g, b ] = this._clamped().map(componentHex)\n    return `#${r}${g}${b}`\n  }\n\n  toRgb () {\n    const [ rV, gV, bV ] = this._clamped()\n    const string = `rgb(${rV},${gV},${bV})`\n    return string\n  }\n\n  toString () {\n    return this.toHex()\n  }\n\n  xyz () {\n\n    // Normalise the red, green and blue values\n    const { _a: r255, _b: g255, _c: b255 } = this.rgb()\n    const [ r, g, b ] = [ r255, g255, b255 ].map(v => v / 255)\n\n    // Convert to the lab rgb space\n    const rL = (r > 0.04045) ? Math.pow((r + 0.055) / 1.055, 2.4) : r / 12.92\n    const gL = (g > 0.04045) ? Math.pow((g + 0.055) / 1.055, 2.4) : g / 12.92\n    const bL = (b > 0.04045) ? Math.pow((b + 0.055) / 1.055, 2.4) : b / 12.92\n\n    // Convert to the xyz color space without bounding the values\n    const xU = (rL * 0.4124 + gL * 0.3576 + bL * 0.1805) / 0.95047\n    const yU = (rL * 0.2126 + gL * 0.7152 + bL * 0.0722) / 1.00000\n    const zU = (rL * 0.0193 + gL * 0.1192 + bL * 0.9505) / 1.08883\n\n    // Get the proper xyz values by applying the bounding\n    const x = (xU > 0.008856) ? Math.pow(xU, 1 / 3) : (7.787 * xU) + 16 / 116\n    const y = (yU > 0.008856) ? Math.pow(yU, 1 / 3) : (7.787 * yU) + 16 / 116\n    const z = (zU > 0.008856) ? Math.pow(zU, 1 / 3) : (7.787 * zU) + 16 / 116\n\n    // Make and return the color\n    const color = new Color(x, y, z, 'xyz')\n    return color\n  }\n\n  /*\n  Input and Output methods\n  */\n\n  _clamped () {\n    const { _a, _b, _c } = this.rgb()\n    const { max, min, round } = Math\n    const format = v => max(0, min(round(v), 255))\n    return [ _a, _b, _c ].map(format)\n  }\n\n  /*\n  Constructing colors\n  */\n\n}\n", "import Matrix from './Matrix.js'\n\nexport default class Point {\n  // Initialize\n  constructor (...args) {\n    this.init(...args)\n  }\n\n  // Clone point\n  clone () {\n    return new Point(this)\n  }\n\n  init (x, y) {\n    const base = { x: 0, y: 0 }\n\n    // ensure source as object\n    const source = Array.isArray(x)\n      ? { x: x[0], y: x[1] }\n      : typeof x === 'object'\n        ? { x: x.x, y: x.y }\n        : { x: x, y: y }\n\n    // merge source\n    this.x = source.x == null ? base.x : source.x\n    this.y = source.y == null ? base.y : source.y\n\n    return this\n  }\n\n  toArray () {\n    return [ this.x, this.y ]\n  }\n\n  transform (m) {\n    return this.clone().transformO(m)\n  }\n\n  // Transform point with matrix\n  transformO (m) {\n    if (!Matrix.isMatrixLike(m)) {\n      m = new Matrix(m)\n    }\n\n    const { x, y } = this\n\n    // Perform the matrix multiplication\n    this.x = m.a * x + m.c * y + m.e\n    this.y = m.b * x + m.d * y + m.f\n\n    return this\n  }\n\n}\n\nexport function point (x, y) {\n  return new Point(x, y).transformO(this.screenCTM().inverseO())\n}\n", "import { delimiter } from '../modules/core/regex.js'\nimport { radians } from '../utils/utils.js'\nimport { register } from '../utils/adopter.js'\nimport Element from '../elements/Element.js'\nimport Point from './Point.js'\n\nfunction closeEnough (a, b, threshold) {\n  return Math.abs(b - a) < (threshold || 1e-6)\n}\n\nexport default class Matrix {\n  constructor (...args) {\n    this.init(...args)\n  }\n\n  static formatTransforms (o) {\n    // Get all of the parameters required to form the matrix\n    const flipBoth = o.flip === 'both' || o.flip === true\n    const flipX = o.flip && (flipBoth || o.flip === 'x') ? -1 : 1\n    const flipY = o.flip && (flipBoth || o.flip === 'y') ? -1 : 1\n    const skewX = o.skew && o.skew.length\n      ? o.skew[0]\n      : isFinite(o.skew)\n        ? o.skew\n        : isFinite(o.skewX)\n          ? o.skewX\n          : 0\n    const skewY = o.skew && o.skew.length\n      ? o.skew[1]\n      : isFinite(o.skew)\n        ? o.skew\n        : isFinite(o.skewY)\n          ? o.skewY\n          : 0\n    const scaleX = o.scale && o.scale.length\n      ? o.scale[0] * flipX\n      : isFinite(o.scale)\n        ? o.scale * flipX\n        : isFinite(o.scaleX)\n          ? o.scaleX * flipX\n          : flipX\n    const scaleY = o.scale && o.scale.length\n      ? o.scale[1] * flipY\n      : isFinite(o.scale)\n        ? o.scale * flipY\n        : isFinite(o.scaleY)\n          ? o.scaleY * flipY\n          : flipY\n    const shear = o.shear || 0\n    const theta = o.rotate || o.theta || 0\n    const origin = new Point(o.origin || o.around || o.ox || o.originX, o.oy || o.originY)\n    const ox = origin.x\n    const oy = origin.y\n    // We need Point to be invalid if nothing was passed because we cannot default to 0 here. That is why NaN\n    const position = new Point(o.position || o.px || o.positionX || NaN, o.py || o.positionY || NaN)\n    const px = position.x\n    const py = position.y\n    const translate = new Point(o.translate || o.tx || o.translateX, o.ty || o.translateY)\n    const tx = translate.x\n    const ty = translate.y\n    const relative = new Point(o.relative || o.rx || o.relativeX, o.ry || o.relativeY)\n    const rx = relative.x\n    const ry = relative.y\n\n    // Populate all of the values\n    return {\n      scaleX, scaleY, skewX, skewY, shear, theta, rx, ry, tx, ty, ox, oy, px, py\n    }\n  }\n\n  static fromArray (a) {\n    return { a: a[0], b: a[1], c: a[2], d: a[3], e: a[4], f: a[5] }\n  }\n\n  static isMatrixLike (o) {\n    return (\n      o.a != null\n      || o.b != null\n      || o.c != null\n      || o.d != null\n      || o.e != null\n      || o.f != null\n    )\n  }\n\n  // left matrix, right matrix, target matrix which is overwritten\n  static matrixMultiply (l, r, o) {\n    // Work out the product directly\n    const a = l.a * r.a + l.c * r.b\n    const b = l.b * r.a + l.d * r.b\n    const c = l.a * r.c + l.c * r.d\n    const d = l.b * r.c + l.d * r.d\n    const e = l.e + l.a * r.e + l.c * r.f\n    const f = l.f + l.b * r.e + l.d * r.f\n\n    // make sure to use local variables because l/r and o could be the same\n    o.a = a\n    o.b = b\n    o.c = c\n    o.d = d\n    o.e = e\n    o.f = f\n\n    return o\n  }\n\n  around (cx, cy, matrix) {\n    return this.clone().aroundO(cx, cy, matrix)\n  }\n\n  // Transform around a center point\n  aroundO (cx, cy, matrix) {\n    const dx = cx || 0\n    const dy = cy || 0\n    return this.translateO(-dx, -dy).lmultiplyO(matrix).translateO(dx, dy)\n  }\n\n  // Clones this matrix\n  clone () {\n    return new Matrix(this)\n  }\n\n  // Decomposes this matrix into its affine parameters\n  decompose (cx = 0, cy = 0) {\n    // Get the parameters from the matrix\n    const a = this.a\n    const b = this.b\n    const c = this.c\n    const d = this.d\n    const e = this.e\n    const f = this.f\n\n    // Figure out if the winding direction is clockwise or counterclockwise\n    const determinant = a * d - b * c\n    const ccw = determinant > 0 ? 1 : -1\n\n    // Since we only shear in x, we can use the x basis to get the x scale\n    // and the rotation of the resulting matrix\n    const sx = ccw * Math.sqrt(a * a + b * b)\n    const thetaRad = Math.atan2(ccw * b, ccw * a)\n    const theta = 180 / Math.PI * thetaRad\n    const ct = Math.cos(thetaRad)\n    const st = Math.sin(thetaRad)\n\n    // We can then solve the y basis vector simultaneously to get the other\n    // two affine parameters directly from these parameters\n    const lam = (a * c + b * d) / determinant\n    const sy = ((c * sx) / (lam * a - b)) || ((d * sx) / (lam * b + a))\n\n    // Use the translations\n    const tx = e - cx + cx * ct * sx + cy * (lam * ct * sx - st * sy)\n    const ty = f - cy + cx * st * sx + cy * (lam * st * sx + ct * sy)\n\n    // Construct the decomposition and return it\n    return {\n      // Return the affine parameters\n      scaleX: sx,\n      scaleY: sy,\n      shear: lam,\n      rotate: theta,\n      translateX: tx,\n      translateY: ty,\n      originX: cx,\n      originY: cy,\n\n      // Return the matrix parameters\n      a: this.a,\n      b: this.b,\n      c: this.c,\n      d: this.d,\n      e: this.e,\n      f: this.f\n    }\n  }\n\n  // Check if two matrices are equal\n  equals (other) {\n    if (other === this) return true\n    const comp = new Matrix(other)\n    return closeEnough(this.a, comp.a) && closeEnough(this.b, comp.b)\n      && closeEnough(this.c, comp.c) && closeEnough(this.d, comp.d)\n      && closeEnough(this.e, comp.e) && closeEnough(this.f, comp.f)\n  }\n\n  // Flip matrix on x or y, at a given offset\n  flip (axis, around) {\n    return this.clone().flipO(axis, around)\n  }\n\n  flipO (axis, around) {\n    return axis === 'x'\n      ? this.scaleO(-1, 1, around, 0)\n      : axis === 'y'\n        ? this.scaleO(1, -1, 0, around)\n        : this.scaleO(-1, -1, axis, around || axis) // Define an x, y flip point\n  }\n\n  // Initialize\n  init (source) {\n    const base = Matrix.fromArray([ 1, 0, 0, 1, 0, 0 ])\n\n    // ensure source as object\n    source = source instanceof Element\n      ? source.matrixify()\n      : typeof source === 'string'\n        ? Matrix.fromArray(source.split(delimiter).map(parseFloat))\n        : Array.isArray(source)\n          ? Matrix.fromArray(source)\n          : (typeof source === 'object' && Matrix.isMatrixLike(source))\n            ? source\n            : (typeof source === 'object')\n              ? new Matrix().transform(source)\n              : arguments.length === 6\n                ? Matrix.fromArray([].slice.call(arguments))\n                : base\n\n    // Merge the source matrix with the base matrix\n    this.a = source.a != null ? source.a : base.a\n    this.b = source.b != null ? source.b : base.b\n    this.c = source.c != null ? source.c : base.c\n    this.d = source.d != null ? source.d : base.d\n    this.e = source.e != null ? source.e : base.e\n    this.f = source.f != null ? source.f : base.f\n\n    return this\n  }\n\n  inverse () {\n    return this.clone().inverseO()\n  }\n\n  // Inverses matrix\n  inverseO () {\n    // Get the current parameters out of the matrix\n    const a = this.a\n    const b = this.b\n    const c = this.c\n    const d = this.d\n    const e = this.e\n    const f = this.f\n\n    // Invert the 2x2 matrix in the top left\n    const det = a * d - b * c\n    if (!det) throw new Error('Cannot invert ' + this)\n\n    // Calculate the top 2x2 matrix\n    const na = d / det\n    const nb = -b / det\n    const nc = -c / det\n    const nd = a / det\n\n    // Apply the inverted matrix to the top right\n    const ne = -(na * e + nc * f)\n    const nf = -(nb * e + nd * f)\n\n    // Construct the inverted matrix\n    this.a = na\n    this.b = nb\n    this.c = nc\n    this.d = nd\n    this.e = ne\n    this.f = nf\n\n    return this\n  }\n\n  lmultiply (matrix) {\n    return this.clone().lmultiplyO(matrix)\n  }\n\n  lmultiplyO (matrix) {\n    const r = this\n    const l = matrix instanceof Matrix\n      ? matrix\n      : new Matrix(matrix)\n\n    return Matrix.matrixMultiply(l, r, this)\n  }\n\n  // Left multiplies by the given matrix\n  multiply (matrix) {\n    return this.clone().multiplyO(matrix)\n  }\n\n  multiplyO (matrix) {\n    // Get the matrices\n    const l = this\n    const r = matrix instanceof Matrix\n      ? matrix\n      : new Matrix(matrix)\n\n    return Matrix.matrixMultiply(l, r, this)\n  }\n\n  // Rotate matrix\n  rotate (r, cx, cy) {\n    return this.clone().rotateO(r, cx, cy)\n  }\n\n  rotateO (r, cx = 0, cy = 0) {\n    // Convert degrees to radians\n    r = radians(r)\n\n    const cos = Math.cos(r)\n    const sin = Math.sin(r)\n\n    const { a, b, c, d, e, f } = this\n\n    this.a = a * cos - b * sin\n    this.b = b * cos + a * sin\n    this.c = c * cos - d * sin\n    this.d = d * cos + c * sin\n    this.e = e * cos - f * sin + cy * sin - cx * cos + cx\n    this.f = f * cos + e * sin - cx * sin - cy * cos + cy\n\n    return this\n  }\n\n  // Scale matrix\n  scale (x, y, cx, cy) {\n    return this.clone().scaleO(...arguments)\n  }\n\n  scaleO (x, y = x, cx = 0, cy = 0) {\n    // Support uniform scaling\n    if (arguments.length === 3) {\n      cy = cx\n      cx = y\n      y = x\n    }\n\n    const { a, b, c, d, e, f } = this\n\n    this.a = a * x\n    this.b = b * y\n    this.c = c * x\n    this.d = d * y\n    this.e = e * x - cx * x + cx\n    this.f = f * y - cy * y + cy\n\n    return this\n  }\n\n  // Shear matrix\n  shear (a, cx, cy) {\n    return this.clone().shearO(a, cx, cy)\n  }\n\n  shearO (lx, cx = 0, cy = 0) {\n    const { a, b, c, d, e, f } = this\n\n    this.a = a + b * lx\n    this.c = c + d * lx\n    this.e = e + f * lx - cy * lx\n\n    return this\n  }\n\n  // Skew Matrix\n  skew (x, y, cx, cy) {\n    return this.clone().skewO(...arguments)\n  }\n\n  skewO (x, y = x, cx = 0, cy = 0) {\n    // support uniformal skew\n    if (arguments.length === 3) {\n      cy = cx\n      cx = y\n      y = x\n    }\n\n    // Convert degrees to radians\n    x = radians(x)\n    y = radians(y)\n\n    const lx = Math.tan(x)\n    const ly = Math.tan(y)\n\n    const { a, b, c, d, e, f } = this\n\n    this.a = a + b * lx\n    this.b = b + a * ly\n    this.c = c + d * lx\n    this.d = d + c * ly\n    this.e = e + f * lx - cy * lx\n    this.f = f + e * ly - cx * ly\n\n    return this\n  }\n\n  // SkewX\n  skewX (x, cx, cy) {\n    return this.skew(x, 0, cx, cy)\n  }\n\n  // SkewY\n  skewY (y, cx, cy) {\n    return this.skew(0, y, cx, cy)\n  }\n\n  toArray () {\n    return [ this.a, this.b, this.c, this.d, this.e, this.f ]\n  }\n\n  // Convert matrix to string\n  toString () {\n    return 'matrix(' + this.a + ',' + this.b + ',' + this.c + ',' + this.d + ',' + this.e + ',' + this.f + ')'\n  }\n\n  // Transform a matrix into another matrix by manipulating the space\n  transform (o) {\n    // Check if o is a matrix and then left multiply it directly\n    if (Matrix.isMatrixLike(o)) {\n      const matrix = new Matrix(o)\n      return matrix.multiplyO(this)\n    }\n\n    // Get the proposed transformations and the current transformations\n    const t = Matrix.formatTransforms(o)\n    const current = this\n    const { x: ox, y: oy } = new Point(t.ox, t.oy).transform(current)\n\n    // Construct the resulting matrix\n    const transformer = new Matrix()\n      .translateO(t.rx, t.ry)\n      .lmultiplyO(current)\n      .translateO(-ox, -oy)\n      .scaleO(t.scaleX, t.scaleY)\n      .skewO(t.skewX, t.skewY)\n      .shearO(t.shear)\n      .rotateO(t.theta)\n      .translateO(ox, oy)\n\n    // If we want the origin at a particular place, we force it there\n    if (isFinite(t.px) || isFinite(t.py)) {\n      const origin = new Point(ox, oy).transform(transformer)\n      // TODO: Replace t.px with isFinite(t.px)\n      // Doesn't work because t.px is also 0 if it wasn't passed\n      const dx = isFinite(t.px) ? t.px - origin.x : 0\n      const dy = isFinite(t.py) ? t.py - origin.y : 0\n      transformer.translateO(dx, dy)\n    }\n\n    // Translate now after positioning\n    transformer.translateO(t.tx, t.ty)\n    return transformer\n  }\n\n  // Translate matrix\n  translate (x, y) {\n    return this.clone().translateO(x, y)\n  }\n\n  translateO (x, y) {\n    this.e += x || 0\n    this.f += y || 0\n    return this\n  }\n\n  valueOf () {\n    return {\n      a: this.a,\n      b: this.b,\n      c: this.c,\n      d: this.d,\n      e: this.e,\n      f: this.f\n    }\n  }\n\n}\n\nexport function ctm () {\n  return new Matrix(this.node.getCTM())\n}\n\nexport function screenCTM () {\n  /* https://bugzilla.mozilla.org/show_bug.cgi?id=1344537\n     This is needed because FF does not return the transformation matrix\n     for the inner coordinate system when getScreenCTM() is called on nested svgs.\n     However all other Browsers do that */\n  if (typeof this.isRoot === 'function' && !this.isRoot()) {\n    const rect = this.rect(1, 1)\n    const m = rect.node.getScreenCTM()\n    rect.remove()\n    return new Matrix(m)\n  }\n  return new Matrix(this.node.getScreenCTM())\n}\n\nregister(Matrix, 'Matrix')\n", "import { globals } from '../../utils/window.js'\nimport { makeInstance } from '../../utils/adopter.js'\n\nexport default function parser () {\n  // Reuse cached element if possible\n  if (!parser.nodes) {\n    const svg = makeInstance().size(2, 0)\n    svg.node.style.cssText = [\n      'opacity: 0',\n      'position: absolute',\n      'left: -100%',\n      'top: -100%',\n      'overflow: hidden'\n    ].join(';')\n\n    svg.attr('focusable', 'false')\n    svg.attr('aria-hidden', 'true')\n\n    const path = svg.path().node\n\n    parser.nodes = { svg, path }\n  }\n\n  if (!parser.nodes.svg.node.parentNode) {\n    const b = globals.document.body || globals.document.documentElement\n    parser.nodes.svg.addTo(b)\n  }\n\n  return parser.nodes\n}\n", "import { delimiter } from '../modules/core/regex.js'\nimport { globals } from '../utils/window.js'\nimport { register } from '../utils/adopter.js'\nimport { registerMethods } from '../utils/methods.js'\nimport Matrix from './Matrix.js'\nimport Point from './Point.js'\nimport parser from '../modules/core/parser.js'\n\nexport function isNulledBox (box) {\n  return !box.width && !box.height && !box.x && !box.y\n}\n\nexport function domContains (node) {\n  return node === globals.document\n    || (globals.document.documentElement.contains || function (node) {\n      // This is IE - it does not support contains() for top-level SVGs\n      while (node.parentNode) {\n        node = node.parentNode\n      }\n      return node === globals.document\n    }).call(globals.document.documentElement, node)\n}\n\nexport default class Box {\n  constructor (...args) {\n    this.init(...args)\n  }\n\n  addOffset () {\n    // offset by window scroll position, because getBoundingClientRect changes when window is scrolled\n    this.x += globals.window.pageXOffset\n    this.y += globals.window.pageYOffset\n    return new Box(this)\n  }\n\n  init (source) {\n    const base = [ 0, 0, 0, 0 ]\n    source = typeof source === 'string'\n      ? source.split(delimiter).map(parseFloat)\n      : Array.isArray(source)\n        ? source\n        : typeof source === 'object'\n          ? [ source.left != null\n            ? source.left\n            : source.x, source.top != null ? source.top : source.y, source.width, source.height ]\n          : arguments.length === 4\n            ? [].slice.call(arguments)\n            : base\n\n    this.x = source[0] || 0\n    this.y = source[1] || 0\n    this.width = this.w = source[2] || 0\n    this.height = this.h = source[3] || 0\n\n    // Add more bounding box properties\n    this.x2 = this.x + this.w\n    this.y2 = this.y + this.h\n    this.cx = this.x + this.w / 2\n    this.cy = this.y + this.h / 2\n\n    return this\n  }\n\n  isNulled () {\n    return isNulledBox(this)\n  }\n\n  // Merge rect box with another, return a new instance\n  merge (box) {\n    const x = Math.min(this.x, box.x)\n    const y = Math.min(this.y, box.y)\n    const width = Math.max(this.x + this.width, box.x + box.width) - x\n    const height = Math.max(this.y + this.height, box.y + box.height) - y\n\n    return new Box(x, y, width, height)\n  }\n\n  toArray () {\n    return [ this.x, this.y, this.width, this.height ]\n  }\n\n  toString () {\n    return this.x + ' ' + this.y + ' ' + this.width + ' ' + this.height\n  }\n\n  transform (m) {\n    if (!(m instanceof Matrix)) {\n      m = new Matrix(m)\n    }\n\n    let xMin = Infinity\n    let xMax = -Infinity\n    let yMin = Infinity\n    let yMax = -Infinity\n\n    const pts = [\n      new Point(this.x, this.y),\n      new Point(this.x2, this.y),\n      new Point(this.x, this.y2),\n      new Point(this.x2, this.y2)\n    ]\n\n    pts.forEach(function (p) {\n      p = p.transform(m)\n      xMin = Math.min(xMin, p.x)\n      xMax = Math.max(xMax, p.x)\n      yMin = Math.min(yMin, p.y)\n      yMax = Math.max(yMax, p.y)\n    })\n\n    return new Box(\n      xMin, yMin,\n      xMax - xMin,\n      yMax - yMin\n    )\n  }\n\n}\n\nfunction getBox (el, getBBoxFn, retry) {\n  let box\n\n  try {\n    // Try to get the box with the provided function\n    box = getBBoxFn(el.node)\n\n    // If the box is worthless and not even in the dom, retry\n    // by throwing an error here...\n    if (isNulledBox(box) && !domContains(el.node)) {\n      throw new Error('Element not in the dom')\n    }\n  } catch (e) {\n    // ... and calling the retry handler here\n    box = retry(el)\n  }\n\n  return box\n}\n\nexport function bbox () {\n  // Function to get bbox is getBBox()\n  const getBBox = (node) => node.getBBox()\n\n  // Take all measures so that a stupid browser renders the element\n  // so we can get the bbox from it when we try again\n  const retry = (el) => {\n    try {\n      const clone = el.clone().addTo(parser().svg).show()\n      const box = clone.node.getBBox()\n      clone.remove()\n      return box\n    } catch (e) {\n      // We give up...\n      throw new Error(`Getting bbox of element \"${el.node.nodeName}\" is not possible: ${e.toString()}`)\n    }\n  }\n\n  const box = getBox(this, getBBox, retry)\n  const bbox = new Box(box)\n\n  return bbox\n}\n\nexport function rbox (el) {\n  const getRBox = (node) => node.getBoundingClientRect()\n  const retry = (el) => {\n    // There is no point in trying tricks here because if we insert the element into the dom ourselves\n    // it obviously will be at the wrong position\n    throw new Error(`Getting rbox of element \"${el.node.nodeName}\" is not possible`)\n  }\n\n  const box = getBox(this, getRBox, retry)\n  const rbox = new Box(box)\n\n  // If an element was passed, we want the bbox in the coordinate system of that element\n  if (el) {\n    return rbox.transform(el.screenCTM().inverseO())\n  }\n\n  // Else we want it in absolute screen coordinates\n  // Therefore we need to add the scrollOffset\n  return rbox.addOffset()\n}\n\n// Checks whether the given point is inside the bounding box\nexport function inside (x, y) {\n  const box = this.bbox()\n\n  return x > box.x\n    && y > box.y\n    && x < box.x + box.width\n    && y < box.y + box.height\n}\n\nregisterMethods({\n  viewbox: {\n    viewbox (x, y, width, height) {\n      // act as getter\n      if (x == null) return new Box(this.attr('viewBox'))\n\n      // act as setter\n      return this.attr('viewBox', new Box(x, y, width, height))\n    },\n\n    zoom (level, point) {\n      // Its best to rely on the attributes here and here is why:\n      // clientXYZ: Doesn't work on non-root svgs because they dont have a CSSBox (silly!)\n      // getBoundingClientRect: Doesn't work because Chrome just ignores width and height of nested svgs completely\n      //                        that means, their clientRect is always as big as the content.\n      //                        Furthermore this size is incorrect if the element is further transformed by its parents\n      // computedStyle: Only returns meaningful values if css was used with px. We dont go this route here!\n      // getBBox: returns the bounding box of its content - that doesn't help!\n      let { width, height } = this.attr([ 'width', 'height' ])\n\n      // Width and height is a string when a number with a unit is present which we can't use\n      // So we try clientXYZ\n      if ((!width && !height) || (typeof width === 'string' || typeof height === 'string')) {\n        width = this.node.clientWidth\n        height = this.node.clientHeight\n      }\n\n      // Giving up...\n      if (!width || !height) {\n        throw new Error('Impossible to get absolute width and height. Please provide an absolute width and height attribute on the zooming element')\n      }\n\n      const v = this.viewbox()\n\n      const zoomX = width / v.width\n      const zoomY = height / v.height\n      const zoom = Math.min(zoomX, zoomY)\n\n      if (level == null) {\n        return zoom\n      }\n\n      let zoomAmount = zoom / level\n\n      // Set the zoomAmount to the highest value which is safe to process and recover from\n      // The * 100 is a bit of wiggle room for the matrix transformation\n      if (zoomAmount === Infinity) zoomAmount = Number.MAX_SAFE_INTEGER / 100\n\n      point = point || new Point(width / 2 / zoomX + v.x, height / 2 / zoomY + v.y)\n\n      const box = new Box(v).transform(\n        new Matrix({ scale: zoomAmount, origin: point })\n      )\n\n      return this.viewbox(box)\n    }\n  }\n})\n\nregister(Box, 'Box')\n", "import { extend } from '../utils/adopter.js'\n// import { subClassArray } from './ArrayPolyfill.js'\n\nclass List extends Array {\n  constructor (arr = [], ...args) {\n    super(arr, ...args)\n    if (typeof arr === 'number') return this\n    this.length = 0\n    this.push(...arr)\n  }\n}\n\n/* = subClassArray('List', Array, function (arr = []) {\n  // This catches the case, that native map tries to create an array with new Array(1)\n  if (typeof arr === 'number') return this\n  this.length = 0\n  this.push(...arr)\n}) */\n\nexport default List\n\nextend([ List ], {\n  each (fnOrMethodName, ...args) {\n    if (typeof fnOrMethodName === 'function') {\n      return this.map((el, i, arr) => {\n        return fnOrMethodName.call(el, el, i, arr)\n      })\n    } else {\n      return this.map(el => {\n        return el[fnOrMethodName](...args)\n      })\n    }\n  },\n\n  toArray () {\n    return Array.prototype.concat.apply([], this)\n  }\n})\n\nconst reserved = [ 'toArray', 'constructor', 'each' ]\n\nList.extend = function (methods) {\n  methods = methods.reduce((obj, name) => {\n    // Don't overwrite own methods\n    if (reserved.includes(name)) return obj\n\n    // Don't add private methods\n    if (name[0] === '_') return obj\n\n    // Relay every call to each()\n    obj[name] = function (...attrs) {\n      return this.each(name, ...attrs)\n    }\n    return obj\n  }, {})\n\n  extend([ List ], methods)\n}\n", "import { adopt } from '../../utils/adopter.js'\nimport { globals } from '../../utils/window.js'\nimport { map } from '../../utils/utils.js'\nimport List from '../../types/List.js'\n\nexport default function baseFind (query, parent) {\n  return new List(map((parent || globals.document).querySelectorAll(query), function (node) {\n    return adopt(node)\n  }))\n}\n\n// Scoped find method\nexport function find (query) {\n  return baseFind(query, this.node)\n}\n\nexport function findOne (query) {\n  return adopt(this.node.querySelector(query))\n}\n", "import { delimiter } from './regex.js'\nimport { makeInstance } from '../../utils/adopter.js'\nimport { globals } from '../../utils/window.js'\n\nlet listenerId = 0\nexport const windowEvents = {}\n\nexport function getEvents (instance) {\n  let n = instance.getEventHolder()\n\n  // We dont want to save events in global space\n  if (n === globals.window) n = windowEvents\n  if (!n.events) n.events = {}\n  return n.events\n}\n\nexport function getEventTarget (instance) {\n  return instance.getEventTarget()\n}\n\nexport function clearEvents (instance) {\n  let n = instance.getEventHolder()\n  if (n === globals.window) n = windowEvents\n  if (n.events) n.events = {}\n}\n\n// Add event binder in the SVG namespace\nexport function on (node, events, listener, binding, options) {\n  const l = listener.bind(binding || node)\n  const instance = makeInstance(node)\n  const bag = getEvents(instance)\n  const n = getEventTarget(instance)\n\n  // events can be an array of events or a string of events\n  events = Array.isArray(events) ? events : events.split(delimiter)\n\n  // add id to listener\n  if (!listener._svgjsListenerId) {\n    listener._svgjsListenerId = ++listenerId\n  }\n\n  events.forEach(function (event) {\n    const ev = event.split('.')[0]\n    const ns = event.split('.')[1] || '*'\n\n    // ensure valid object\n    bag[ev] = bag[ev] || {}\n    bag[ev][ns] = bag[ev][ns] || {}\n\n    // reference listener\n    bag[ev][ns][listener._svgjsListenerId] = l\n\n    // add listener\n    n.addEventListener(ev, l, options || false)\n  })\n}\n\n// Add event unbinder in the SVG namespace\nexport function off (node, events, listener, options) {\n  const instance = makeInstance(node)\n  const bag = getEvents(instance)\n  const n = getEventTarget(instance)\n\n  // listener can be a function or a number\n  if (typeof listener === 'function') {\n    listener = listener._svgjsListenerId\n    if (!listener) return\n  }\n\n  // events can be an array of events or a string or undefined\n  events = Array.isArray(events) ? events : (events || '').split(delimiter)\n\n  events.forEach(function (event) {\n    const ev = event && event.split('.')[0]\n    const ns = event && event.split('.')[1]\n    let namespace, l\n\n    if (listener) {\n      // remove listener reference\n      if (bag[ev] && bag[ev][ns || '*']) {\n        // removeListener\n        n.removeEventListener(ev, bag[ev][ns || '*'][listener], options || false)\n\n        delete bag[ev][ns || '*'][listener]\n      }\n    } else if (ev && ns) {\n      // remove all listeners for a namespaced event\n      if (bag[ev] && bag[ev][ns]) {\n        for (l in bag[ev][ns]) {\n          off(n, [ ev, ns ].join('.'), l)\n        }\n\n        delete bag[ev][ns]\n      }\n    } else if (ns) {\n      // remove all listeners for a specific namespace\n      for (event in bag) {\n        for (namespace in bag[event]) {\n          if (ns === namespace) {\n            off(n, [ event, ns ].join('.'))\n          }\n        }\n      }\n    } else if (ev) {\n      // remove all listeners for the event\n      if (bag[ev]) {\n        for (namespace in bag[ev]) {\n          off(n, [ ev, namespace ].join('.'))\n        }\n\n        delete bag[ev]\n      }\n    } else {\n      // remove all listeners on a given node\n      for (event in bag) {\n        off(n, event)\n      }\n\n      clearEvents(instance)\n    }\n  })\n}\n\nexport function dispatch (node, event, data, options) {\n  const n = getEventTarget(node)\n\n  // Dispatch event\n  if (event instanceof globals.window.Event) {\n    n.dispatchEvent(event)\n  } else {\n    event = new globals.window.CustomEvent(event, { detail: data, cancelable: true, ...options })\n    n.dispatchEvent(event)\n  }\n  return event\n}\n", "import { dispatch, off, on } from '../modules/core/event.js'\nimport { register } from '../utils/adopter.js'\nimport Base from './Base.js'\n\nexport default class EventTarget extends Base {\n  addEventListener () {}\n\n  dispatch (event, data, options) {\n    return dispatch(this, event, data, options)\n  }\n\n  dispatchEvent (event) {\n    const bag = this.getEventHolder().events\n    if (!bag) return true\n\n    const events = bag[event.type]\n\n    for (const i in events) {\n      for (const j in events[i]) {\n        events[i][j](event)\n      }\n    }\n\n    return !event.defaultPrevented\n  }\n\n  // Fire given event\n  fire (event, data, options) {\n    this.dispatch(event, data, options)\n    return this\n  }\n\n  getEventHolder () {\n    return this\n  }\n\n  getEventTarget () {\n    return this\n  }\n\n  // Unbind event from listener\n  off (event, listener, options) {\n    off(this, event, listener, options)\n    return this\n  }\n\n  // Bind given event to listener\n  on (event, listener, binding, options) {\n    on(this, event, listener, binding, options)\n    return this\n  }\n\n  removeEventListener () {}\n}\n\nregister(EventTarget, 'EventTarget')\n", "\nexport function noop () {}\n\n// Default animation values\nexport const timeline = {\n  duration: 400,\n  ease: '>',\n  delay: 0\n}\n\n// Default attribute values\nexport const attrs = {\n\n  // fill and stroke\n  'fill-opacity': 1,\n  'stroke-opacity': 1,\n  'stroke-width': 0,\n  'stroke-linejoin': 'miter',\n  'stroke-linecap': 'butt',\n  fill: '#000000',\n  stroke: '#000000',\n  opacity: 1,\n\n  // position\n  x: 0,\n  y: 0,\n  cx: 0,\n  cy: 0,\n\n  // size\n  width: 0,\n  height: 0,\n\n  // radius\n  r: 0,\n  rx: 0,\n  ry: 0,\n\n  // gradient\n  offset: 0,\n  'stop-opacity': 1,\n  'stop-color': '#000000',\n\n  // text\n  'text-anchor': 'start'\n}\n", "import { delimiter } from '../modules/core/regex.js'\n\nexport default class SVGArray extends Array {\n  constructor (...args) {\n    super(...args)\n    this.init(...args)\n  }\n\n  clone () {\n    return new this.constructor(this)\n  }\n\n  init (arr) {\n    // This catches the case, that native map tries to create an array with new Array(1)\n    if (typeof arr === 'number') return this\n    this.length = 0\n    this.push(...this.parse(arr))\n    return this\n  }\n\n  // Parse whitespace separated string\n  parse (array = []) {\n    // If already is an array, no need to parse it\n    if (array instanceof Array) return array\n\n    return array.trim().split(delimiter).map(parseFloat)\n  }\n\n  toArray () {\n    return Array.prototype.concat.apply([], this)\n  }\n\n  toSet () {\n    return new Set(this)\n  }\n\n  toString () {\n    return this.join(' ')\n  }\n\n  // Flattens the array if needed\n  valueOf () {\n    const ret = []\n    ret.push(...this)\n    return ret\n  }\n\n}\n", "import { numberAndUnit } from '../modules/core/regex.js'\n\n// Module for unit conversions\nexport default class SVGNumber {\n  // Initialize\n  constructor (...args) {\n    this.init(...args)\n  }\n\n  convert (unit) {\n    return new SVGNumber(this.value, unit)\n  }\n\n  // Divide number\n  divide (number) {\n    number = new SVGNumber(number)\n    return new SVGNumber(this / number, this.unit || number.unit)\n  }\n\n  init (value, unit) {\n    unit = Array.isArray(value) ? value[1] : unit\n    value = Array.isArray(value) ? value[0] : value\n\n    // initialize defaults\n    this.value = 0\n    this.unit = unit || ''\n\n    // parse value\n    if (typeof value === 'number') {\n      // ensure a valid numeric value\n      this.value = isNaN(value) ? 0 : !isFinite(value) ? (value < 0 ? -3.4e+38 : +3.4e+38) : value\n    } else if (typeof value === 'string') {\n      unit = value.match(numberAndUnit)\n\n      if (unit) {\n        // make value numeric\n        this.value = parseFloat(unit[1])\n\n        // normalize\n        if (unit[5] === '%') {\n          this.value /= 100\n        } else if (unit[5] === 's') {\n          this.value *= 1000\n        }\n\n        // store unit\n        this.unit = unit[5]\n      }\n    } else {\n      if (value instanceof SVGNumber) {\n        this.value = value.valueOf()\n        this.unit = value.unit\n      }\n    }\n\n    return this\n  }\n\n  // Subtract number\n  minus (number) {\n    number = new SVGNumber(number)\n    return new SVGNumber(this - number, this.unit || number.unit)\n  }\n\n  // Add number\n  plus (number) {\n    number = new SVGNumber(number)\n    return new SVGNumber(this + number, this.unit || number.unit)\n  }\n\n  // Multiply number\n  times (number) {\n    number = new SVGNumber(number)\n    return new SVGNumber(this * number, this.unit || number.unit)\n  }\n\n  toArray () {\n    return [ this.value, this.unit ]\n  }\n\n  toJSON () {\n    return this.toString()\n  }\n\n  toString () {\n    return (this.unit === '%'\n      ? ~~(this.value * 1e8) / 1e6\n      : this.unit === 's'\n        ? this.value / 1e3\n        : this.value\n    ) + this.unit\n  }\n\n  valueOf () {\n    return this.value\n  }\n\n}\n", "import { attrs as defaults } from './defaults.js'\nimport { isNumber } from './regex.js'\nimport Color from '../../types/Color.js'\nimport SVGArray from '../../types/SVGArray.js'\nimport SVGNumber from '../../types/SVGNumber.js'\n\nconst hooks = []\nexport function registerAttrHook (fn) {\n  hooks.push(fn)\n}\n\n// Set svg element attribute\nexport default function attr (attr, val, ns) {\n  // act as full getter\n  if (attr == null) {\n    // get an object of attributes\n    attr = {}\n    val = this.node.attributes\n\n    for (const node of val) {\n      attr[node.nodeName] = isNumber.test(node.nodeValue)\n        ? parseFloat(node.nodeValue)\n        : node.nodeValue\n    }\n\n    return attr\n  } else if (attr instanceof Array) {\n    // loop through array and get all values\n    return attr.reduce((last, curr) => {\n      last[curr] = this.attr(curr)\n      return last\n    }, {})\n  } else if (typeof attr === 'object' && attr.constructor === Object) {\n    // apply every attribute individually if an object is passed\n    for (val in attr) this.attr(val, attr[val])\n  } else if (val === null) {\n    // remove value\n    this.node.removeAttribute(attr)\n  } else if (val == null) {\n    // act as a getter if the first and only argument is not an object\n    val = this.node.getAttribute(attr)\n    return val == null\n      ? defaults[attr]\n      : isNumber.test(val)\n        ? parseFloat(val)\n        : val\n  } else {\n    // Loop through hooks and execute them to convert value\n    val = hooks.reduce((_val, hook) => {\n      return hook(attr, _val, this)\n    }, val)\n\n    // ensure correct numeric values (also accepts NaN and Infinity)\n    if (typeof val === 'number') {\n      val = new SVGNumber(val)\n    } else if (Color.isColor(val)) {\n      // ensure full hex color\n      val = new Color(val)\n    } else if (val.constructor === Array) {\n      // Check for plain arrays and parse array values\n      val = new SVGArray(val)\n    }\n\n    // if the passed attribute is leading...\n    if (attr === 'leading') {\n      // ... call the leading method instead\n      if (this.leading) {\n        this.leading(val)\n      }\n    } else {\n      // set given attribute on node\n      typeof ns === 'string'\n        ? this.node.setAttributeNS(ns, attr, val.toString())\n        : this.node.setAttribute(attr, val.toString())\n    }\n\n    // rebuild if required\n    if (this.rebuild && (attr === 'font-size' || attr === 'x')) {\n      this.rebuild()\n    }\n  }\n\n  return this\n}\n", "import {\n  adopt,\n  assignNewId,\n  eid,\n  extend,\n  makeInstance,\n  create,\n  register\n} from '../utils/adopter.js'\nimport { find, findOne } from '../modules/core/selector.js'\nimport { globals } from '../utils/window.js'\nimport { map } from '../utils/utils.js'\nimport { svg, html } from '../modules/core/namespaces.js'\nimport EventTarget from '../types/EventTarget.js'\nimport List from '../types/List.js'\nimport attr from '../modules/core/attr.js'\n\nexport default class Dom extends EventTarget {\n  constructor (node, attrs) {\n    super()\n    this.node = node\n    this.type = node.nodeName\n\n    if (attrs && node !== attrs) {\n      this.attr(attrs)\n    }\n  }\n\n  // Add given element at a position\n  add (element, i) {\n    element = makeInstance(element)\n\n    // If non-root svg nodes are added we have to remove their namespaces\n    if (element.removeNamespace && this.node instanceof globals.window.SVGElement) {\n      element.removeNamespace()\n    }\n\n    if (i == null) {\n      this.node.appendChild(element.node)\n    } else if (element.node !== this.node.childNodes[i]) {\n      this.node.insertBefore(element.node, this.node.childNodes[i])\n    }\n\n    return this\n  }\n\n  // Add element to given container and return self\n  addTo (parent, i) {\n    return makeInstance(parent).put(this, i)\n  }\n\n  // Returns all child elements\n  children () {\n    return new List(map(this.node.children, function (node) {\n      return adopt(node)\n    }))\n  }\n\n  // Remove all elements in this container\n  clear () {\n    // remove children\n    while (this.node.hasChildNodes()) {\n      this.node.removeChild(this.node.lastChild)\n    }\n\n    return this\n  }\n\n  // Clone element\n  clone (deep = true, assignNewIds = true) {\n    // write dom data to the dom so the clone can pickup the data\n    this.writeDataToDom()\n\n    // clone element\n    let nodeClone = this.node.cloneNode(deep)\n    if (assignNewIds) {\n      // assign new id\n      nodeClone = assignNewId(nodeClone)\n    }\n    return new this.constructor(nodeClone)\n  }\n\n  // Iterates over all children and invokes a given block\n  each (block, deep) {\n    const children = this.children()\n    let i, il\n\n    for (i = 0, il = children.length; i < il; i++) {\n      block.apply(children[i], [ i, children ])\n\n      if (deep) {\n        children[i].each(block, deep)\n      }\n    }\n\n    return this\n  }\n\n  element (nodeName, attrs) {\n    return this.put(new Dom(create(nodeName), attrs))\n  }\n\n  // Get first child\n  first () {\n    return adopt(this.node.firstChild)\n  }\n\n  // Get a element at the given index\n  get (i) {\n    return adopt(this.node.childNodes[i])\n  }\n\n  getEventHolder () {\n    return this.node\n  }\n\n  getEventTarget () {\n    return this.node\n  }\n\n  // Checks if the given element is a child\n  has (element) {\n    return this.index(element) >= 0\n  }\n\n  html (htmlOrFn, outerHTML) {\n    return this.xml(htmlOrFn, outerHTML, html)\n  }\n\n  // Get / set id\n  id (id) {\n    // generate new id if no id set\n    if (typeof id === 'undefined' && !this.node.id) {\n      this.node.id = eid(this.type)\n    }\n\n    // don't set directly with this.node.id to make `null` work correctly\n    return this.attr('id', id)\n  }\n\n  // Gets index of given element\n  index (element) {\n    return [].slice.call(this.node.childNodes).indexOf(element.node)\n  }\n\n  // Get the last child\n  last () {\n    return adopt(this.node.lastChild)\n  }\n\n  // matches the element vs a css selector\n  matches (selector) {\n    const el = this.node\n    const matcher = el.matches || el.matchesSelector || el.msMatchesSelector || el.mozMatchesSelector || el.webkitMatchesSelector || el.oMatchesSelector || null\n    return matcher && matcher.call(el, selector)\n  }\n\n  // Returns the parent element instance\n  parent (type) {\n    let parent = this\n\n    // check for parent\n    if (!parent.node.parentNode) return null\n\n    // get parent element\n    parent = adopt(parent.node.parentNode)\n\n    if (!type) return parent\n\n    // loop through ancestors if type is given\n    do {\n      if (typeof type === 'string' ? parent.matches(type) : parent instanceof type) return parent\n    } while ((parent = adopt(parent.node.parentNode)))\n\n    return parent\n  }\n\n  // Basically does the same as `add()` but returns the added element instead\n  put (element, i) {\n    element = makeInstance(element)\n    this.add(element, i)\n    return element\n  }\n\n  // Add element to given container and return container\n  putIn (parent, i) {\n    return makeInstance(parent).add(this, i)\n  }\n\n  // Remove element\n  remove () {\n    if (this.parent()) {\n      this.parent().removeElement(this)\n    }\n\n    return this\n  }\n\n  // Remove a given child\n  removeElement (element) {\n    this.node.removeChild(element.node)\n\n    return this\n  }\n\n  // Replace this with element\n  replace (element) {\n    element = makeInstance(element)\n\n    if (this.node.parentNode) {\n      this.node.parentNode.replaceChild(element.node, this.node)\n    }\n\n    return element\n  }\n\n  round (precision = 2, map = null) {\n    const factor = 10 ** precision\n    const attrs = this.attr(map)\n\n    for (const i in attrs) {\n      if (typeof attrs[i] === 'number') {\n        attrs[i] = Math.round(attrs[i] * factor) / factor\n      }\n    }\n\n    this.attr(attrs)\n    return this\n  }\n\n  // Import / Export raw svg\n  svg (svgOrFn, outerSVG) {\n    return this.xml(svgOrFn, outerSVG, svg)\n  }\n\n  // Return id on string conversion\n  toString () {\n    return this.id()\n  }\n\n  words (text) {\n    // This is faster than removing all children and adding a new one\n    this.node.textContent = text\n    return this\n  }\n\n  wrap (node) {\n    const parent = this.parent()\n\n    if (!parent) {\n      return this.addTo(node)\n    }\n\n    const position = parent.index(this)\n    return parent.put(node, position).put(this)\n  }\n\n  // write svgjs data to the dom\n  writeDataToDom () {\n    // dump variables recursively\n    this.each(function () {\n      this.writeDataToDom()\n    })\n\n    return this\n  }\n\n  // Import / Export raw svg\n  xml (xmlOrFn, outerXML, ns) {\n    if (typeof xmlOrFn === 'boolean') {\n      ns = outerXML\n      outerXML = xmlOrFn\n      xmlOrFn = null\n    }\n\n    // act as getter if no svg string is given\n    if (xmlOrFn == null || typeof xmlOrFn === 'function') {\n      // The default for exports is, that the outerNode is included\n      outerXML = outerXML == null ? true : outerXML\n\n      // write svgjs data to the dom\n      this.writeDataToDom()\n      let current = this\n\n      // An export modifier was passed\n      if (xmlOrFn != null) {\n        current = adopt(current.node.cloneNode(true))\n\n        // If the user wants outerHTML we need to process this node, too\n        if (outerXML) {\n          const result = xmlOrFn(current)\n          current = result || current\n\n          // The user does not want this node? Well, then he gets nothing\n          if (result === false) return ''\n        }\n\n        // Deep loop through all children and apply modifier\n        current.each(function () {\n          const result = xmlOrFn(this)\n          const _this = result || this\n\n          // If modifier returns false, discard node\n          if (result === false) {\n            this.remove()\n\n            // If modifier returns new node, use it\n          } else if (result && this !== _this) {\n            this.replace(_this)\n          }\n        }, true)\n      }\n\n      // Return outer or inner content\n      return outerXML\n        ? current.node.outerHTML\n        : current.node.innerHTML\n    }\n\n    // Act as setter if we got a string\n\n    // The default for import is, that the current node is not replaced\n    outerXML = outerXML == null ? false : outerXML\n\n    // Create temporary holder\n    const well = create('wrapper', ns)\n    const fragment = globals.document.createDocumentFragment()\n\n    // Dump raw svg\n    well.innerHTML = xmlOrFn\n\n    // Transplant nodes into the fragment\n    for (let len = well.children.length; len--;) {\n      fragment.appendChild(well.firstElementChild)\n    }\n\n    const parent = this.parent()\n\n    // Add the whole fragment at once\n    return outerXML\n      ? this.replace(fragment) && parent\n      : this.add(fragment)\n  }\n}\n\nextend(Dom, { attr, find, findOne })\nregister(Dom, 'Dom')\n", "import { bbox, rbox, inside } from '../types/Box.js'\nimport { ctm, screenCTM } from '../types/Matrix.js'\nimport {\n  extend,\n  getClass,\n  makeInstance,\n  register,\n  root\n} from '../utils/adopter.js'\nimport { globals } from '../utils/window.js'\nimport { point } from '../types/Point.js'\nimport { proportionalSize } from '../utils/utils.js'\nimport { reference } from '../modules/core/regex.js'\nimport Dom from './Dom.js'\nimport List from '../types/List.js'\nimport SVGNumber from '../types/SVGNumber.js'\n\nexport default class Element extends Dom {\n  constructor (node, attrs) {\n    super(node, attrs)\n\n    // initialize data object\n    this.dom = {}\n\n    // create circular reference\n    this.node.instance = this\n\n    if (node.hasAttribute('svgjs:data')) {\n      // pull svgjs data from the dom (getAttributeNS doesn't work in html5)\n      this.setData(JSON.parse(node.getAttribute('svgjs:data')) || {})\n    }\n  }\n\n  // Move element by its center\n  center (x, y) {\n    return this.cx(x).cy(y)\n  }\n\n  // Move by center over x-axis\n  cx (x) {\n    return x == null\n      ? this.x() + this.width() / 2\n      : this.x(x - this.width() / 2)\n  }\n\n  // Move by center over y-axis\n  cy (y) {\n    return y == null\n      ? this.y() + this.height() / 2\n      : this.y(y - this.height() / 2)\n  }\n\n  // Get defs\n  defs () {\n    const root = this.root()\n    return root && root.defs()\n  }\n\n  // Relative move over x and y axes\n  dmove (x, y) {\n    return this.dx(x).dy(y)\n  }\n\n  // Relative move over x axis\n  dx (x = 0) {\n    return this.x(new SVGNumber(x).plus(this.x()))\n  }\n\n  // Relative move over y axis\n  dy (y = 0) {\n    return this.y(new SVGNumber(y).plus(this.y()))\n  }\n\n  getEventHolder () {\n    return this\n  }\n\n  // Set height of element\n  height (height) {\n    return this.attr('height', height)\n  }\n\n  // Move element to given x and y values\n  move (x, y) {\n    return this.x(x).y(y)\n  }\n\n  // return array of all ancestors of given type up to the root svg\n  parents (until = this.root()) {\n    const isSelector = typeof until === 'string'\n    if (!isSelector) {\n      until = makeInstance(until)\n    }\n    const parents = new List()\n    let parent = this\n\n    while (\n      (parent = parent.parent())\n      && parent.node !== globals.document\n      && parent.nodeName !== '#document-fragment') {\n\n      parents.push(parent)\n\n      if (!isSelector && (parent.node === until.node)) {\n        break\n      }\n      if (isSelector && parent.matches(until)) {\n        break\n      }\n      if (parent.node === this.root().node) {\n        // We worked our way to the root and didn't match `until`\n        return null\n      }\n    }\n\n    return parents\n  }\n\n  // Get referenced element form attribute value\n  reference (attr) {\n    attr = this.attr(attr)\n    if (!attr) return null\n\n    const m = (attr + '').match(reference)\n    return m ? makeInstance(m[1]) : null\n  }\n\n  // Get parent document\n  root () {\n    const p = this.parent(getClass(root))\n    return p && p.root()\n  }\n\n  // set given data to the elements data property\n  setData (o) {\n    this.dom = o\n    return this\n  }\n\n  // Set element size to given width and height\n  size (width, height) {\n    const p = proportionalSize(this, width, height)\n\n    return this\n      .width(new SVGNumber(p.width))\n      .height(new SVGNumber(p.height))\n  }\n\n  // Set width of element\n  width (width) {\n    return this.attr('width', width)\n  }\n\n  // write svgjs data to the dom\n  writeDataToDom () {\n    // remove previously set data\n    this.node.removeAttribute('svgjs:data')\n\n    if (Object.keys(this.dom).length) {\n      this.node.setAttribute('svgjs:data', JSON.stringify(this.dom)) // see #428\n    }\n\n    return super.writeDataToDom()\n  }\n\n  // Move over x-axis\n  x (x) {\n    return this.attr('x', x)\n  }\n\n  // Move over y-axis\n  y (y) {\n    return this.attr('y', y)\n  }\n}\n\nextend(Element, {\n  bbox, rbox, inside, point, ctm, screenCTM\n})\n\nregister(Element, 'Element')\n", "import { registerMethods } from '../../utils/methods.js'\nimport Color from '../../types/Color.js'\nimport Element from '../../elements/Element.js'\nimport Matrix from '../../types/Matrix.js'\nimport Point from '../../types/Point.js'\nimport SVGNumber from '../../types/SVGNumber.js'\n\n// Define list of available attributes for stroke and fill\nconst sugar = {\n  stroke: [ 'color', 'width', 'opacity', 'linecap', 'linejoin', 'miterlimit', 'dasharray', 'dashoffset' ],\n  fill: [ 'color', 'opacity', 'rule' ],\n  prefix: function (t, a) {\n    return a === 'color' ? t : t + '-' + a\n  }\n}\n\n// Add sugar for fill and stroke\n;[ 'fill', 'stroke' ].forEach(function (m) {\n  const extension = {}\n  let i\n\n  extension[m] = function (o) {\n    if (typeof o === 'undefined') {\n      return this.attr(m)\n    }\n    if (typeof o === 'string' || o instanceof Color || Color.isRgb(o) || (o instanceof Element)) {\n      this.attr(m, o)\n    } else {\n      // set all attributes from sugar.fill and sugar.stroke list\n      for (i = sugar[m].length - 1; i >= 0; i--) {\n        if (o[sugar[m][i]] != null) {\n          this.attr(sugar.prefix(m, sugar[m][i]), o[sugar[m][i]])\n        }\n      }\n    }\n\n    return this\n  }\n\n  registerMethods([ 'Element', 'Runner' ], extension)\n})\n\nregisterMethods([ 'Element', 'Runner' ], {\n  // Let the user set the matrix directly\n  matrix: function (mat, b, c, d, e, f) {\n    // Act as a getter\n    if (mat == null) {\n      return new Matrix(this)\n    }\n\n    // Act as a setter, the user can pass a matrix or a set of numbers\n    return this.attr('transform', new Matrix(mat, b, c, d, e, f))\n  },\n\n  // Map rotation to transform\n  rotate: function (angle, cx, cy) {\n    return this.transform({ rotate: angle, ox: cx, oy: cy }, true)\n  },\n\n  // Map skew to transform\n  skew: function (x, y, cx, cy) {\n    return arguments.length === 1 || arguments.length === 3\n      ? this.transform({ skew: x, ox: y, oy: cx }, true)\n      : this.transform({ skew: [ x, y ], ox: cx, oy: cy }, true)\n  },\n\n  shear: function (lam, cx, cy) {\n    return this.transform({ shear: lam, ox: cx, oy: cy }, true)\n  },\n\n  // Map scale to transform\n  scale: function (x, y, cx, cy) {\n    return arguments.length === 1 || arguments.length === 3\n      ? this.transform({ scale: x, ox: y, oy: cx }, true)\n      : this.transform({ scale: [ x, y ], ox: cx, oy: cy }, true)\n  },\n\n  // Map translate to transform\n  translate: function (x, y) {\n    return this.transform({ translate: [ x, y ] }, true)\n  },\n\n  // Map relative translations to transform\n  relative: function (x, y) {\n    return this.transform({ relative: [ x, y ] }, true)\n  },\n\n  // Map flip to transform\n  flip: function (direction = 'both', origin = 'center') {\n    if ('xybothtrue'.indexOf(direction) === -1) {\n      origin = direction\n      direction = 'both'\n    }\n\n    return this.transform({ flip: direction, origin: origin }, true)\n  },\n\n  // Opacity\n  opacity: function (value) {\n    return this.attr('opacity', value)\n  }\n})\n\nregisterMethods('radius', {\n  // Add x and y radius\n  radius: function (x, y = x) {\n    const type = (this._element || this).type\n    return type === 'radialGradient'\n      ? this.attr('r', new SVGNumber(x))\n      : this.rx(x).ry(y)\n  }\n})\n\nregisterMethods('Path', {\n  // Get path length\n  length: function () {\n    return this.node.getTotalLength()\n  },\n  // Get point at length\n  pointAt: function (length) {\n    return new Point(this.node.getPointAtLength(length))\n  }\n})\n\nregisterMethods([ 'Element', 'Runner' ], {\n  // Set font\n  font: function (a, v) {\n    if (typeof a === 'object') {\n      for (v in a) this.font(v, a[v])\n      return this\n    }\n\n    return a === 'leading'\n      ? this.leading(v)\n      : a === 'anchor'\n        ? this.attr('text-anchor', v)\n        : a === 'size' || a === 'family' || a === 'weight' || a === 'stretch' || a === 'variant' || a === 'style'\n          ? this.attr('font-' + a, v)\n          : this.attr(a, v)\n  }\n})\n\n// Add events to elements\nconst methods = [ 'click',\n  'dblclick',\n  'mousedown',\n  'mouseup',\n  'mouseover',\n  'mouseout',\n  'mousemove',\n  'mouseenter',\n  'mouseleave',\n  'touchstart',\n  'touchmove',\n  'touchleave',\n  'touchend',\n  'touchcancel' ].reduce(function (last, event) {\n  // add event to Element\n  const fn = function (f) {\n    if (f === null) {\n      this.off(event)\n    } else {\n      this.on(event, f)\n    }\n    return this\n  }\n\n  last[event] = fn\n  return last\n}, {})\n\nregisterMethods('Element', methods)\n", "import { getOrigin } from '../../utils/utils.js'\nimport { delimiter, transforms } from '../core/regex.js'\nimport { registerMethods } from '../../utils/methods.js'\nimport Matrix from '../../types/Matrix.js'\n\n// Reset all transformations\nexport function untransform () {\n  return this.attr('transform', null)\n}\n\n// merge the whole transformation chain into one matrix and returns it\nexport function matrixify () {\n  const matrix = (this.attr('transform') || '')\n    // split transformations\n    .split(transforms).slice(0, -1).map(function (str) {\n      // generate key => value pairs\n      const kv = str.trim().split('(')\n      return [ kv[0],\n        kv[1].split(delimiter)\n          .map(function (str) {\n            return parseFloat(str)\n          })\n      ]\n    })\n    .reverse()\n    // merge every transformation into one matrix\n    .reduce(function (matrix, transform) {\n      if (transform[0] === 'matrix') {\n        return matrix.lmultiply(Matrix.fromArray(transform[1]))\n      }\n      return matrix[transform[0]].apply(matrix, transform[1])\n    }, new Matrix())\n\n  return matrix\n}\n\n// add an element to another parent without changing the visual representation on the screen\nexport function toParent (parent, i) {\n  if (this === parent) return this\n  const ctm = this.screenCTM()\n  const pCtm = parent.screenCTM().inverse()\n\n  this.addTo(parent, i).untransform().transform(pCtm.multiply(ctm))\n\n  return this\n}\n\n// same as above with parent equals root-svg\nexport function toRoot (i) {\n  return this.toParent(this.root(), i)\n}\n\n// Add transformations\nexport function transform (o, relative) {\n  // Act as a getter if no object was passed\n  if (o == null || typeof o === 'string') {\n    const decomposed = new Matrix(this).decompose()\n    return o == null ? decomposed : decomposed[o]\n  }\n\n  if (!Matrix.isMatrixLike(o)) {\n    // Set the origin according to the defined transform\n    o = { ...o, origin: getOrigin(o, this) }\n  }\n\n  // The user can pass a boolean, an Element or an Matrix or nothing\n  const cleanRelative = relative === true ? this : (relative || false)\n  const result = new Matrix(cleanRelative).transform(o)\n  return this.attr('transform', result)\n}\n\nregisterMethods('Element', {\n  untransform, matrixify, toParent, toRoot, transform\n})\n", "import { register } from '../utils/adopter.js'\nimport Element from './Element.js'\n\nexport default class Container extends Element {\n  flatten (parent = this, index) {\n    this.each(function () {\n      if (this instanceof Container) {\n        return this.flatten().ungroup()\n      }\n    })\n\n    return this\n  }\n\n  ungroup (parent = this.parent(), index = parent.index(this)) {\n    // when parent != this, we want append all elements to the end\n    index = index === -1 ? parent.children().length : index\n\n    this.each(function (i, children) {\n      // reverse each\n      return children[children.length - i - 1].toParent(parent, index)\n    })\n\n    return this.remove()\n  }\n}\n\nregister(Container, 'Container')\n", "import { nodeOrNew, register } from '../utils/adopter.js'\nimport Container from './Container.js'\n\nexport default class Defs extends Container {\n  constructor (node, attrs = node) {\n    super(nodeOrNew('defs', node), attrs)\n  }\n\n  flatten () {\n    return this\n  }\n\n  ungroup () {\n    return this\n  }\n}\n\nregister(Defs, 'Defs')\n", "import { register } from '../utils/adopter.js'\nimport Element from './Element.js'\n\nexport default class Shape extends Element {}\n\nregister(Shape, 'Shape')\n", "import SVGNumber from '../../types/SVGNumber.js'\n\n// Radius x value\nexport function rx (rx) {\n  return this.attr('rx', rx)\n}\n\n// Radius y value\nexport function ry (ry) {\n  return this.attr('ry', ry)\n}\n\n// Move over x-axis\nexport function x (x) {\n  return x == null\n    ? this.cx() - this.rx()\n    : this.cx(x + this.rx())\n}\n\n// Move over y-axis\nexport function y (y) {\n  return y == null\n    ? this.cy() - this.ry()\n    : this.cy(y + this.ry())\n}\n\n// Move by center over x-axis\nexport function cx (x) {\n  return this.attr('cx', x)\n}\n\n// Move by center over y-axis\nexport function cy (y) {\n  return this.attr('cy', y)\n}\n\n// Set width of element\nexport function width (width) {\n  return width == null\n    ? this.rx() * 2\n    : this.rx(new SVGNumber(width).divide(2))\n}\n\n// Set height of element\nexport function height (height) {\n  return height == null\n    ? this.ry() * 2\n    : this.ry(new SVGNumber(height).divide(2))\n}\n", "import {\n  extend,\n  nodeOrNew,\n  register,\n  wrapWithAttrCheck\n} from '../utils/adopter.js'\nimport { proportionalSize } from '../utils/utils.js'\nimport { registerMethods } from '../utils/methods.js'\nimport SVGNumber from '../types/SVGNumber.js'\nimport Shape from './Shape.js'\nimport * as circled from '../modules/core/circled.js'\n\nexport default class Ellipse extends Shape {\n  constructor (node, attrs = node) {\n    super(nodeOrNew('ellipse', node), attrs)\n  }\n\n  size (width, height) {\n    const p = proportionalSize(this, width, height)\n\n    return this\n      .rx(new SVGNumber(p.width).divide(2))\n      .ry(new SVGNumber(p.height).divide(2))\n  }\n}\n\nextend(Ellipse, circled)\n\nregisterMethods('Container', {\n  // Create an ellipse\n  ellipse: wrapWithAttrCheck(function (width = 0, height = width) {\n    return this.put(new Ellipse()).size(width, height).move(0, 0)\n  })\n})\n\nregister(Ellipse, 'Ellipse')\n", "import Dom from './Dom.js'\nimport { globals } from '../utils/window.js'\nimport { register, create } from '../utils/adopter.js'\n\nclass Fragment extends Dom {\n  constructor (node = globals.document.createDocumentFragment()) {\n    super(node)\n  }\n\n  // Import / Export raw xml\n  xml (xmlOrFn, outerXML, ns) {\n    if (typeof xmlOrFn === 'boolean') {\n      ns = outerXML\n      outerXML = xmlOrFn\n      xmlOrFn = null\n    }\n\n    // because this is a fragment we have to put all elements into a wrapper first\n    // before we can get the innerXML from it\n    if (xmlOrFn == null || typeof xmlOrFn === 'function') {\n      const wrapper = new Dom(create('wrapper', ns))\n      wrapper.add(this.node.cloneNode(true))\n\n      return wrapper.xml(false, ns)\n    }\n\n    // Act as setter if we got a string\n    return super.xml(xmlOrFn, false, ns)\n  }\n\n}\n\nregister(Fragment, 'Fragment')\n\nexport default Fragment\n", "import SVGNumber from '../../types/SVGNumber.js'\n\nexport function from (x, y) {\n  return (this._element || this).type === 'radialGradient'\n    ? this.attr({ fx: new SVGNumber(x), fy: new SVGNumber(y) })\n    : this.attr({ x1: new SVGNumber(x), y1: new SVGNumber(y) })\n}\n\nexport function to (x, y) {\n  return (this._element || this).type === 'radialGradient'\n    ? this.attr({ cx: new SVGNumber(x), cy: new SVGNumber(y) })\n    : this.attr({ x2: new SVGNumber(x), y2: new SVGNumber(y) })\n}\n", "import {\n  extend,\n  nodeOrNew,\n  register,\n  wrapWithAttrCheck\n} from '../utils/adopter.js'\nimport { registerMethods } from '../utils/methods.js'\nimport Box from '../types/Box.js'\nimport Container from './Container.js'\nimport baseFind from '../modules/core/selector.js'\nimport * as gradiented from '../modules/core/gradiented.js'\n\nexport default class Gradient extends Container {\n  constructor (type, attrs) {\n    super(\n      nodeOrNew(type + 'Gradient', typeof type === 'string' ? null : type),\n      attrs\n    )\n  }\n\n  // custom attr to handle transform\n  attr (a, b, c) {\n    if (a === 'transform') a = 'gradientTransform'\n    return super.attr(a, b, c)\n  }\n\n  bbox () {\n    return new Box()\n  }\n\n  targets () {\n    return baseFind('svg [fill*=' + this.id() + ']')\n  }\n\n  // Alias string conversion to fill\n  toString () {\n    return this.url()\n  }\n\n  // Update gradient\n  update (block) {\n    // remove all stops\n    this.clear()\n\n    // invoke passed block\n    if (typeof block === 'function') {\n      block.call(this, this)\n    }\n\n    return this\n  }\n\n  // Return the fill id\n  url () {\n    return 'url(#' + this.id() + ')'\n  }\n}\n\nextend(Gradient, gradiented)\n\nregisterMethods({\n  Container: {\n    // Create gradient element in defs\n    gradient (...args) {\n      return this.defs().gradient(...args)\n    }\n  },\n  // define gradient\n  Defs: {\n    gradient: wrapWithAttrCheck(function (type, block) {\n      return this.put(new Gradient(type)).update(block)\n    })\n  }\n})\n\nregister(Gradient, 'Gradient')\n", "import { nodeOrNew, register, wrapWithAttrCheck } from '../utils/adopter.js'\nimport { registerMethods } from '../utils/methods.js'\nimport Box from '../types/Box.js'\nimport Container from './Container.js'\nimport baseFind from '../modules/core/selector.js'\n\nexport default class Pattern extends Container {\n  // Initialize node\n  constructor (node, attrs = node) {\n    super(nodeOrNew('pattern', node), attrs)\n  }\n\n  // custom attr to handle transform\n  attr (a, b, c) {\n    if (a === 'transform') a = 'patternTransform'\n    return super.attr(a, b, c)\n  }\n\n  bbox () {\n    return new Box()\n  }\n\n  targets () {\n    return baseFind('svg [fill*=' + this.id() + ']')\n  }\n\n  // Alias string conversion to fill\n  toString () {\n    return this.url()\n  }\n\n  // Update pattern by rebuilding\n  update (block) {\n    // remove content\n    this.clear()\n\n    // invoke passed block\n    if (typeof block === 'function') {\n      block.call(this, this)\n    }\n\n    return this\n  }\n\n  // Return the fill id\n  url () {\n    return 'url(#' + this.id() + ')'\n  }\n\n}\n\nregisterMethods({\n  Container: {\n    // Create pattern element in defs\n    pattern (...args) {\n      return this.defs().pattern(...args)\n    }\n  },\n  Defs: {\n    pattern: wrapWithAttrCheck(function (width, height, block) {\n      return this.put(new Pattern()).update(block).attr({\n        x: 0,\n        y: 0,\n        width: width,\n        height: height,\n        patternUnits: 'userSpaceOnUse'\n      })\n    })\n  }\n})\n\nregister(Pattern, 'Pattern')\n", "import { isImage } from '../modules/core/regex.js'\nimport { nodeOrNew, register, wrapWithAttrCheck } from '../utils/adopter.js'\nimport { off, on } from '../modules/core/event.js'\nimport { registerAttrHook } from '../modules/core/attr.js'\nimport { registerMethods } from '../utils/methods.js'\nimport { xlink } from '../modules/core/namespaces.js'\nimport Pattern from './Pattern.js'\nimport Shape from './Shape.js'\nimport { globals } from '../utils/window.js'\n\nexport default class Image extends Shape {\n  constructor (node, attrs = node) {\n    super(nodeOrNew('image', node), attrs)\n  }\n\n  // (re)load image\n  load (url, callback) {\n    if (!url) return this\n\n    const img = new globals.window.Image()\n\n    on(img, 'load', function (e) {\n      const p = this.parent(Pattern)\n\n      // ensure image size\n      if (this.width() === 0 && this.height() === 0) {\n        this.size(img.width, img.height)\n      }\n\n      if (p instanceof Pattern) {\n        // ensure pattern size if not set\n        if (p.width() === 0 && p.height() === 0) {\n          p.size(this.width(), this.height())\n        }\n      }\n\n      if (typeof callback === 'function') {\n        callback.call(this, e)\n      }\n    }, this)\n\n    on(img, 'load error', function () {\n      // dont forget to unbind memory leaking events\n      off(img)\n    })\n\n    return this.attr('href', (img.src = url), xlink)\n  }\n}\n\nregisterAttrHook(function (attr, val, _this) {\n  // convert image fill and stroke to patterns\n  if (attr === 'fill' || attr === 'stroke') {\n    if (isImage.test(val)) {\n      val = _this.root().defs().image(val)\n    }\n  }\n\n  if (val instanceof Image) {\n    val = _this.root().defs().pattern(0, 0, (pattern) => {\n      pattern.add(val)\n    })\n  }\n\n  return val\n})\n\nregisterMethods({\n  Container: {\n    // create image element, load image and set its size\n    image: wrapWithAttrCheck(function (source, callback) {\n      return this.put(new Image()).size(0, 0).load(source, callback)\n    })\n  }\n})\n\nregister(Image, 'Image')\n", "import { delimiter } from '../modules/core/regex.js'\nimport SVGArray from './SVGArray.js'\nimport Box from './Box.js'\nimport Matrix from './Matrix.js'\n\nexport default class PointArray extends SVGArray {\n  // Get bounding box of points\n  bbox () {\n    let maxX = -Infinity\n    let maxY = -Infinity\n    let minX = Infinity\n    let minY = Infinity\n    this.forEach(function (el) {\n      maxX = Math.max(el[0], maxX)\n      maxY = Math.max(el[1], maxY)\n      minX = Math.min(el[0], minX)\n      minY = Math.min(el[1], minY)\n    })\n    return new Box(minX, minY, maxX - minX, maxY - minY)\n  }\n\n  // Move point string\n  move (x, y) {\n    const box = this.bbox()\n\n    // get relative offset\n    x -= box.x\n    y -= box.y\n\n    // move every point\n    if (!isNaN(x) && !isNaN(y)) {\n      for (let i = this.length - 1; i >= 0; i--) {\n        this[i] = [ this[i][0] + x, this[i][1] + y ]\n      }\n    }\n\n    return this\n  }\n\n  // Parse point string and flat array\n  parse (array = [ 0, 0 ]) {\n    const points = []\n\n    // if it is an array, we flatten it and therefore clone it to 1 depths\n    if (array instanceof Array) {\n      array = Array.prototype.concat.apply([], array)\n    } else { // Else, it is considered as a string\n      // parse points\n      array = array.trim().split(delimiter).map(parseFloat)\n    }\n\n    // validate points - https://svgwg.org/svg2-draft/shapes.html#DataTypePoints\n    // Odd number of coordinates is an error. In such cases, drop the last odd coordinate.\n    if (array.length % 2 !== 0) array.pop()\n\n    // wrap points in two-tuples\n    for (let i = 0, len = array.length; i < len; i = i + 2) {\n      points.push([ array[i], array[i + 1] ])\n    }\n\n    return points\n  }\n\n  // Resize poly string\n  size (width, height) {\n    let i\n    const box = this.bbox()\n\n    // recalculate position of all points according to new size\n    for (i = this.length - 1; i >= 0; i--) {\n      if (box.width) this[i][0] = ((this[i][0] - box.x) * width) / box.width + box.x\n      if (box.height) this[i][1] = ((this[i][1] - box.y) * height) / box.height + box.y\n    }\n\n    return this\n  }\n\n  // Convert array to line object\n  toLine () {\n    return {\n      x1: this[0][0],\n      y1: this[0][1],\n      x2: this[1][0],\n      y2: this[1][1]\n    }\n  }\n\n  // Convert array to string\n  toString () {\n    const array = []\n    // convert to a poly point string\n    for (let i = 0, il = this.length; i < il; i++) {\n      array.push(this[i].join(','))\n    }\n\n    return array.join(' ')\n  }\n\n  transform (m) {\n    return this.clone().transformO(m)\n  }\n\n  // transform points with matrix (similar to Point.transform)\n  transformO (m) {\n    if (!Matrix.isMatrixLike(m)) {\n      m = new Matrix(m)\n    }\n\n    for (let i = this.length; i--;) {\n      // Perform the matrix multiplication\n      const [ x, y ] = this[i]\n      this[i][0] = m.a * x + m.c * y + m.e\n      this[i][1] = m.b * x + m.d * y + m.f\n    }\n\n    return this\n  }\n\n}\n", "import PointArray from '../../types/PointArray.js'\n\nexport const MorphArray = PointArray\n\n// Move by left top corner over x-axis\nexport function x (x) {\n  return x == null ? this.bbox().x : this.move(x, this.bbox().y)\n}\n\n// Move by left top corner over y-axis\nexport function y (y) {\n  return y == null ? this.bbox().y : this.move(this.bbox().x, y)\n}\n\n// Set width of element\nexport function width (width) {\n  const b = this.bbox()\n  return width == null ? b.width : this.size(width, b.height)\n}\n\n// Set height of element\nexport function height (height) {\n  const b = this.bbox()\n  return height == null ? b.height : this.size(b.width, height)\n}\n", "import {\n  extend,\n  nodeOrNew,\n  register,\n  wrapWithAttrCheck\n} from '../utils/adopter.js'\nimport { proportionalSize } from '../utils/utils.js'\nimport { registerMethods } from '../utils/methods.js'\nimport PointArray from '../types/PointArray.js'\nimport Shape from './Shape.js'\nimport * as pointed from '../modules/core/pointed.js'\n\nexport default class Line extends Shape {\n  // Initialize node\n  constructor (node, attrs = node) {\n    super(nodeOrNew('line', node), attrs)\n  }\n\n  // Get array\n  array () {\n    return new PointArray([\n      [ this.attr('x1'), this.attr('y1') ],\n      [ this.attr('x2'), this.attr('y2') ]\n    ])\n  }\n\n  // Move by left top corner\n  move (x, y) {\n    return this.attr(this.array().move(x, y).toLine())\n  }\n\n  // Overwrite native plot() method\n  plot (x1, y1, x2, y2) {\n    if (x1 == null) {\n      return this.array()\n    } else if (typeof y1 !== 'undefined') {\n      x1 = { x1, y1, x2, y2 }\n    } else {\n      x1 = new PointArray(x1).toLine()\n    }\n\n    return this.attr(x1)\n  }\n\n  // Set element size to given width and height\n  size (width, height) {\n    const p = proportionalSize(this, width, height)\n    return this.attr(this.array().size(p.width, p.height).toLine())\n  }\n}\n\nextend(Line, pointed)\n\nregisterMethods({\n  Container: {\n    // Create a line element\n    line: wrapWithAttrCheck(function (...args) {\n      // make sure plot is called as a setter\n      // x1 is not necessarily a number, it can also be an array, a string and a PointArray\n      return Line.prototype.plot.apply(\n        this.put(new Line())\n        , args[0] != null ? args : [ 0, 0, 0, 0 ]\n      )\n    })\n  }\n})\n\nregister(Line, 'Line')\n", "import { nodeOrNew, register, wrapWithAttrCheck } from '../utils/adopter.js'\nimport { registerMethods } from '../utils/methods.js'\nimport Container from './Container.js'\n\nexport default class Marker extends Container {\n  // Initialize node\n  constructor (node, attrs = node) {\n    super(nodeOrNew('marker', node), attrs)\n  }\n\n  // Set height of element\n  height (height) {\n    return this.attr('markerHeight', height)\n  }\n\n  orient (orient) {\n    return this.attr('orient', orient)\n  }\n\n  // Set marker refX and refY\n  ref (x, y) {\n    return this.attr('refX', x).attr('refY', y)\n  }\n\n  // Return the fill id\n  toString () {\n    return 'url(#' + this.id() + ')'\n  }\n\n  // Update marker\n  update (block) {\n    // remove all content\n    this.clear()\n\n    // invoke passed block\n    if (typeof block === 'function') {\n      block.call(this, this)\n    }\n\n    return this\n  }\n\n  // Set width of element\n  width (width) {\n    return this.attr('markerWidth', width)\n  }\n\n}\n\nregisterMethods({\n  Container: {\n    marker (...args) {\n      // Create marker element in defs\n      return this.defs().marker(...args)\n    }\n  },\n  Defs: {\n    // Create marker\n    marker: wrapWithAttrCheck(function (width, height, block) {\n      // Set default viewbox to match the width and height, set ref to cx and cy and set orient to auto\n      return this.put(new Marker())\n        .size(width, height)\n        .ref(width / 2, height / 2)\n        .viewbox(0, 0, width, height)\n        .attr('orient', 'auto')\n        .update(block)\n    })\n  },\n  marker: {\n    // Create and attach markers\n    marker (marker, width, height, block) {\n      let attr = [ 'marker' ]\n\n      // Build attribute name\n      if (marker !== 'all') attr.push(marker)\n      attr = attr.join('-')\n\n      // Set marker attribute\n      marker = arguments[1] instanceof Marker\n        ? arguments[1]\n        : this.defs().marker(width, height, block)\n\n      return this.attr(attr, marker)\n    }\n  }\n})\n\nregister(Marker, 'Marker')\n", "import { timeline } from '../modules/core/defaults.js'\nimport { extend } from '../utils/adopter.js'\n\n/***\nBase Class\n==========\nThe base stepper class that will be\n***/\n\nfunction makeSetterGetter (k, f) {\n  return function (v) {\n    if (v == null) return this[k]\n    this[k] = v\n    if (f) f.call(this)\n    return this\n  }\n}\n\nexport const easing = {\n  '-': function (pos) {\n    return pos\n  },\n  '<>': function (pos) {\n    return -Math.cos(pos * Math.PI) / 2 + 0.5\n  },\n  '>': function (pos) {\n    return Math.sin(pos * Math.PI / 2)\n  },\n  '<': function (pos) {\n    return -Math.cos(pos * Math.PI / 2) + 1\n  },\n  bezier: function (x1, y1, x2, y2) {\n    // see https://www.w3.org/TR/css-easing-1/#cubic-bezier-algo\n    return function (t) {\n      if (t < 0) {\n        if (x1 > 0) {\n          return y1 / x1 * t\n        } else if (x2 > 0) {\n          return y2 / x2 * t\n        } else {\n          return 0\n        }\n      } else if (t > 1) {\n        if (x2 < 1) {\n          return (1 - y2) / (1 - x2) * t + (y2 - x2) / (1 - x2)\n        } else if (x1 < 1) {\n          return (1 - y1) / (1 - x1) * t + (y1 - x1) / (1 - x1)\n        } else {\n          return 1\n        }\n      } else {\n        return 3 * t * (1 - t) ** 2 * y1 + 3 * t ** 2 * (1 - t) * y2 + t ** 3\n      }\n    }\n  },\n  // see https://www.w3.org/TR/css-easing-1/#step-timing-function-algo\n  steps: function (steps, stepPosition = 'end') {\n    // deal with \"jump-\" prefix\n    stepPosition = stepPosition.split('-').reverse()[0]\n\n    let jumps = steps\n    if (stepPosition === 'none') {\n      --jumps\n    } else if (stepPosition === 'both') {\n      ++jumps\n    }\n\n    // The beforeFlag is essentially useless\n    return (t, beforeFlag = false) => {\n      // Step is called currentStep in referenced url\n      let step = Math.floor(t * steps)\n      const jumping = (t * step) % 1 === 0\n\n      if (stepPosition === 'start' || stepPosition === 'both') {\n        ++step\n      }\n\n      if (beforeFlag && jumping) {\n        --step\n      }\n\n      if (t >= 0 && step < 0) {\n        step = 0\n      }\n\n      if (t <= 1 && step > jumps) {\n        step = jumps\n      }\n\n      return step / jumps\n    }\n  }\n}\n\nexport class Stepper {\n  done () {\n    return false\n  }\n}\n\n/***\nEasing Functions\n================\n***/\n\nexport class Ease extends Stepper {\n  constructor (fn = timeline.ease) {\n    super()\n    this.ease = easing[fn] || fn\n  }\n\n  step (from, to, pos) {\n    if (typeof from !== 'number') {\n      return pos < 1 ? from : to\n    }\n    return from + (to - from) * this.ease(pos)\n  }\n}\n\n/***\nController Types\n================\n***/\n\nexport class Controller extends Stepper {\n  constructor (fn) {\n    super()\n    this.stepper = fn\n  }\n\n  done (c) {\n    return c.done\n  }\n\n  step (current, target, dt, c) {\n    return this.stepper(current, target, dt, c)\n  }\n\n}\n\nfunction recalculate () {\n  // Apply the default parameters\n  const duration = (this._duration || 500) / 1000\n  const overshoot = this._overshoot || 0\n\n  // Calculate the PID natural response\n  const eps = 1e-10\n  const pi = Math.PI\n  const os = Math.log(overshoot / 100 + eps)\n  const zeta = -os / Math.sqrt(pi * pi + os * os)\n  const wn = 3.9 / (zeta * duration)\n\n  // Calculate the Spring values\n  this.d = 2 * zeta * wn\n  this.k = wn * wn\n}\n\nexport class Spring extends Controller {\n  constructor (duration = 500, overshoot = 0) {\n    super()\n    this.duration(duration)\n      .overshoot(overshoot)\n  }\n\n  step (current, target, dt, c) {\n    if (typeof current === 'string') return current\n    c.done = dt === Infinity\n    if (dt === Infinity) return target\n    if (dt === 0) return current\n\n    if (dt > 100) dt = 16\n\n    dt /= 1000\n\n    // Get the previous velocity\n    const velocity = c.velocity || 0\n\n    // Apply the control to get the new position and store it\n    const acceleration = -this.d * velocity - this.k * (current - target)\n    const newPosition = current\n      + velocity * dt\n      + acceleration * dt * dt / 2\n\n    // Store the velocity\n    c.velocity = velocity + acceleration * dt\n\n    // Figure out if we have converged, and if so, pass the value\n    c.done = Math.abs(target - newPosition) + Math.abs(velocity) < 0.002\n    return c.done ? target : newPosition\n  }\n}\n\nextend(Spring, {\n  duration: makeSetterGetter('_duration', recalculate),\n  overshoot: makeSetterGetter('_overshoot', recalculate)\n})\n\nexport class PID extends Controller {\n  constructor (p = 0.1, i = 0.01, d = 0, windup = 1000) {\n    super()\n    this.p(p).i(i).d(d).windup(windup)\n  }\n\n  step (current, target, dt, c) {\n    if (typeof current === 'string') return current\n    c.done = dt === Infinity\n\n    if (dt === Infinity) return target\n    if (dt === 0) return current\n\n    const p = target - current\n    let i = (c.integral || 0) + p * dt\n    const d = (p - (c.error || 0)) / dt\n    const windup = this._windup\n\n    // antiwindup\n    if (windup !== false) {\n      i = Math.max(-windup, Math.min(i, windup))\n    }\n\n    c.error = p\n    c.integral = i\n\n    c.done = Math.abs(p) < 0.001\n\n    return c.done ? target : current + (this.P * p + this.I * i + this.D * d)\n  }\n}\n\nextend(PID, {\n  windup: makeSetterGetter('_windup'),\n  p: makeSetterGetter('P'),\n  i: makeSetterGetter('I'),\n  d: makeSetterGetter('D')\n})\n", "import { isPathLetter } from '../modules/core/regex.js'\nimport Point from '../types/Point.js'\n\nconst segmentParameters = { M: 2, L: 2, H: 1, V: 1, C: 6, S: 4, Q: 4, T: 2, A: 7, Z: 0 }\n\nconst pathHandlers = {\n  M: function (c, p, p0) {\n    p.x = p0.x = c[0]\n    p.y = p0.y = c[1]\n\n    return [ 'M', p.x, p.y ]\n  },\n  L: function (c, p) {\n    p.x = c[0]\n    p.y = c[1]\n    return [ 'L', c[0], c[1] ]\n  },\n  H: function (c, p) {\n    p.x = c[0]\n    return [ 'H', c[0] ]\n  },\n  V: function (c, p) {\n    p.y = c[0]\n    return [ 'V', c[0] ]\n  },\n  C: function (c, p) {\n    p.x = c[4]\n    p.y = c[5]\n    return [ 'C', c[0], c[1], c[2], c[3], c[4], c[5] ]\n  },\n  S: function (c, p) {\n    p.x = c[2]\n    p.y = c[3]\n    return [ 'S', c[0], c[1], c[2], c[3] ]\n  },\n  Q: function (c, p) {\n    p.x = c[2]\n    p.y = c[3]\n    return [ 'Q', c[0], c[1], c[2], c[3] ]\n  },\n  T: function (c, p) {\n    p.x = c[0]\n    p.y = c[1]\n    return [ 'T', c[0], c[1] ]\n  },\n  Z: function (c, p, p0) {\n    p.x = p0.x\n    p.y = p0.y\n    return [ 'Z' ]\n  },\n  A: function (c, p) {\n    p.x = c[5]\n    p.y = c[6]\n    return [ 'A', c[0], c[1], c[2], c[3], c[4], c[5], c[6] ]\n  }\n}\n\nconst mlhvqtcsaz = 'mlhvqtcsaz'.split('')\n\nfor (let i = 0, il = mlhvqtcsaz.length; i < il; ++i) {\n  pathHandlers[mlhvqtcsaz[i]] = (function (i) {\n    return function (c, p, p0) {\n      if (i === 'H') c[0] = c[0] + p.x\n      else if (i === 'V') c[0] = c[0] + p.y\n      else if (i === 'A') {\n        c[5] = c[5] + p.x\n        c[6] = c[6] + p.y\n      } else {\n        for (let j = 0, jl = c.length; j < jl; ++j) {\n          c[j] = c[j] + (j % 2 ? p.y : p.x)\n        }\n      }\n\n      return pathHandlers[i](c, p, p0)\n    }\n  })(mlhvqtcsaz[i].toUpperCase())\n}\n\nfunction makeAbsolut (parser) {\n  const command = parser.segment[0]\n  return pathHandlers[command](parser.segment.slice(1), parser.p, parser.p0)\n}\n\nfunction segmentComplete (parser) {\n  return parser.segment.length && parser.segment.length - 1 === segmentParameters[parser.segment[0].toUpperCase()]\n}\n\nfunction startNewSegment (parser, token) {\n  parser.inNumber && finalizeNumber(parser, false)\n  const pathLetter = isPathLetter.test(token)\n\n  if (pathLetter) {\n    parser.segment = [ token ]\n  } else {\n    const lastCommand = parser.lastCommand\n    const small = lastCommand.toLowerCase()\n    const isSmall = lastCommand === small\n    parser.segment = [ small === 'm' ? (isSmall ? 'l' : 'L') : lastCommand ]\n  }\n\n  parser.inSegment = true\n  parser.lastCommand = parser.segment[0]\n\n  return pathLetter\n}\n\nfunction finalizeNumber (parser, inNumber) {\n  if (!parser.inNumber) throw new Error('Parser Error')\n  parser.number && parser.segment.push(parseFloat(parser.number))\n  parser.inNumber = inNumber\n  parser.number = ''\n  parser.pointSeen = false\n  parser.hasExponent = false\n\n  if (segmentComplete(parser)) {\n    finalizeSegment(parser)\n  }\n}\n\nfunction finalizeSegment (parser) {\n  parser.inSegment = false\n  if (parser.absolute) {\n    parser.segment = makeAbsolut(parser)\n  }\n  parser.segments.push(parser.segment)\n}\n\nfunction isArcFlag (parser) {\n  if (!parser.segment.length) return false\n  const isArc = parser.segment[0].toUpperCase() === 'A'\n  const length = parser.segment.length\n\n  return isArc && (length === 4 || length === 5)\n}\n\nfunction isExponential (parser) {\n  return parser.lastToken.toUpperCase() === 'E'\n}\n\nexport function pathParser (d, toAbsolute = true) {\n\n  let index = 0\n  let token = ''\n  const parser = {\n    segment: [],\n    inNumber: false,\n    number: '',\n    lastToken: '',\n    inSegment: false,\n    segments: [],\n    pointSeen: false,\n    hasExponent: false,\n    absolute: toAbsolute,\n    p0: new Point(),\n    p: new Point()\n  }\n\n  while ((parser.lastToken = token, token = d.charAt(index++))) {\n    if (!parser.inSegment) {\n      if (startNewSegment(parser, token)) {\n        continue\n      }\n    }\n\n    if (token === '.') {\n      if (parser.pointSeen || parser.hasExponent) {\n        finalizeNumber(parser, false)\n        --index\n        continue\n      }\n      parser.inNumber = true\n      parser.pointSeen = true\n      parser.number += token\n      continue\n    }\n\n    if (!isNaN(parseInt(token))) {\n\n      if (parser.number === '0' || isArcFlag(parser)) {\n        parser.inNumber = true\n        parser.number = token\n        finalizeNumber(parser, true)\n        continue\n      }\n\n      parser.inNumber = true\n      parser.number += token\n      continue\n    }\n\n    if (token === ' ' || token === ',') {\n      if (parser.inNumber) {\n        finalizeNumber(parser, false)\n      }\n      continue\n    }\n\n    if (token === '-') {\n      if (parser.inNumber && !isExponential(parser)) {\n        finalizeNumber(parser, false)\n        --index\n        continue\n      }\n      parser.number += token\n      parser.inNumber = true\n      continue\n    }\n\n    if (token.toUpperCase() === 'E') {\n      parser.number += token\n      parser.hasExponent = true\n      continue\n    }\n\n    if (isPathLetter.test(token)) {\n      if (parser.inNumber) {\n        finalizeNumber(parser, false)\n      } else if (!segmentComplete(parser)) {\n        throw new Error('parser Error')\n      } else {\n        finalizeSegment(parser)\n      }\n      --index\n    }\n  }\n\n  if (parser.inNumber) {\n    finalizeNumber(parser, false)\n  }\n\n  if (parser.inSegment && segmentComplete(parser)) {\n    finalizeSegment(parser)\n  }\n\n  return parser.segments\n\n}\n", "import SVGArray from './SVGArray.js'\nimport parser from '../modules/core/parser.js'\nimport Box from './Box.js'\nimport { pathParser } from '../utils/pathParser.js'\n\nfunction arrayToString (a) {\n  let s = ''\n  for (let i = 0, il = a.length; i < il; i++) {\n    s += a[i][0]\n\n    if (a[i][1] != null) {\n      s += a[i][1]\n\n      if (a[i][2] != null) {\n        s += ' '\n        s += a[i][2]\n\n        if (a[i][3] != null) {\n          s += ' '\n          s += a[i][3]\n          s += ' '\n          s += a[i][4]\n\n          if (a[i][5] != null) {\n            s += ' '\n            s += a[i][5]\n            s += ' '\n            s += a[i][6]\n\n            if (a[i][7] != null) {\n              s += ' '\n              s += a[i][7]\n            }\n          }\n        }\n      }\n    }\n  }\n\n  return s + ' '\n}\n\nexport default class PathArray extends SVGArray {\n  // Get bounding box of path\n  bbox () {\n    parser().path.setAttribute('d', this.toString())\n    return new Box(parser.nodes.path.getBBox())\n  }\n\n  // Move path string\n  move (x, y) {\n    // get bounding box of current situation\n    const box = this.bbox()\n\n    // get relative offset\n    x -= box.x\n    y -= box.y\n\n    if (!isNaN(x) && !isNaN(y)) {\n      // move every point\n      for (let l, i = this.length - 1; i >= 0; i--) {\n        l = this[i][0]\n\n        if (l === 'M' || l === 'L' || l === 'T') {\n          this[i][1] += x\n          this[i][2] += y\n        } else if (l === 'H') {\n          this[i][1] += x\n        } else if (l === 'V') {\n          this[i][1] += y\n        } else if (l === 'C' || l === 'S' || l === 'Q') {\n          this[i][1] += x\n          this[i][2] += y\n          this[i][3] += x\n          this[i][4] += y\n\n          if (l === 'C') {\n            this[i][5] += x\n            this[i][6] += y\n          }\n        } else if (l === 'A') {\n          this[i][6] += x\n          this[i][7] += y\n        }\n      }\n    }\n\n    return this\n  }\n\n  // Absolutize and parse path to array\n  parse (d = 'M0 0') {\n    if (Array.isArray(d)) {\n      d = Array.prototype.concat.apply([], d).toString()\n    }\n\n    return pathParser(d)\n  }\n\n  // Resize path string\n  size (width, height) {\n    // get bounding box of current situation\n    const box = this.bbox()\n    let i, l\n\n    // If the box width or height is 0 then we ignore\n    // transformations on the respective axis\n    box.width = box.width === 0 ? 1 : box.width\n    box.height = box.height === 0 ? 1 : box.height\n\n    // recalculate position of all points according to new size\n    for (i = this.length - 1; i >= 0; i--) {\n      l = this[i][0]\n\n      if (l === 'M' || l === 'L' || l === 'T') {\n        this[i][1] = ((this[i][1] - box.x) * width) / box.width + box.x\n        this[i][2] = ((this[i][2] - box.y) * height) / box.height + box.y\n      } else if (l === 'H') {\n        this[i][1] = ((this[i][1] - box.x) * width) / box.width + box.x\n      } else if (l === 'V') {\n        this[i][1] = ((this[i][1] - box.y) * height) / box.height + box.y\n      } else if (l === 'C' || l === 'S' || l === 'Q') {\n        this[i][1] = ((this[i][1] - box.x) * width) / box.width + box.x\n        this[i][2] = ((this[i][2] - box.y) * height) / box.height + box.y\n        this[i][3] = ((this[i][3] - box.x) * width) / box.width + box.x\n        this[i][4] = ((this[i][4] - box.y) * height) / box.height + box.y\n\n        if (l === 'C') {\n          this[i][5] = ((this[i][5] - box.x) * width) / box.width + box.x\n          this[i][6] = ((this[i][6] - box.y) * height) / box.height + box.y\n        }\n      } else if (l === 'A') {\n        // resize radii\n        this[i][1] = (this[i][1] * width) / box.width\n        this[i][2] = (this[i][2] * height) / box.height\n\n        // move position values\n        this[i][6] = ((this[i][6] - box.x) * width) / box.width + box.x\n        this[i][7] = ((this[i][7] - box.y) * height) / box.height + box.y\n      }\n    }\n\n    return this\n  }\n\n  // Convert array to string\n  toString () {\n    return arrayToString(this)\n  }\n\n}\n", "import { Ease } from './Controller.js'\nimport {\n  delimiter,\n  numberAndUnit,\n  isPathLetter\n} from '../modules/core/regex.js'\nimport { extend } from '../utils/adopter.js'\nimport Color from '../types/Color.js'\nimport PathArray from '../types/PathArray.js'\nimport SVGArray from '../types/SVGArray.js'\nimport SVGNumber from '../types/SVGNumber.js'\n\nconst getClassForType = (value) => {\n  const type = typeof value\n\n  if (type === 'number') {\n    return SVGNumber\n  } else if (type === 'string') {\n    if (Color.isColor(value)) {\n      return Color\n    } else if (delimiter.test(value)) {\n      return isPathLetter.test(value)\n        ? PathArray\n        : SVGArray\n    } else if (numberAndUnit.test(value)) {\n      return SVGNumber\n    } else {\n      return NonMorphable\n    }\n  } else if (morphableTypes.indexOf(value.constructor) > -1) {\n    return value.constructor\n  } else if (Array.isArray(value)) {\n    return SVGArray\n  } else if (type === 'object') {\n    return ObjectBag\n  } else {\n    return NonMorphable\n  }\n}\n\nexport default class Morphable {\n  constructor (stepper) {\n    this._stepper = stepper || new Ease('-')\n\n    this._from = null\n    this._to = null\n    this._type = null\n    this._context = null\n    this._morphObj = null\n  }\n\n  at (pos) {\n    return this._morphObj.morph(this._from, this._to, pos, this._stepper, this._context)\n\n  }\n\n  done () {\n    const complete = this._context\n      .map(this._stepper.done)\n      .reduce(function (last, curr) {\n        return last && curr\n      }, true)\n    return complete\n  }\n\n  from (val) {\n    if (val == null) {\n      return this._from\n    }\n\n    this._from = this._set(val)\n    return this\n  }\n\n  stepper (stepper) {\n    if (stepper == null) return this._stepper\n    this._stepper = stepper\n    return this\n  }\n\n  to (val) {\n    if (val == null) {\n      return this._to\n    }\n\n    this._to = this._set(val)\n    return this\n  }\n\n  type (type) {\n    // getter\n    if (type == null) {\n      return this._type\n    }\n\n    // setter\n    this._type = type\n    return this\n  }\n\n  _set (value) {\n    if (!this._type) {\n      this.type(getClassForType(value))\n    }\n\n    let result = (new this._type(value))\n    if (this._type === Color) {\n      result = this._to\n        ? result[this._to[4]]()\n        : this._from\n          ? result[this._from[4]]()\n          : result\n    }\n\n    if (this._type === ObjectBag) {\n      result = this._to\n        ? result.align(this._to)\n        : this._from\n          ? result.align(this._from)\n          : result\n    }\n\n    result = result.toConsumable()\n\n    this._morphObj = this._morphObj || new this._type()\n    this._context = this._context\n      || Array.apply(null, Array(result.length))\n        .map(Object)\n        .map(function (o) {\n          o.done = true\n          return o\n        })\n    return result\n  }\n\n}\n\nexport class NonMorphable {\n  constructor (...args) {\n    this.init(...args)\n  }\n\n  init (val) {\n    val = Array.isArray(val) ? val[0] : val\n    this.value = val\n    return this\n  }\n\n  toArray () {\n    return [ this.value ]\n  }\n\n  valueOf () {\n    return this.value\n  }\n\n}\n\nexport class TransformBag {\n  constructor (...args) {\n    this.init(...args)\n  }\n\n  init (obj) {\n    if (Array.isArray(obj)) {\n      obj = {\n        scaleX: obj[0],\n        scaleY: obj[1],\n        shear: obj[2],\n        rotate: obj[3],\n        translateX: obj[4],\n        translateY: obj[5],\n        originX: obj[6],\n        originY: obj[7]\n      }\n    }\n\n    Object.assign(this, TransformBag.defaults, obj)\n    return this\n  }\n\n  toArray () {\n    const v = this\n\n    return [\n      v.scaleX,\n      v.scaleY,\n      v.shear,\n      v.rotate,\n      v.translateX,\n      v.translateY,\n      v.originX,\n      v.originY\n    ]\n  }\n}\n\nTransformBag.defaults = {\n  scaleX: 1,\n  scaleY: 1,\n  shear: 0,\n  rotate: 0,\n  translateX: 0,\n  translateY: 0,\n  originX: 0,\n  originY: 0\n}\n\nconst sortByKey = (a, b) => {\n  return (a[0] < b[0] ? -1 : (a[0] > b[0] ? 1 : 0))\n}\n\nexport class ObjectBag {\n  constructor (...args) {\n    this.init(...args)\n  }\n\n  align (other) {\n    const values = this.values\n    for (let i = 0, il = values.length; i < il; ++i) {\n\n      // If the type is the same we only need to check if the color is in the correct format\n      if (values[i + 1] === other[i + 1]) {\n        if (values[i + 1] === Color && other[i + 7] !== values[i + 7]) {\n          const space = other[i + 7]\n          const color = new Color(this.values.splice(i + 3, 5))[space]().toArray()\n          this.values.splice(i + 3, 0, ...color)\n        }\n\n        i += values[i + 2] + 2\n        continue\n      }\n\n      if (!other[i + 1]) {\n        return this\n      }\n\n      // The types differ, so we overwrite the new type with the old one\n      // And initialize it with the types default (e.g. black for color or 0 for number)\n      const defaultObject = new (other[i + 1])().toArray()\n\n      // Than we fix the values array\n      const toDelete = (values[i + 2]) + 3\n\n      values.splice(i, toDelete, other[i], other[i + 1], other[i + 2], ...defaultObject)\n\n      i += values[i + 2] + 2\n    }\n    return this\n  }\n\n  init (objOrArr) {\n    this.values = []\n\n    if (Array.isArray(objOrArr)) {\n      this.values = objOrArr.slice()\n      return\n    }\n\n    objOrArr = objOrArr || {}\n    const entries = []\n\n    for (const i in objOrArr) {\n      const Type = getClassForType(objOrArr[i])\n      const val = new Type(objOrArr[i]).toArray()\n      entries.push([ i, Type, val.length, ...val ])\n    }\n\n    entries.sort(sortByKey)\n\n    this.values = entries.reduce((last, curr) => last.concat(curr), [])\n    return this\n  }\n\n  toArray () {\n    return this.values\n  }\n\n  valueOf () {\n    const obj = {}\n    const arr = this.values\n\n    // for (var i = 0, len = arr.length; i < len; i += 2) {\n    while (arr.length) {\n      const key = arr.shift()\n      const Type = arr.shift()\n      const num = arr.shift()\n      const values = arr.splice(0, num)\n      obj[key] = new Type(values)// .valueOf()\n    }\n\n    return obj\n  }\n\n}\n\nconst morphableTypes = [\n  NonMorphable,\n  TransformBag,\n  ObjectBag\n]\n\nexport function registerMorphableType (type = []) {\n  morphableTypes.push(...[].concat(type))\n}\n\nexport function makeMorphable () {\n  extend(morphableTypes, {\n    to (val) {\n      return new Morphable()\n        .type(this.constructor)\n        .from(this.toArray())// this.valueOf())\n        .to(val)\n    },\n    fromArray (arr) {\n      this.init(arr)\n      return this\n    },\n    toConsumable () {\n      return this.toArray()\n    },\n    morph (from, to, pos, stepper, context) {\n      const mapper = function (i, index) {\n        return stepper.step(i, to[index], pos, context[index], context)\n      }\n\n      return this.fromArray(from.map(mapper))\n    }\n  })\n}\n", "import { nodeOrNew, register, wrapWithAttrCheck } from '../utils/adopter.js'\nimport { proportionalSize } from '../utils/utils.js'\nimport { registerMethods } from '../utils/methods.js'\nimport PathArray from '../types/PathArray.js'\nimport Shape from './Shape.js'\n\nexport default class Path extends Shape {\n  // Initialize node\n  constructor (node, attrs = node) {\n    super(nodeOrNew('path', node), attrs)\n  }\n\n  // Get array\n  array () {\n    return this._array || (this._array = new PathArray(this.attr('d')))\n  }\n\n  // Clear array cache\n  clear () {\n    delete this._array\n    return this\n  }\n\n  // Set height of element\n  height (height) {\n    return height == null ? this.bbox().height : this.size(this.bbox().width, height)\n  }\n\n  // Move by left top corner\n  move (x, y) {\n    return this.attr('d', this.array().move(x, y))\n  }\n\n  // Plot new path\n  plot (d) {\n    return (d == null)\n      ? this.array()\n      : this.clear().attr('d', typeof d === 'string' ? d : (this._array = new PathArray(d)))\n  }\n\n  // Set element size to given width and height\n  size (width, height) {\n    const p = proportionalSize(this, width, height)\n    return this.attr('d', this.array().size(p.width, p.height))\n  }\n\n  // Set width of element\n  width (width) {\n    return width == null ? this.bbox().width : this.size(width, this.bbox().height)\n  }\n\n  // Move by left top corner over x-axis\n  x (x) {\n    return x == null ? this.bbox().x : this.move(x, this.bbox().y)\n  }\n\n  // Move by left top corner over y-axis\n  y (y) {\n    return y == null ? this.bbox().y : this.move(this.bbox().x, y)\n  }\n\n}\n\n// Define morphable array\nPath.prototype.MorphArray = PathArray\n\n// Add parent method\nregisterMethods({\n  Container: {\n    // Create a wrapped path element\n    path: wrapWithAttrCheck(function (d) {\n      // make sure plot is called as a setter\n      return this.put(new Path()).plot(d || new PathArray())\n    })\n  }\n})\n\nregister(Path, 'Path')\n", "import { proportionalSize } from '../../utils/utils.js'\nimport PointArray from '../../types/PointArray.js'\n\n// Get array\nexport function array () {\n  return this._array || (this._array = new PointArray(this.attr('points')))\n}\n\n// Clear array cache\nexport function clear () {\n  delete this._array\n  return this\n}\n\n// Move by left top corner\nexport function move (x, y) {\n  return this.attr('points', this.array().move(x, y))\n}\n\n// Plot new path\nexport function plot (p) {\n  return (p == null)\n    ? this.array()\n    : this.clear().attr('points', typeof p === 'string'\n      ? p\n      : (this._array = new PointArray(p)))\n}\n\n// Set element size to given width and height\nexport function size (width, height) {\n  const p = proportionalSize(this, width, height)\n  return this.attr('points', this.array().size(p.width, p.height))\n}\n", "import {\n  extend,\n  nodeOrNew,\n  register,\n  wrapWithAttrCheck\n} from '../utils/adopter.js'\nimport { registerMethods } from '../utils/methods.js'\nimport PointArray from '../types/PointArray.js'\nimport Shape from './Shape.js'\nimport * as pointed from '../modules/core/pointed.js'\nimport * as poly from '../modules/core/poly.js'\n\nexport default class Polygon extends Shape {\n  // Initialize node\n  constructor (node, attrs = node) {\n    super(nodeOrNew('polygon', node), attrs)\n  }\n}\n\nregisterMethods({\n  Container: {\n    // Create a wrapped polygon element\n    polygon: wrapWithAttrCheck(function (p) {\n      // make sure plot is called as a setter\n      return this.put(new Polygon()).plot(p || new PointArray())\n    })\n  }\n})\n\nextend(Polygon, pointed)\nextend(Polygon, poly)\nregister(Polygon, 'Polygon')\n", "import {\n  extend,\n  nodeOrNew,\n  register,\n  wrapWithAttrCheck\n} from '../utils/adopter.js'\nimport { registerMethods } from '../utils/methods.js'\nimport PointArray from '../types/PointArray.js'\nimport Shape from './Shape.js'\nimport * as pointed from '../modules/core/pointed.js'\nimport * as poly from '../modules/core/poly.js'\n\nexport default class Polyline extends Shape {\n  // Initialize node\n  constructor (node, attrs = node) {\n    super(nodeOrNew('polyline', node), attrs)\n  }\n}\n\nregisterMethods({\n  Container: {\n    // Create a wrapped polygon element\n    polyline: wrapWithAttrCheck(function (p) {\n      // make sure plot is called as a setter\n      return this.put(new Polyline()).plot(p || new PointArray())\n    })\n  }\n})\n\nextend(Polyline, pointed)\nextend(Polyline, poly)\nregister(Polyline, 'Polyline')\n", "import {\n  extend,\n  nodeOrNew,\n  register,\n  wrapWithAttrCheck\n} from '../utils/adopter.js'\nimport { registerMethods } from '../utils/methods.js'\nimport { rx, ry } from '../modules/core/circled.js'\nimport Shape from './Shape.js'\n\nexport default class Rect extends Shape {\n  // Initialize node\n  constructor (node, attrs = node) {\n    super(nodeOrNew('rect', node), attrs)\n  }\n}\n\nextend(Rect, { rx, ry })\n\nregisterMethods({\n  Container: {\n    // Create a rect element\n    rect: wrapWithAttrCheck(function (width, height) {\n      return this.put(new Rect()).size(width, height)\n    })\n  }\n})\n\nregister(Rect, 'Rect')\n", "export default class Queue {\n  constructor () {\n    this._first = null\n    this._last = null\n  }\n\n  // Shows us the first item in the list\n  first () {\n    return this._first && this._first.value\n  }\n\n  // Shows us the last item in the list\n  last () {\n    return this._last && this._last.value\n  }\n\n  push (value) {\n    // An item stores an id and the provided value\n    const item = typeof value.next !== 'undefined' ? value : { value: value, next: null, prev: null }\n\n    // Deal with the queue being empty or populated\n    if (this._last) {\n      item.prev = this._last\n      this._last.next = item\n      this._last = item\n    } else {\n      this._last = item\n      this._first = item\n    }\n\n    // Return the current item\n    return item\n  }\n\n  // Removes the item that was returned from the push\n  remove (item) {\n    // Relink the previous item\n    if (item.prev) item.prev.next = item.next\n    if (item.next) item.next.prev = item.prev\n    if (item === this._last) this._last = item.prev\n    if (item === this._first) this._first = item.next\n\n    // Invalidate item\n    item.prev = null\n    item.next = null\n  }\n\n  shift () {\n    // Check if we have a value\n    const remove = this._first\n    if (!remove) return null\n\n    // If we do, remove it and relink things\n    this._first = remove.next\n    if (this._first) this._first.prev = null\n    this._last = this._first ? this._last : null\n    return remove.value\n  }\n\n}\n", "import { globals } from '../utils/window.js'\nimport Queue from './Queue.js'\n\nconst Animator = {\n  nextDraw: null,\n  frames: new Queue(),\n  timeouts: new Queue(),\n  immediates: new Queue(),\n  timer: () => globals.window.performance || globals.window.Date,\n  transforms: [],\n\n  frame (fn) {\n    // Store the node\n    const node = Animator.frames.push({ run: fn })\n\n    // Request an animation frame if we don't have one\n    if (Animator.nextDraw === null) {\n      Animator.nextDraw = globals.window.requestAnimationFrame(Animator._draw)\n    }\n\n    // Return the node so we can remove it easily\n    return node\n  },\n\n  timeout (fn, delay) {\n    delay = delay || 0\n\n    // Work out when the event should fire\n    const time = Animator.timer().now() + delay\n\n    // Add the timeout to the end of the queue\n    const node = Animator.timeouts.push({ run: fn, time: time })\n\n    // Request another animation frame if we need one\n    if (Animator.nextDraw === null) {\n      Animator.nextDraw = globals.window.requestAnimationFrame(Animator._draw)\n    }\n\n    return node\n  },\n\n  immediate (fn) {\n    // Add the immediate fn to the end of the queue\n    const node = Animator.immediates.push(fn)\n    // Request another animation frame if we need one\n    if (Animator.nextDraw === null) {\n      Animator.nextDraw = globals.window.requestAnimationFrame(Animator._draw)\n    }\n\n    return node\n  },\n\n  cancelFrame (node) {\n    node != null && Animator.frames.remove(node)\n  },\n\n  clearTimeout (node) {\n    node != null && Animator.timeouts.remove(node)\n  },\n\n  cancelImmediate (node) {\n    node != null && Animator.immediates.remove(node)\n  },\n\n  _draw (now) {\n    // Run all the timeouts we can run, if they are not ready yet, add them\n    // to the end of the queue immediately! (bad timeouts!!! [sarcasm])\n    let nextTimeout = null\n    const lastTimeout = Animator.timeouts.last()\n    while ((nextTimeout = Animator.timeouts.shift())) {\n      // Run the timeout if its time, or push it to the end\n      if (now >= nextTimeout.time) {\n        nextTimeout.run()\n      } else {\n        Animator.timeouts.push(nextTimeout)\n      }\n\n      // If we hit the last item, we should stop shifting out more items\n      if (nextTimeout === lastTimeout) break\n    }\n\n    // Run all of the animation frames\n    let nextFrame = null\n    const lastFrame = Animator.frames.last()\n    while ((nextFrame !== lastFrame) && (nextFrame = Animator.frames.shift())) {\n      nextFrame.run(now)\n    }\n\n    let nextImmediate = null\n    while ((nextImmediate = Animator.immediates.shift())) {\n      nextImmediate()\n    }\n\n    // If we have remaining timeouts or frames, draw until we don't anymore\n    Animator.nextDraw = Animator.timeouts.first() || Animator.frames.first()\n      ? globals.window.requestAnimationFrame(Animator._draw)\n      : null\n  }\n}\n\nexport default Animator\n", "import { globals } from '../utils/window.js'\nimport { registerMethods } from '../utils/methods.js'\nimport Animator from './Animator.js'\nimport EventTarget from '../types/EventTarget.js'\n\nconst makeSchedule = function (runnerInfo) {\n  const start = runnerInfo.start\n  const duration = runnerInfo.runner.duration()\n  const end = start + duration\n  return { start: start, duration: duration, end: end, runner: runnerInfo.runner }\n}\n\nconst defaultSource = function () {\n  const w = globals.window\n  return (w.performance || w.Date).now()\n}\n\nexport default class Timeline extends EventTarget {\n  // Construct a new timeline on the given element\n  constructor (timeSource = defaultSource) {\n    super()\n\n    this._timeSource = timeSource\n\n    // Store the timing variables\n    this._startTime = 0\n    this._speed = 1.0\n\n    // Determines how long a runner is hold in memory. Can be a dt or true/false\n    this._persist = 0\n\n    // Keep track of the running animations and their starting parameters\n    this._nextFrame = null\n    this._paused = true\n    this._runners = []\n    this._runnerIds = []\n    this._lastRunnerId = -1\n    this._time = 0\n    this._lastSourceTime = 0\n    this._lastStepTime = 0\n\n    // Make sure that step is always called in class context\n    this._step = this._stepFn.bind(this, false)\n    this._stepImmediate = this._stepFn.bind(this, true)\n  }\n\n  active () {\n    return !!this._nextFrame\n  }\n\n  finish () {\n    // Go to end and pause\n    this.time(this.getEndTimeOfTimeline() + 1)\n    return this.pause()\n  }\n\n  // Calculates the end of the timeline\n  getEndTime () {\n    const lastRunnerInfo = this.getLastRunnerInfo()\n    const lastDuration = lastRunnerInfo ? lastRunnerInfo.runner.duration() : 0\n    const lastStartTime = lastRunnerInfo ? lastRunnerInfo.start : this._time\n    return lastStartTime + lastDuration\n  }\n\n  getEndTimeOfTimeline () {\n    const endTimes = this._runners.map((i) => i.start + i.runner.duration())\n    return Math.max(0, ...endTimes)\n  }\n\n  getLastRunnerInfo () {\n    return this.getRunnerInfoById(this._lastRunnerId)\n  }\n\n  getRunnerInfoById (id) {\n    return this._runners[this._runnerIds.indexOf(id)] || null\n  }\n\n  pause () {\n    this._paused = true\n    return this._continue()\n  }\n\n  persist (dtOrForever) {\n    if (dtOrForever == null) return this._persist\n    this._persist = dtOrForever\n    return this\n  }\n\n  play () {\n    // Now make sure we are not paused and continue the animation\n    this._paused = false\n    return this.updateTime()._continue()\n  }\n\n  reverse (yes) {\n    const currentSpeed = this.speed()\n    if (yes == null) return this.speed(-currentSpeed)\n\n    const positive = Math.abs(currentSpeed)\n    return this.speed(yes ? -positive : positive)\n  }\n\n  // schedules a runner on the timeline\n  schedule (runner, delay, when) {\n    if (runner == null) {\n      return this._runners.map(makeSchedule)\n    }\n\n    // The start time for the next animation can either be given explicitly,\n    // derived from the current timeline time or it can be relative to the\n    // last start time to chain animations directly\n\n    let absoluteStartTime = 0\n    const endTime = this.getEndTime()\n    delay = delay || 0\n\n    // Work out when to start the animation\n    if (when == null || when === 'last' || when === 'after') {\n      // Take the last time and increment\n      absoluteStartTime = endTime\n    } else if (when === 'absolute' || when === 'start') {\n      absoluteStartTime = delay\n      delay = 0\n    } else if (when === 'now') {\n      absoluteStartTime = this._time\n    } else if (when === 'relative') {\n      const runnerInfo = this.getRunnerInfoById(runner.id)\n      if (runnerInfo) {\n        absoluteStartTime = runnerInfo.start + delay\n        delay = 0\n      }\n    } else if (when === 'with-last') {\n      const lastRunnerInfo = this.getLastRunnerInfo()\n      const lastStartTime = lastRunnerInfo ? lastRunnerInfo.start : this._time\n      absoluteStartTime = lastStartTime\n    } else {\n      throw new Error('Invalid value for the \"when\" parameter')\n    }\n\n    // Manage runner\n    runner.unschedule()\n    runner.timeline(this)\n\n    const persist = runner.persist()\n    const runnerInfo = {\n      persist: persist === null ? this._persist : persist,\n      start: absoluteStartTime + delay,\n      runner\n    }\n\n    this._lastRunnerId = runner.id\n\n    this._runners.push(runnerInfo)\n    this._runners.sort((a, b) => a.start - b.start)\n    this._runnerIds = this._runners.map(info => info.runner.id)\n\n    this.updateTime()._continue()\n    return this\n  }\n\n  seek (dt) {\n    return this.time(this._time + dt)\n  }\n\n  source (fn) {\n    if (fn == null) return this._timeSource\n    this._timeSource = fn\n    return this\n  }\n\n  speed (speed) {\n    if (speed == null) return this._speed\n    this._speed = speed\n    return this\n  }\n\n  stop () {\n    // Go to start and pause\n    this.time(0)\n    return this.pause()\n  }\n\n  time (time) {\n    if (time == null) return this._time\n    this._time = time\n    return this._continue(true)\n  }\n\n  // Remove the runner from this timeline\n  unschedule (runner) {\n    const index = this._runnerIds.indexOf(runner.id)\n    if (index < 0) return this\n\n    this._runners.splice(index, 1)\n    this._runnerIds.splice(index, 1)\n\n    runner.timeline(null)\n    return this\n  }\n\n  // Makes sure, that after pausing the time doesn't jump\n  updateTime () {\n    if (!this.active()) {\n      this._lastSourceTime = this._timeSource()\n    }\n    return this\n  }\n\n  // Checks if we are running and continues the animation\n  _continue (immediateStep = false) {\n    Animator.cancelFrame(this._nextFrame)\n    this._nextFrame = null\n\n    if (immediateStep) return this._stepImmediate()\n    if (this._paused) return this\n\n    this._nextFrame = Animator.frame(this._step)\n    return this\n  }\n\n  _stepFn (immediateStep = false) {\n    // Get the time delta from the last time and update the time\n    const time = this._timeSource()\n    let dtSource = time - this._lastSourceTime\n\n    if (immediateStep) dtSource = 0\n\n    const dtTime = this._speed * dtSource + (this._time - this._lastStepTime)\n    this._lastSourceTime = time\n\n    // Only update the time if we use the timeSource.\n    // Otherwise use the current time\n    if (!immediateStep) {\n      // Update the time\n      this._time += dtTime\n      this._time = this._time < 0 ? 0 : this._time\n    }\n    this._lastStepTime = this._time\n    this.fire('time', this._time)\n\n    // This is for the case that the timeline was seeked so that the time\n    // is now before the startTime of the runner. That is why we need to set\n    // the runner to position 0\n\n    // FIXME:\n    // However, resetting in insertion order leads to bugs. Considering the case,\n    // where 2 runners change the same attribute but in different times,\n    // resetting both of them will lead to the case where the later defined\n    // runner always wins the reset even if the other runner started earlier\n    // and therefore should win the attribute battle\n    // this can be solved by resetting them backwards\n    for (let k = this._runners.length; k--;) {\n      // Get and run the current runner and ignore it if its inactive\n      const runnerInfo = this._runners[k]\n      const runner = runnerInfo.runner\n\n      // Make sure that we give the actual difference\n      // between runner start time and now\n      const dtToStart = this._time - runnerInfo.start\n\n      // Dont run runner if not started yet\n      // and try to reset it\n      if (dtToStart <= 0) {\n        runner.reset()\n      }\n    }\n\n    // Run all of the runners directly\n    let runnersLeft = false\n    for (let i = 0, len = this._runners.length; i < len; i++) {\n      // Get and run the current runner and ignore it if its inactive\n      const runnerInfo = this._runners[i]\n      const runner = runnerInfo.runner\n      let dt = dtTime\n\n      // Make sure that we give the actual difference\n      // between runner start time and now\n      const dtToStart = this._time - runnerInfo.start\n\n      // Dont run runner if not started yet\n      if (dtToStart <= 0) {\n        runnersLeft = true\n        continue\n      } else if (dtToStart < dt) {\n        // Adjust dt to make sure that animation is on point\n        dt = dtToStart\n      }\n\n      if (!runner.active()) continue\n\n      // If this runner is still going, signal that we need another animation\n      // frame, otherwise, remove the completed runner\n      const finished = runner.step(dt).done\n      if (!finished) {\n        runnersLeft = true\n        // continue\n      } else if (runnerInfo.persist !== true) {\n        // runner is finished. And runner might get removed\n        const endTime = runner.duration() - runner.time() + this._time\n\n        if (endTime + runnerInfo.persist < this._time) {\n          // Delete runner and correct index\n          runner.unschedule()\n          --i\n          --len\n        }\n      }\n    }\n\n    // Basically: we continue when there are runners right from us in time\n    // when -->, and when runners are left from us when <--\n    if ((runnersLeft && !(this._speed < 0 && this._time === 0)) || (this._runnerIds.length && this._speed < 0 && this._time > 0)) {\n      this._continue()\n    } else {\n      this.pause()\n      this.fire('finished')\n    }\n\n    return this\n  }\n\n}\n\nregisterMethods({\n  Element: {\n    timeline: function (timeline) {\n      if (timeline == null) {\n        this._timeline = (this._timeline || new Timeline())\n        return this._timeline\n      } else {\n        this._timeline = timeline\n        return this\n      }\n    }\n  }\n})\n", "import { Controller, Ease, Stepper } from './Controller.js'\nimport { extend, register } from '../utils/adopter.js'\nimport { from, to } from '../modules/core/gradiented.js'\nimport { getOrigin } from '../utils/utils.js'\nimport { noop, timeline } from '../modules/core/defaults.js'\nimport { registerMethods } from '../utils/methods.js'\nimport { rx, ry } from '../modules/core/circled.js'\nimport Animator from './Animator.js'\nimport Box from '../types/Box.js'\nimport EventTarget from '../types/EventTarget.js'\nimport Matrix from '../types/Matrix.js'\nimport Morphable, { TransformBag, ObjectBag } from './Morphable.js'\nimport Point from '../types/Point.js'\nimport SVGNumber from '../types/SVGNumber.js'\nimport Timeline from './Timeline.js'\n\nexport default class Runner extends EventTarget {\n  constructor (options) {\n    super()\n\n    // Store a unique id on the runner, so that we can identify it later\n    this.id = Runner.id++\n\n    // Ensure a default value\n    options = options == null\n      ? timeline.duration\n      : options\n\n    // Ensure that we get a controller\n    options = typeof options === 'function'\n      ? new Controller(options)\n      : options\n\n    // Declare all of the variables\n    this._element = null\n    this._timeline = null\n    this.done = false\n    this._queue = []\n\n    // Work out the stepper and the duration\n    this._duration = typeof options === 'number' && options\n    this._isDeclarative = options instanceof Controller\n    this._stepper = this._isDeclarative ? options : new Ease()\n\n    // We copy the current values from the timeline because they can change\n    this._history = {}\n\n    // Store the state of the runner\n    this.enabled = true\n    this._time = 0\n    this._lastTime = 0\n\n    // At creation, the runner is in reset state\n    this._reseted = true\n\n    // Save transforms applied to this runner\n    this.transforms = new Matrix()\n    this.transformId = 1\n\n    // Looping variables\n    this._haveReversed = false\n    this._reverse = false\n    this._loopsDone = 0\n    this._swing = false\n    this._wait = 0\n    this._times = 1\n\n    this._frameId = null\n\n    // Stores how long a runner is stored after being done\n    this._persist = this._isDeclarative ? true : null\n  }\n\n  static sanitise (duration, delay, when) {\n    // Initialise the default parameters\n    let times = 1\n    let swing = false\n    let wait = 0\n    duration = duration || timeline.duration\n    delay = delay || timeline.delay\n    when = when || 'last'\n\n    // If we have an object, unpack the values\n    if (typeof duration === 'object' && !(duration instanceof Stepper)) {\n      delay = duration.delay || delay\n      when = duration.when || when\n      swing = duration.swing || swing\n      times = duration.times || times\n      wait = duration.wait || wait\n      duration = duration.duration || timeline.duration\n    }\n\n    return {\n      duration: duration,\n      delay: delay,\n      swing: swing,\n      times: times,\n      wait: wait,\n      when: when\n    }\n  }\n\n  active (enabled) {\n    if (enabled == null) return this.enabled\n    this.enabled = enabled\n    return this\n  }\n\n  /*\n  Private Methods\n  ===============\n  Methods that shouldn't be used externally\n  */\n  addTransform (transform, index) {\n    this.transforms.lmultiplyO(transform)\n    return this\n  }\n\n  after (fn) {\n    return this.on('finished', fn)\n  }\n\n  animate (duration, delay, when) {\n    const o = Runner.sanitise(duration, delay, when)\n    const runner = new Runner(o.duration)\n    if (this._timeline) runner.timeline(this._timeline)\n    if (this._element) runner.element(this._element)\n    return runner.loop(o).schedule(o.delay, o.when)\n  }\n\n  clearTransform () {\n    this.transforms = new Matrix()\n    return this\n  }\n\n  // TODO: Keep track of all transformations so that deletion is faster\n  clearTransformsFromQueue () {\n    if (!this.done || !this._timeline || !this._timeline._runnerIds.includes(this.id)) {\n      this._queue = this._queue.filter((item) => {\n        return !item.isTransform\n      })\n    }\n  }\n\n  delay (delay) {\n    return this.animate(0, delay)\n  }\n\n  duration () {\n    return this._times * (this._wait + this._duration) - this._wait\n  }\n\n  during (fn) {\n    return this.queue(null, fn)\n  }\n\n  ease (fn) {\n    this._stepper = new Ease(fn)\n    return this\n  }\n  /*\n  Runner Definitions\n  ==================\n  These methods help us define the runtime behaviour of the Runner or they\n  help us make new runners from the current runner\n  */\n\n  element (element) {\n    if (element == null) return this._element\n    this._element = element\n    element._prepareRunner()\n    return this\n  }\n\n  finish () {\n    return this.step(Infinity)\n  }\n\n  loop (times, swing, wait) {\n    // Deal with the user passing in an object\n    if (typeof times === 'object') {\n      swing = times.swing\n      wait = times.wait\n      times = times.times\n    }\n\n    // Sanitise the values and store them\n    this._times = times || Infinity\n    this._swing = swing || false\n    this._wait = wait || 0\n\n    // Allow true to be passed\n    if (this._times === true) { this._times = Infinity }\n\n    return this\n  }\n\n  loops (p) {\n    const loopDuration = this._duration + this._wait\n    if (p == null) {\n      const loopsDone = Math.floor(this._time / loopDuration)\n      const relativeTime = (this._time - loopsDone * loopDuration)\n      const position = relativeTime / this._duration\n      return Math.min(loopsDone + position, this._times)\n    }\n    const whole = Math.floor(p)\n    const partial = p % 1\n    const time = loopDuration * whole + this._duration * partial\n    return this.time(time)\n  }\n\n  persist (dtOrForever) {\n    if (dtOrForever == null) return this._persist\n    this._persist = dtOrForever\n    return this\n  }\n\n  position (p) {\n    // Get all of the variables we need\n    const x = this._time\n    const d = this._duration\n    const w = this._wait\n    const t = this._times\n    const s = this._swing\n    const r = this._reverse\n    let position\n\n    if (p == null) {\n      /*\n      This function converts a time to a position in the range [0, 1]\n      The full explanation can be found in this desmos demonstration\n        https://www.desmos.com/calculator/u4fbavgche\n      The logic is slightly simplified here because we can use booleans\n      */\n\n      // Figure out the value without thinking about the start or end time\n      const f = function (x) {\n        const swinging = s * Math.floor(x % (2 * (w + d)) / (w + d))\n        const backwards = (swinging && !r) || (!swinging && r)\n        const uncliped = Math.pow(-1, backwards) * (x % (w + d)) / d + backwards\n        const clipped = Math.max(Math.min(uncliped, 1), 0)\n        return clipped\n      }\n\n      // Figure out the value by incorporating the start time\n      const endTime = t * (w + d) - w\n      position = x <= 0\n        ? Math.round(f(1e-5))\n        : x < endTime\n          ? f(x)\n          : Math.round(f(endTime - 1e-5))\n      return position\n    }\n\n    // Work out the loops done and add the position to the loops done\n    const loopsDone = Math.floor(this.loops())\n    const swingForward = s && (loopsDone % 2 === 0)\n    const forwards = (swingForward && !r) || (r && swingForward)\n    position = loopsDone + (forwards ? p : 1 - p)\n    return this.loops(position)\n  }\n\n  progress (p) {\n    if (p == null) {\n      return Math.min(1, this._time / this.duration())\n    }\n    return this.time(p * this.duration())\n  }\n\n  /*\n  Basic Functionality\n  ===================\n  These methods allow us to attach basic functions to the runner directly\n  */\n  queue (initFn, runFn, retargetFn, isTransform) {\n    this._queue.push({\n      initialiser: initFn || noop,\n      runner: runFn || noop,\n      retarget: retargetFn,\n      isTransform: isTransform,\n      initialised: false,\n      finished: false\n    })\n    const timeline = this.timeline()\n    timeline && this.timeline()._continue()\n    return this\n  }\n\n  reset () {\n    if (this._reseted) return this\n    this.time(0)\n    this._reseted = true\n    return this\n  }\n\n  reverse (reverse) {\n    this._reverse = reverse == null ? !this._reverse : reverse\n    return this\n  }\n\n  schedule (timeline, delay, when) {\n    // The user doesn't need to pass a timeline if we already have one\n    if (!(timeline instanceof Timeline)) {\n      when = delay\n      delay = timeline\n      timeline = this.timeline()\n    }\n\n    // If there is no timeline, yell at the user...\n    if (!timeline) {\n      throw Error('Runner cannot be scheduled without timeline')\n    }\n\n    // Schedule the runner on the timeline provided\n    timeline.schedule(this, delay, when)\n    return this\n  }\n\n  step (dt) {\n    // If we are inactive, this stepper just gets skipped\n    if (!this.enabled) return this\n\n    // Update the time and get the new position\n    dt = dt == null ? 16 : dt\n    this._time += dt\n    const position = this.position()\n\n    // Figure out if we need to run the stepper in this frame\n    const running = this._lastPosition !== position && this._time >= 0\n    this._lastPosition = position\n\n    // Figure out if we just started\n    const duration = this.duration()\n    const justStarted = this._lastTime <= 0 && this._time > 0\n    const justFinished = this._lastTime < duration && this._time >= duration\n\n    this._lastTime = this._time\n    if (justStarted) {\n      this.fire('start', this)\n    }\n\n    // Work out if the runner is finished set the done flag here so animations\n    // know, that they are running in the last step (this is good for\n    // transformations which can be merged)\n    const declarative = this._isDeclarative\n    this.done = !declarative && !justFinished && this._time >= duration\n\n    // Runner is running. So its not in reset state anymore\n    this._reseted = false\n\n    let converged = false\n    // Call initialise and the run function\n    if (running || declarative) {\n      this._initialise(running)\n\n      // clear the transforms on this runner so they dont get added again and again\n      this.transforms = new Matrix()\n      converged = this._run(declarative ? dt : position)\n\n      this.fire('step', this)\n    }\n    // correct the done flag here\n    // declarative animations itself know when they converged\n    this.done = this.done || (converged && declarative)\n    if (justFinished) {\n      this.fire('finished', this)\n    }\n    return this\n  }\n\n  /*\n  Runner animation methods\n  ========================\n  Control how the animation plays\n  */\n  time (time) {\n    if (time == null) {\n      return this._time\n    }\n    const dt = time - this._time\n    this.step(dt)\n    return this\n  }\n\n  timeline (timeline) {\n    // check explicitly for undefined so we can set the timeline to null\n    if (typeof timeline === 'undefined') return this._timeline\n    this._timeline = timeline\n    return this\n  }\n\n  unschedule () {\n    const timeline = this.timeline()\n    timeline && timeline.unschedule(this)\n    return this\n  }\n\n  // Run each initialise function in the runner if required\n  _initialise (running) {\n    // If we aren't running, we shouldn't initialise when not declarative\n    if (!running && !this._isDeclarative) return\n\n    // Loop through all of the initialisers\n    for (let i = 0, len = this._queue.length; i < len; ++i) {\n      // Get the current initialiser\n      const current = this._queue[i]\n\n      // Determine whether we need to initialise\n      const needsIt = this._isDeclarative || (!current.initialised && running)\n      running = !current.finished\n\n      // Call the initialiser if we need to\n      if (needsIt && running) {\n        current.initialiser.call(this)\n        current.initialised = true\n      }\n    }\n  }\n\n  // Save a morpher to the morpher list so that we can retarget it later\n  _rememberMorpher (method, morpher) {\n    this._history[method] = {\n      morpher: morpher,\n      caller: this._queue[this._queue.length - 1]\n    }\n\n    // We have to resume the timeline in case a controller\n    // is already done without being ever run\n    // This can happen when e.g. this is done:\n    //    anim = el.animate(new SVG.Spring)\n    // and later\n    //    anim.move(...)\n    if (this._isDeclarative) {\n      const timeline = this.timeline()\n      timeline && timeline.play()\n    }\n  }\n\n  // Try to set the target for a morpher if the morpher exists, otherwise\n  // Run each run function for the position or dt given\n  _run (positionOrDt) {\n    // Run all of the _queue directly\n    let allfinished = true\n    for (let i = 0, len = this._queue.length; i < len; ++i) {\n      // Get the current function to run\n      const current = this._queue[i]\n\n      // Run the function if its not finished, we keep track of the finished\n      // flag for the sake of declarative _queue\n      const converged = current.runner.call(this, positionOrDt)\n      current.finished = current.finished || (converged === true)\n      allfinished = allfinished && current.finished\n    }\n\n    // We report when all of the constructors are finished\n    return allfinished\n  }\n\n  // do nothing and return false\n  _tryRetarget (method, target, extra) {\n    if (this._history[method]) {\n      // if the last method wasn't even initialised, throw it away\n      if (!this._history[method].caller.initialised) {\n        const index = this._queue.indexOf(this._history[method].caller)\n        this._queue.splice(index, 1)\n        return false\n      }\n\n      // for the case of transformations, we use the special retarget function\n      // which has access to the outer scope\n      if (this._history[method].caller.retarget) {\n        this._history[method].caller.retarget.call(this, target, extra)\n        // for everything else a simple morpher change is sufficient\n      } else {\n        this._history[method].morpher.to(target)\n      }\n\n      this._history[method].caller.finished = false\n      const timeline = this.timeline()\n      timeline && timeline.play()\n      return true\n    }\n    return false\n  }\n\n}\n\nRunner.id = 0\n\nexport class FakeRunner {\n  constructor (transforms = new Matrix(), id = -1, done = true) {\n    this.transforms = transforms\n    this.id = id\n    this.done = done\n  }\n\n  clearTransformsFromQueue () { }\n}\n\nextend([ Runner, FakeRunner ], {\n  mergeWith (runner) {\n    return new FakeRunner(\n      runner.transforms.lmultiply(this.transforms),\n      runner.id\n    )\n  }\n})\n\n// FakeRunner.emptyRunner = new FakeRunner()\n\nconst lmultiply = (last, curr) => last.lmultiplyO(curr)\nconst getRunnerTransform = (runner) => runner.transforms\n\nfunction mergeTransforms () {\n  // Find the matrix to apply to the element and apply it\n  const runners = this._transformationRunners.runners\n  const netTransform = runners\n    .map(getRunnerTransform)\n    .reduce(lmultiply, new Matrix())\n\n  this.transform(netTransform)\n\n  this._transformationRunners.merge()\n\n  if (this._transformationRunners.length() === 1) {\n    this._frameId = null\n  }\n}\n\nexport class RunnerArray {\n  constructor () {\n    this.runners = []\n    this.ids = []\n  }\n\n  add (runner) {\n    if (this.runners.includes(runner)) return\n    const id = runner.id + 1\n\n    this.runners.push(runner)\n    this.ids.push(id)\n\n    return this\n  }\n\n  clearBefore (id) {\n    const deleteCnt = this.ids.indexOf(id + 1) || 1\n    this.ids.splice(0, deleteCnt, 0)\n    this.runners.splice(0, deleteCnt, new FakeRunner())\n      .forEach((r) => r.clearTransformsFromQueue())\n    return this\n  }\n\n  edit (id, newRunner) {\n    const index = this.ids.indexOf(id + 1)\n    this.ids.splice(index, 1, id + 1)\n    this.runners.splice(index, 1, newRunner)\n    return this\n  }\n\n  getByID (id) {\n    return this.runners[this.ids.indexOf(id + 1)]\n  }\n\n  length () {\n    return this.ids.length\n  }\n\n  merge () {\n    let lastRunner = null\n    for (let i = 0; i < this.runners.length; ++i) {\n      const runner = this.runners[i]\n\n      const condition = lastRunner\n        && runner.done && lastRunner.done\n        // don't merge runner when persisted on timeline\n        && (!runner._timeline || !runner._timeline._runnerIds.includes(runner.id))\n        && (!lastRunner._timeline || !lastRunner._timeline._runnerIds.includes(lastRunner.id))\n\n      if (condition) {\n        // the +1 happens in the function\n        this.remove(runner.id)\n        const newRunner = runner.mergeWith(lastRunner)\n        this.edit(lastRunner.id, newRunner)\n        lastRunner = newRunner\n        --i\n      } else {\n        lastRunner = runner\n      }\n    }\n\n    return this\n  }\n\n  remove (id) {\n    const index = this.ids.indexOf(id + 1)\n    this.ids.splice(index, 1)\n    this.runners.splice(index, 1)\n    return this\n  }\n\n}\n\nregisterMethods({\n  Element: {\n    animate (duration, delay, when) {\n      const o = Runner.sanitise(duration, delay, when)\n      const timeline = this.timeline()\n      return new Runner(o.duration)\n        .loop(o)\n        .element(this)\n        .timeline(timeline.play())\n        .schedule(o.delay, o.when)\n    },\n\n    delay (by, when) {\n      return this.animate(0, by, when)\n    },\n\n    // this function searches for all runners on the element and deletes the ones\n    // which run before the current one. This is because absolute transformations\n    // overwrite anything anyway so there is no need to waste time computing\n    // other runners\n    _clearTransformRunnersBefore (currentRunner) {\n      this._transformationRunners.clearBefore(currentRunner.id)\n    },\n\n    _currentTransform (current) {\n      return this._transformationRunners.runners\n        // we need the equal sign here to make sure, that also transformations\n        // on the same runner which execute before the current transformation are\n        // taken into account\n        .filter((runner) => runner.id <= current.id)\n        .map(getRunnerTransform)\n        .reduce(lmultiply, new Matrix())\n    },\n\n    _addRunner (runner) {\n      this._transformationRunners.add(runner)\n\n      // Make sure that the runner merge is executed at the very end of\n      // all Animator functions. That is why we use immediate here to execute\n      // the merge right after all frames are run\n      Animator.cancelImmediate(this._frameId)\n      this._frameId = Animator.immediate(mergeTransforms.bind(this))\n    },\n\n    _prepareRunner () {\n      if (this._frameId == null) {\n        this._transformationRunners = new RunnerArray()\n          .add(new FakeRunner(new Matrix(this)))\n      }\n    }\n  }\n})\n\n// Will output the elements from array A that are not in the array B\nconst difference = (a, b) => a.filter(x => !b.includes(x))\n\nextend(Runner, {\n  attr (a, v) {\n    return this.styleAttr('attr', a, v)\n  },\n\n  // Add animatable styles\n  css (s, v) {\n    return this.styleAttr('css', s, v)\n  },\n\n  styleAttr (type, nameOrAttrs, val) {\n    if (typeof nameOrAttrs === 'string') {\n      return this.styleAttr(type, { [nameOrAttrs]: val })\n    }\n\n    let attrs = nameOrAttrs\n    if (this._tryRetarget(type, attrs)) return this\n\n    let morpher = new Morphable(this._stepper).to(attrs)\n    let keys = Object.keys(attrs)\n\n    this.queue(function () {\n      morpher = morpher.from(this.element()[type](keys))\n    }, function (pos) {\n      this.element()[type](morpher.at(pos).valueOf())\n      return morpher.done()\n    }, function (newToAttrs) {\n\n      // Check if any new keys were added\n      const newKeys = Object.keys(newToAttrs)\n      const differences = difference(newKeys, keys)\n\n      // If their are new keys, initialize them and add them to morpher\n      if (differences.length) {\n        // Get the values\n        const addedFromAttrs = this.element()[type](differences)\n\n        // Get the already initialized values\n        const oldFromAttrs = new ObjectBag(morpher.from()).valueOf()\n\n        // Merge old and new\n        Object.assign(oldFromAttrs, addedFromAttrs)\n        morpher.from(oldFromAttrs)\n      }\n\n      // Get the object from the morpher\n      const oldToAttrs = new ObjectBag(morpher.to()).valueOf()\n\n      // Merge in new attributes\n      Object.assign(oldToAttrs, newToAttrs)\n\n      // Change morpher target\n      morpher.to(oldToAttrs)\n\n      // Make sure that we save the work we did so we don't need it to do again\n      keys = newKeys\n      attrs = newToAttrs\n    })\n\n    this._rememberMorpher(type, morpher)\n    return this\n  },\n\n  zoom (level, point) {\n    if (this._tryRetarget('zoom', level, point)) return this\n\n    let morpher = new Morphable(this._stepper).to(new SVGNumber(level))\n\n    this.queue(function () {\n      morpher = morpher.from(this.element().zoom())\n    }, function (pos) {\n      this.element().zoom(morpher.at(pos), point)\n      return morpher.done()\n    }, function (newLevel, newPoint) {\n      point = newPoint\n      morpher.to(newLevel)\n    })\n\n    this._rememberMorpher('zoom', morpher)\n    return this\n  },\n\n  /**\n   ** absolute transformations\n   **/\n\n  //\n  // M v -----|-----(D M v = F v)------|----->  T v\n  //\n  // 1. define the final state (T) and decompose it (once)\n  //    t = [tx, ty, the, lam, sy, sx]\n  // 2. on every frame: pull the current state of all previous transforms\n  //    (M - m can change)\n  //   and then write this as m = [tx0, ty0, the0, lam0, sy0, sx0]\n  // 3. Find the interpolated matrix F(pos) = m + pos * (t - m)\n  //   - Note F(0) = M\n  //   - Note F(1) = T\n  // 4. Now you get the delta matrix as a result: D = F * inv(M)\n\n  transform (transforms, relative, affine) {\n    // If we have a declarative function, we should retarget it if possible\n    relative = transforms.relative || relative\n    if (this._isDeclarative && !relative && this._tryRetarget('transform', transforms)) {\n      return this\n    }\n\n    // Parse the parameters\n    const isMatrix = Matrix.isMatrixLike(transforms)\n    affine = transforms.affine != null\n      ? transforms.affine\n      : (affine != null ? affine : !isMatrix)\n\n    // Create a morpher and set its type\n    const morpher = new Morphable(this._stepper)\n      .type(affine ? TransformBag : Matrix)\n\n    let origin\n    let element\n    let current\n    let currentAngle\n    let startTransform\n\n    function setup () {\n      // make sure element and origin is defined\n      element = element || this.element()\n      origin = origin || getOrigin(transforms, element)\n\n      startTransform = new Matrix(relative ? undefined : element)\n\n      // add the runner to the element so it can merge transformations\n      element._addRunner(this)\n\n      // Deactivate all transforms that have run so far if we are absolute\n      if (!relative) {\n        element._clearTransformRunnersBefore(this)\n      }\n    }\n\n    function run (pos) {\n      // clear all other transforms before this in case something is saved\n      // on this runner. We are absolute. We dont need these!\n      if (!relative) this.clearTransform()\n\n      const { x, y } = new Point(origin).transform(element._currentTransform(this))\n\n      let target = new Matrix({ ...transforms, origin: [ x, y ] })\n      let start = this._isDeclarative && current\n        ? current\n        : startTransform\n\n      if (affine) {\n        target = target.decompose(x, y)\n        start = start.decompose(x, y)\n\n        // Get the current and target angle as it was set\n        const rTarget = target.rotate\n        const rCurrent = start.rotate\n\n        // Figure out the shortest path to rotate directly\n        const possibilities = [ rTarget - 360, rTarget, rTarget + 360 ]\n        const distances = possibilities.map(a => Math.abs(a - rCurrent))\n        const shortest = Math.min(...distances)\n        const index = distances.indexOf(shortest)\n        target.rotate = possibilities[index]\n      }\n\n      if (relative) {\n        // we have to be careful here not to overwrite the rotation\n        // with the rotate method of Matrix\n        if (!isMatrix) {\n          target.rotate = transforms.rotate || 0\n        }\n        if (this._isDeclarative && currentAngle) {\n          start.rotate = currentAngle\n        }\n      }\n\n      morpher.from(start)\n      morpher.to(target)\n\n      const affineParameters = morpher.at(pos)\n      currentAngle = affineParameters.rotate\n      current = new Matrix(affineParameters)\n\n      this.addTransform(current)\n      element._addRunner(this)\n      return morpher.done()\n    }\n\n    function retarget (newTransforms) {\n      // only get a new origin if it changed since the last call\n      if (\n        (newTransforms.origin || 'center').toString()\n        !== (transforms.origin || 'center').toString()\n      ) {\n        origin = getOrigin(newTransforms, element)\n      }\n\n      // overwrite the old transformations with the new ones\n      transforms = { ...newTransforms, origin }\n    }\n\n    this.queue(setup, run, retarget, true)\n    this._isDeclarative && this._rememberMorpher('transform', morpher)\n    return this\n  },\n\n  // Animatable x-axis\n  x (x, relative) {\n    return this._queueNumber('x', x)\n  },\n\n  // Animatable y-axis\n  y (y) {\n    return this._queueNumber('y', y)\n  },\n\n  dx (x = 0) {\n    return this._queueNumberDelta('x', x)\n  },\n\n  dy (y = 0) {\n    return this._queueNumberDelta('y', y)\n  },\n\n  dmove (x, y) {\n    return this.dx(x).dy(y)\n  },\n\n  _queueNumberDelta (method, to) {\n    to = new SVGNumber(to)\n\n    // Try to change the target if we have this method already registered\n    if (this._tryRetarget(method, to)) return this\n\n    // Make a morpher and queue the animation\n    const morpher = new Morphable(this._stepper).to(to)\n    let from = null\n    this.queue(function () {\n      from = this.element()[method]()\n      morpher.from(from)\n      morpher.to(from + to)\n    }, function (pos) {\n      this.element()[method](morpher.at(pos))\n      return morpher.done()\n    }, function (newTo) {\n      morpher.to(from + new SVGNumber(newTo))\n    })\n\n    // Register the morpher so that if it is changed again, we can retarget it\n    this._rememberMorpher(method, morpher)\n    return this\n  },\n\n  _queueObject (method, to) {\n    // Try to change the target if we have this method already registered\n    if (this._tryRetarget(method, to)) return this\n\n    // Make a morpher and queue the animation\n    const morpher = new Morphable(this._stepper).to(to)\n    this.queue(function () {\n      morpher.from(this.element()[method]())\n    }, function (pos) {\n      this.element()[method](morpher.at(pos))\n      return morpher.done()\n    })\n\n    // Register the morpher so that if it is changed again, we can retarget it\n    this._rememberMorpher(method, morpher)\n    return this\n  },\n\n  _queueNumber (method, value) {\n    return this._queueObject(method, new SVGNumber(value))\n  },\n\n  // Animatable center x-axis\n  cx (x) {\n    return this._queueNumber('cx', x)\n  },\n\n  // Animatable center y-axis\n  cy (y) {\n    return this._queueNumber('cy', y)\n  },\n\n  // Add animatable move\n  move (x, y) {\n    return this.x(x).y(y)\n  },\n\n  // Add animatable center\n  center (x, y) {\n    return this.cx(x).cy(y)\n  },\n\n  // Add animatable size\n  size (width, height) {\n    // animate bbox based size for all other elements\n    let box\n\n    if (!width || !height) {\n      box = this._element.bbox()\n    }\n\n    if (!width) {\n      width = box.width / box.height * height\n    }\n\n    if (!height) {\n      height = box.height / box.width * width\n    }\n\n    return this\n      .width(width)\n      .height(height)\n  },\n\n  // Add animatable width\n  width (width) {\n    return this._queueNumber('width', width)\n  },\n\n  // Add animatable height\n  height (height) {\n    return this._queueNumber('height', height)\n  },\n\n  // Add animatable plot\n  plot (a, b, c, d) {\n    // Lines can be plotted with 4 arguments\n    if (arguments.length === 4) {\n      return this.plot([ a, b, c, d ])\n    }\n\n    if (this._tryRetarget('plot', a)) return this\n\n    const morpher = new Morphable(this._stepper)\n      .type(this._element.MorphArray).to(a)\n\n    this.queue(function () {\n      morpher.from(this._element.array())\n    }, function (pos) {\n      this._element.plot(morpher.at(pos))\n      return morpher.done()\n    })\n\n    this._rememberMorpher('plot', morpher)\n    return this\n  },\n\n  // Add leading method\n  leading (value) {\n    return this._queueNumber('leading', value)\n  },\n\n  // Add animatable viewbox\n  viewbox (x, y, width, height) {\n    return this._queueObject('viewbox', new Box(x, y, width, height))\n  },\n\n  update (o) {\n    if (typeof o !== 'object') {\n      return this.update({\n        offset: arguments[0],\n        color: arguments[1],\n        opacity: arguments[2]\n      })\n    }\n\n    if (o.opacity != null) this.attr('stop-opacity', o.opacity)\n    if (o.color != null) this.attr('stop-color', o.color)\n    if (o.offset != null) this.attr('offset', o.offset)\n\n    return this\n  }\n})\n\nextend(Runner, { rx, ry, from, to })\nregister(Runner, 'Runner')\n", "import {\n  adopt,\n  nodeOrNew,\n  register,\n  wrapWithAttrCheck\n} from '../utils/adopter.js'\nimport { svg, svgjs, xlink, xmlns } from '../modules/core/namespaces.js'\nimport { registerMethods } from '../utils/methods.js'\nimport Container from './Container.js'\nimport Defs from './Defs.js'\nimport { globals } from '../utils/window.js'\n\nexport default class Svg extends Container {\n  constructor (node, attrs = node) {\n    super(nodeOrNew('svg', node), attrs)\n    this.namespace()\n  }\n\n  // Creates and returns defs element\n  defs () {\n    if (!this.isRoot()) return this.root().defs()\n\n    return adopt(this.node.querySelector('defs'))\n      || this.put(new Defs())\n  }\n\n  isRoot () {\n    return !this.node.parentNode\n      || (!(this.node.parentNode instanceof globals.window.SVGElement) && this.node.parentNode.nodeName !== '#document-fragment')\n  }\n\n  // Add namespaces\n  namespace () {\n    if (!this.isRoot()) return this.root().namespace()\n    return this\n      .attr({ xmlns: svg, version: '1.1' })\n      .attr('xmlns:xlink', xlink, xmlns)\n      .attr('xmlns:svgjs', svgjs, xmlns)\n  }\n\n  removeNamespace () {\n    return this.attr({ xmlns: null, version: null })\n      .attr('xmlns:xlink', null, xmlns)\n      .attr('xmlns:svgjs', null, xmlns)\n  }\n\n  // Check if this is a root svg\n  // If not, call root() from this element\n  root () {\n    if (this.isRoot()) return this\n    return super.root()\n  }\n\n}\n\nregisterMethods({\n  Container: {\n    // Create nested svg document\n    nested: wrapWithAttrCheck(function () {\n      return this.put(new Svg())\n    })\n  }\n})\n\nregister(Svg, 'Svg', true)\n", "import { nodeOrNew, register, wrapWithAttrCheck } from '../utils/adopter.js'\nimport { registerMethods } from '../utils/methods.js'\nimport Container from './Container.js'\n\nexport default class Symbol extends Container {\n  // Initialize node\n  constructor (node, attrs = node) {\n    super(nodeOrNew('symbol', node), attrs)\n  }\n}\n\nregisterMethods({\n  Container: {\n    symbol: wrapWithAttrCheck(function () {\n      return this.put(new Symbol())\n    })\n  }\n})\n\nregister(Symbol, 'Symbol')\n", "import { globals } from '../../utils/window.js'\n\n// Create plain text node\nexport function plain (text) {\n  // clear if build mode is disabled\n  if (this._build === false) {\n    this.clear()\n  }\n\n  // create text node\n  this.node.appendChild(globals.document.createTextNode(text))\n\n  return this\n}\n\n// Get length of text element\nexport function length () {\n  return this.node.getComputedTextLength()\n}\n\n// Move over x-axis\n// Text is moved by its bounding box\n// text-anchor does NOT matter\nexport function x (x, box = this.bbox()) {\n  if (x == null) {\n    return box.x\n  }\n\n  return this.attr('x', this.attr('x') + x - box.x)\n}\n\n// Move over y-axis\nexport function y (y, box = this.bbox()) {\n  if (y == null) {\n    return box.y\n  }\n\n  return this.attr('y', this.attr('y') + y - box.y)\n}\n\nexport function move (x, y, box = this.bbox()) {\n  return this.x(x, box).y(y, box)\n}\n\n// Move center over x-axis\nexport function cx (x, box = this.bbox()) {\n  if (x == null) {\n    return box.cx\n  }\n\n  return this.attr('x', this.attr('x') + x - box.cx)\n}\n\n// Move center over y-axis\nexport function cy (y, box = this.bbox()) {\n  if (y == null) {\n    return box.cy\n  }\n\n  return this.attr('y', this.attr('y') + y - box.cy)\n}\n\nexport function center (x, y, box = this.bbox()) {\n  return this.cx(x, box).cy(y, box)\n}\n\nexport function ax (x) {\n  return this.attr('x', x)\n}\n\nexport function ay (y) {\n  return this.attr('y', y)\n}\n\nexport function amove (x, y) {\n  return this.ax(x).ay(y)\n}\n\n// Enable / disable build mode\nexport function build (build) {\n  this._build = !!build\n  return this\n}\n", "import {\n  adopt,\n  extend,\n  nodeOrNew,\n  register,\n  wrapWithAttrCheck\n} from '../utils/adopter.js'\nimport { registerMethods } from '../utils/methods.js'\nimport SVGNumber from '../types/SVGNumber.js'\nimport Shape from './Shape.js'\nimport { globals } from '../utils/window.js'\nimport * as textable from '../modules/core/textable.js'\n\nexport default class Text extends Shape {\n  // Initialize node\n  constructor (node, attrs = node) {\n    super(nodeOrNew('text', node), attrs)\n\n    this.dom.leading = new SVGNumber(1.3) // store leading value for rebuilding\n    this._rebuild = true // enable automatic updating of dy values\n    this._build = false // disable build mode for adding multiple lines\n  }\n\n  // Set / get leading\n  leading (value) {\n    // act as getter\n    if (value == null) {\n      return this.dom.leading\n    }\n\n    // act as setter\n    this.dom.leading = new SVGNumber(value)\n\n    return this.rebuild()\n  }\n\n  // Rebuild appearance type\n  rebuild (rebuild) {\n    // store new rebuild flag if given\n    if (typeof rebuild === 'boolean') {\n      this._rebuild = rebuild\n    }\n\n    // define position of all lines\n    if (this._rebuild) {\n      const self = this\n      let blankLineOffset = 0\n      const leading = this.dom.leading\n\n      this.each(function (i) {\n        const fontSize = globals.window.getComputedStyle(this.node)\n          .getPropertyValue('font-size')\n\n        const dy = leading * new SVGNumber(fontSize)\n\n        if (this.dom.newLined) {\n          this.attr('x', self.attr('x'))\n\n          if (this.text() === '\\n') {\n            blankLineOffset += dy\n          } else {\n            this.attr('dy', i ? dy + blankLineOffset : 0)\n            blankLineOffset = 0\n          }\n        }\n      })\n\n      this.fire('rebuild')\n    }\n\n    return this\n  }\n\n  // overwrite method from parent to set data properly\n  setData (o) {\n    this.dom = o\n    this.dom.leading = new SVGNumber(o.leading || 1.3)\n    return this\n  }\n\n  // Set the text content\n  text (text) {\n    // act as getter\n    if (text === undefined) {\n      const children = this.node.childNodes\n      let firstLine = 0\n      text = ''\n\n      for (let i = 0, len = children.length; i < len; ++i) {\n        // skip textPaths - they are no lines\n        if (children[i].nodeName === 'textPath') {\n          if (i === 0) firstLine = 1\n          continue\n        }\n\n        // add newline if its not the first child and newLined is set to true\n        if (i !== firstLine && children[i].nodeType !== 3 && adopt(children[i]).dom.newLined === true) {\n          text += '\\n'\n        }\n\n        // add content of this node\n        text += children[i].textContent\n      }\n\n      return text\n    }\n\n    // remove existing content\n    this.clear().build(true)\n\n    if (typeof text === 'function') {\n      // call block\n      text.call(this, this)\n    } else {\n      // store text and make sure text is not blank\n      text = (text + '').split('\\n')\n\n      // build new lines\n      for (let j = 0, jl = text.length; j < jl; j++) {\n        this.newLine(text[j])\n      }\n    }\n\n    // disable build mode and rebuild lines\n    return this.build(false).rebuild()\n  }\n\n}\n\nextend(Text, textable)\n\nregisterMethods({\n  Container: {\n    // Create text element\n    text: wrapWithAttrCheck(function (text = '') {\n      return this.put(new Text()).text(text)\n    }),\n\n    // Create plain text element\n    plain: wrapWithAttrCheck(function (text = '') {\n      return this.put(new Text()).plain(text)\n    })\n  }\n})\n\nregister(Text, 'Text')\n", "import {\n  extend,\n  nodeOrNew,\n  register,\n  wrapWithAttrCheck\n} from '../utils/adopter.js'\nimport { globals } from '../utils/window.js'\nimport { registerMethods } from '../utils/methods.js'\nimport SVGNumber from '../types/SVGNumber.js'\nimport Shape from './Shape.js'\nimport Text from './Text.js'\nimport * as textable from '../modules/core/textable.js'\n\nexport default class Tspan extends Shape {\n  // Initialize node\n  constructor (node, attrs = node) {\n    super(nodeOrNew('tspan', node), attrs)\n    this._build = false // disable build mode for adding multiple lines\n  }\n\n  // Shortcut dx\n  dx (dx) {\n    return this.attr('dx', dx)\n  }\n\n  // Shortcut dy\n  dy (dy) {\n    return this.attr('dy', dy)\n  }\n\n  // Create new line\n  newLine () {\n    // mark new line\n    this.dom.newLined = true\n\n    // fetch parent\n    const text = this.parent()\n\n    // early return in case we are not in a text element\n    if (!(text instanceof Text)) {\n      return this\n    }\n\n    const i = text.index(this)\n\n    const fontSize = globals.window.getComputedStyle(this.node)\n      .getPropertyValue('font-size')\n    const dy = text.dom.leading * new SVGNumber(fontSize)\n\n    // apply new position\n    return this.dy(i ? dy : 0).attr('x', text.x())\n  }\n\n  // Set text content\n  text (text) {\n    if (text == null) return this.node.textContent + (this.dom.newLined ? '\\n' : '')\n\n    if (typeof text === 'function') {\n      this.clear().build(true)\n      text.call(this, this)\n      this.build(false)\n    } else {\n      this.plain(text)\n    }\n\n    return this\n  }\n\n}\n\nextend(Tspan, textable)\n\nregisterMethods({\n  Tspan: {\n    tspan: wrapWithAttrCheck(function (text = '') {\n      const tspan = new Tspan()\n\n      // clear if build mode is disabled\n      if (!this._build) {\n        this.clear()\n      }\n\n      // add new tspan\n      return this.put(tspan).text(text)\n    })\n  },\n  Text: {\n    newLine: function (text = '') {\n      return this.tspan(text).newLine()\n    }\n  }\n})\n\nregister(Tspan, 'Tspan')\n", "import { cx, cy, height, width, x, y } from '../modules/core/circled.js'\nimport {\n  extend,\n  nodeOrNew,\n  register,\n  wrapWithAttrCheck\n} from '../utils/adopter.js'\nimport { registerMethods } from '../utils/methods.js'\nimport SVGNumber from '../types/SVGNumber.js'\nimport Shape from './Shape.js'\n\nexport default class Circle extends Shape {\n  constructor (node, attrs = node) {\n    super(nodeOrNew('circle', node), attrs)\n  }\n\n  radius (r) {\n    return this.attr('r', r)\n  }\n\n  // Radius x value\n  rx (rx) {\n    return this.attr('r', rx)\n  }\n\n  // Alias radius x value\n  ry (ry) {\n    return this.rx(ry)\n  }\n\n  size (size) {\n    return this.radius(new SVGNumber(size).divide(2))\n  }\n}\n\nextend(Circle, { x, y, cx, cy, width, height })\n\nregisterMethods({\n  Container: {\n    // Create circle element\n    circle: wrapWithAttrCheck(function (size = 0) {\n      return this.put(new Circle())\n        .size(size)\n        .move(0, 0)\n    })\n  }\n})\n\nregister(Circle, 'Circle')\n", "import { nodeOrNew, register, wrapWithAttrCheck } from '../utils/adopter.js'\nimport { registerMethods } from '../utils/methods.js'\nimport Container from './Container.js'\nimport baseFind from '../modules/core/selector.js'\n\nexport default class ClipPath extends Container {\n  constructor (node, attrs = node) {\n    super(nodeOrNew('clipPath', node), attrs)\n  }\n\n  // Unclip all clipped elements and remove itself\n  remove () {\n    // unclip all targets\n    this.targets().forEach(function (el) {\n      el.unclip()\n    })\n\n    // remove clipPath from parent\n    return super.remove()\n  }\n\n  targets () {\n    return baseFind('svg [clip-path*=' + this.id() + ']')\n  }\n}\n\nregisterMethods({\n  Container: {\n    // Create clipping element\n    clip: wrapWithAttrCheck(function () {\n      return this.defs().put(new ClipPath())\n    })\n  },\n  Element: {\n    // Distribute clipPath to svg element\n    clipper () {\n      return this.reference('clip-path')\n    },\n\n    clipWith (element) {\n      // use given clip or create a new one\n      const clipper = element instanceof ClipPath\n        ? element\n        : this.parent().clip().add(element)\n\n      // apply mask\n      return this.attr('clip-path', 'url(#' + clipper.id() + ')')\n    },\n\n    // Unclip element\n    unclip () {\n      return this.attr('clip-path', null)\n    }\n  }\n})\n\nregister(ClipPath, 'ClipPath')\n", "import { nodeOrNew, register, wrapWithAttrCheck } from '../utils/adopter.js'\nimport { registerMethods } from '../utils/methods.js'\nimport Element from './Element.js'\n\nexport default class ForeignObject extends Element {\n  constructor (node, attrs = node) {\n    super(nodeOrNew('foreignObject', node), attrs)\n  }\n}\n\nregisterMethods({\n  Container: {\n    foreignObject: wrapWithAttrCheck(function (width, height) {\n      return this.put(new ForeignObject()).size(width, height)\n    })\n  }\n})\n\nregister(ForeignObject, 'ForeignObject')\n", "import Matrix from '../../types/Matrix.js'\nimport Point from '../../types/Point.js'\nimport { proportionalSize } from '../../utils/utils.js'\n\nexport function dmove (dx, dy) {\n  this.children().forEach((child, i) => {\n\n    let bbox\n\n    // We have to wrap this for elements that dont have a bbox\n    // e.g. title and other descriptive elements\n    try {\n      // Get the childs bbox\n      bbox = child.bbox()\n    } catch (e) {\n      return\n    }\n\n    // Get childs matrix\n    const m = new Matrix(child)\n    // Translate childs matrix by amount and\n    // transform it back into parents space\n    const matrix = m.translate(dx, dy).transform(m.inverse())\n    // Calculate new x and y from old box\n    const p = new Point(bbox.x, bbox.y).transform(matrix)\n    // Move element\n    child.move(p.x, p.y)\n  })\n\n  return this\n}\n\nexport function dx (dx) {\n  return this.dmove(dx, 0)\n}\n\nexport function dy (dy) {\n  return this.dmove(0, dy)\n}\n\nexport function height (height, box = this.bbox()) {\n  if (height == null) return box.height\n  return this.size(box.width, height, box)\n}\n\nexport function move (x = 0, y = 0, box = this.bbox()) {\n  const dx = x - box.x\n  const dy = y - box.y\n\n  return this.dmove(dx, dy)\n}\n\nexport function size (width, height, box = this.bbox()) {\n  const p = proportionalSize(this, width, height, box)\n  const scaleX = p.width / box.width\n  const scaleY = p.height / box.height\n\n  this.children().forEach((child, i) => {\n    const o = new Point(box).transform(new Matrix(child).inverse())\n    child.scale(scaleX, scaleY, o.x, o.y)\n  })\n\n  return this\n}\n\nexport function width (width, box = this.bbox()) {\n  if (width == null) return box.width\n  return this.size(width, box.height, box)\n}\n\nexport function x (x, box = this.bbox()) {\n  if (x == null) return box.x\n  return this.move(x, box.y, box)\n}\n\nexport function y (y, box = this.bbox()) {\n  if (y == null) return box.y\n  return this.move(box.x, y, box)\n}\n", "import { nodeOrNew, register, wrapWithAttrCheck, extend } from '../utils/adopter.js'\nimport { registerMethods } from '../utils/methods.js'\nimport Container from './Container.js'\nimport * as containerGeometry from '../modules/core/containerGeometry.js'\n\nexport default class G extends Container {\n  constructor (node, attrs = node) {\n    super(nodeOrNew('g', node), attrs)\n  }\n}\n\nextend(G, containerGeometry)\n\nregisterMethods({\n  Container: {\n    // Create a group element\n    group: wrapWithAttrCheck(function () {\n      return this.put(new G())\n    })\n  }\n})\n\nregister(G, 'G')\n", "import { nodeOrNew, register, wrapWithAttrCheck, extend } from '../utils/adopter.js'\nimport { registerMethods } from '../utils/methods.js'\nimport { xlink } from '../modules/core/namespaces.js'\nimport Container from './Container.js'\nimport * as containerGeometry from '../modules/core/containerGeometry.js'\n\nexport default class A extends Container {\n  constructor (node, attrs = node) {\n    super(nodeOrNew('a', node), attrs)\n  }\n\n  // Link target attribute\n  target (target) {\n    return this.attr('target', target)\n  }\n\n  // Link url\n  to (url) {\n    return this.attr('href', url, xlink)\n  }\n\n}\n\nextend(A, containerGeometry)\n\nregisterMethods({\n  Container: {\n    // Create a hyperlink element\n    link: wrapWithAttrCheck(function (url) {\n      return this.put(new A()).to(url)\n    })\n  },\n  Element: {\n    unlink () {\n      const link = this.linker()\n\n      if (!link) return this\n\n      const parent = link.parent()\n\n      if (!parent) {\n        return this.remove()\n      }\n\n      const index = parent.index(link)\n      parent.add(this, index)\n\n      link.remove()\n      return this\n    },\n    linkTo (url) {\n      // reuse old link if possible\n      let link = this.linker()\n\n      if (!link) {\n        link = new A()\n        this.wrap(link)\n      }\n\n      if (typeof url === 'function') {\n        url.call(link, link)\n      } else {\n        link.to(url)\n      }\n\n      return this\n    },\n    linker () {\n      const link = this.parent()\n      if (link && link.node.nodeName.toLowerCase() === 'a') {\n        return link\n      }\n\n      return null\n    }\n  }\n})\n\nregister(A, 'A')\n", "import { nodeOrNew, register, wrapWithAttrCheck } from '../utils/adopter.js'\nimport { registerMethods } from '../utils/methods.js'\nimport Container from './Container.js'\nimport baseFind from '../modules/core/selector.js'\n\nexport default class Mask extends Container {\n  // Initialize node\n  constructor (node, attrs = node) {\n    super(nodeOrNew('mask', node), attrs)\n  }\n\n  // Unmask all masked elements and remove itself\n  remove () {\n    // unmask all targets\n    this.targets().forEach(function (el) {\n      el.unmask()\n    })\n\n    // remove mask from parent\n    return super.remove()\n  }\n\n  targets () {\n    return baseFind('svg [mask*=' + this.id() + ']')\n  }\n}\n\nregisterMethods({\n  Container: {\n    mask: wrapWithAttrCheck(function () {\n      return this.defs().put(new Mask())\n    })\n  },\n  Element: {\n    // Distribute mask to svg element\n    masker () {\n      return this.reference('mask')\n    },\n\n    maskWith (element) {\n      // use given mask or create a new one\n      const masker = element instanceof Mask\n        ? element\n        : this.parent().mask().add(element)\n\n      // apply mask\n      return this.attr('mask', 'url(#' + masker.id() + ')')\n    },\n\n    // Unmask element\n    unmask () {\n      return this.attr('mask', null)\n    }\n  }\n})\n\nregister(Mask, 'Mask')\n", "import { nodeOrNew, register } from '../utils/adopter.js'\nimport Element from './Element.js'\nimport SVGNumber from '../types/SVGNumber.js'\nimport { registerMethods } from '../utils/methods.js'\n\nexport default class Stop extends Element {\n  constructor (node, attrs = node) {\n    super(nodeOrNew('stop', node), attrs)\n  }\n\n  // add color stops\n  update (o) {\n    if (typeof o === 'number' || o instanceof SVGNumber) {\n      o = {\n        offset: arguments[0],\n        color: arguments[1],\n        opacity: arguments[2]\n      }\n    }\n\n    // set attributes\n    if (o.opacity != null) this.attr('stop-opacity', o.opacity)\n    if (o.color != null) this.attr('stop-color', o.color)\n    if (o.offset != null) this.attr('offset', new SVGNumber(o.offset))\n\n    return this\n  }\n}\n\nregisterMethods({\n  Gradient: {\n    // Add a color stop\n    stop: function (offset, color, opacity) {\n      return this.put(new Stop()).update(offset, color, opacity)\n    }\n  }\n})\n\nregister(Stop, 'Stop')\n", "import { nodeOrNew, register } from '../utils/adopter.js'\nimport { registerMethods } from '../utils/methods.js'\nimport { unCamelCase } from '../utils/utils.js'\nimport Element from './Element.js'\n\nfunction cssRule (selector, rule) {\n  if (!selector) return ''\n  if (!rule) return selector\n\n  let ret = selector + '{'\n\n  for (const i in rule) {\n    ret += unCamelCase(i) + ':' + rule[i] + ';'\n  }\n\n  ret += '}'\n\n  return ret\n}\n\nexport default class Style extends Element {\n  constructor (node, attrs = node) {\n    super(nodeOrNew('style', node), attrs)\n  }\n\n  addText (w = '') {\n    this.node.textContent += w\n    return this\n  }\n\n  font (name, src, params = {}) {\n    return this.rule('@font-face', {\n      fontFamily: name,\n      src: src,\n      ...params\n    })\n  }\n\n  rule (selector, obj) {\n    return this.addText(cssRule(selector, obj))\n  }\n}\n\nregisterMethods('Dom', {\n  style (selector, obj) {\n    return this.put(new Style()).rule(selector, obj)\n  },\n  fontface  (name, src, params) {\n    return this.put(new Style()).font(name, src, params)\n  }\n})\n\nregister(Style, 'Style')\n", "import { nodeOrNew, register, wrapWithAttrCheck } from '../utils/adopter.js'\nimport { registerMethods } from '../utils/methods.js'\nimport { xlink } from '../modules/core/namespaces.js'\nimport Path from './Path.js'\nimport PathArray from '../types/PathArray.js'\nimport Text from './Text.js'\nimport baseFind from '../modules/core/selector.js'\n\nexport default class TextPath extends Text {\n  // Initialize node\n  constructor (node, attrs = node) {\n    super(nodeOrNew('textPath', node), attrs)\n  }\n\n  // return the array of the path track element\n  array () {\n    const track = this.track()\n\n    return track ? track.array() : null\n  }\n\n  // Plot path if any\n  plot (d) {\n    const track = this.track()\n    let pathArray = null\n\n    if (track) {\n      pathArray = track.plot(d)\n    }\n\n    return (d == null) ? pathArray : this\n  }\n\n  // Get the path element\n  track () {\n    return this.reference('href')\n  }\n}\n\nregisterMethods({\n  Container: {\n    textPath: wrapWithAttrCheck(function (text, path) {\n      // Convert text to instance if needed\n      if (!(text instanceof Text)) {\n        text = this.text(text)\n      }\n\n      return text.path(path)\n    })\n  },\n  Text: {\n    // Create path for text to run on\n    path: wrapWithAttrCheck(function (track, importNodes = true) {\n      const textPath = new TextPath()\n\n      // if track is a path, reuse it\n      if (!(track instanceof Path)) {\n        // create path element\n        track = this.defs().path(track)\n      }\n\n      // link textPath to path and add content\n      textPath.attr('href', '#' + track, xlink)\n\n      // Transplant all nodes from text to textPath\n      let node\n      if (importNodes) {\n        while ((node = this.node.firstChild)) {\n          textPath.node.appendChild(node)\n        }\n      }\n\n      // add textPath element as child node and return textPath\n      return this.put(textPath)\n    }),\n\n    // Get the textPath children\n    textPath () {\n      return this.findOne('textPath')\n    }\n  },\n  Path: {\n    // creates a textPath from this path\n    text: wrapWithAttrCheck(function (text) {\n      // Convert text to instance if needed\n      if (!(text instanceof Text)) {\n        text = new Text().addTo(this.parent()).text(text)\n      }\n\n      // Create textPath from text and path and return\n      return text.path(this)\n    }),\n\n    targets () {\n      return baseFind('svg textPath').filter((node) => {\n        return (node.attr('href') || '').includes(this.id())\n      })\n\n      // Does not work in IE11. Use when IE support is dropped\n      // return baseFind('svg textPath[*|href*=' + this.id() + ']')\n    }\n  }\n})\n\nTextPath.prototype.MorphArray = PathArray\nregister(TextPath, 'TextPath')\n", "import { nodeOrNew, register, wrapWithAttrCheck } from '../utils/adopter.js'\nimport { registerMethods } from '../utils/methods.js'\nimport { xlink } from '../modules/core/namespaces.js'\nimport Shape from './Shape.js'\n\nexport default class Use extends Shape {\n  constructor (node, attrs = node) {\n    super(nodeOrNew('use', node), attrs)\n  }\n\n  // Use element as a reference\n  use (element, file) {\n    // Set lined element\n    return this.attr('href', (file || '') + '#' + element, xlink)\n  }\n}\n\nregisterMethods({\n  Container: {\n    // Create a use element\n    use: wrapWithAttrCheck(function (element, file) {\n      return this.put(new Use()).use(element, file)\n    })\n  }\n})\n\nregister(Use, 'Use')\n", "/* Optional Modules */\nimport './modules/optional/arrange.js'\nimport './modules/optional/class.js'\nimport './modules/optional/css.js'\nimport './modules/optional/data.js'\nimport './modules/optional/memory.js'\nimport './modules/optional/sugar.js'\nimport './modules/optional/transform.js'\n\nimport { extend, makeInstance } from './utils/adopter.js'\nimport { getMethodNames, getMethodsFor } from './utils/methods.js'\nimport Box from './types/Box.js'\nimport Color from './types/Color.js'\nimport Container from './elements/Container.js'\nimport Defs from './elements/Defs.js'\nimport Dom from './elements/Dom.js'\nimport Element from './elements/Element.js'\nimport Ellipse from './elements/Ellipse.js'\nimport EventTarget from './types/EventTarget.js'\nimport Fragment from './elements/Fragment.js'\nimport Gradient from './elements/Gradient.js'\nimport Image from './elements/Image.js'\nimport Line from './elements/Line.js'\nimport List from './types/List.js'\nimport Marker from './elements/Marker.js'\nimport Matrix from './types/Matrix.js'\nimport Morphable, {\n  NonMorphable,\n  ObjectBag,\n  TransformBag,\n  makeMorphable,\n  registerMorphableType\n} from './animation/Morphable.js'\nimport Path from './elements/Path.js'\nimport PathArray from './types/PathArray.js'\nimport Pattern from './elements/Pattern.js'\nimport PointArray from './types/PointArray.js'\nimport Point from './types/Point.js'\nimport Polygon from './elements/Polygon.js'\nimport Polyline from './elements/Polyline.js'\nimport Rect from './elements/Rect.js'\nimport Runner from './animation/Runner.js'\nimport SVGArray from './types/SVGArray.js'\nimport SVGNumber from './types/SVGNumber.js'\nimport Shape from './elements/Shape.js'\nimport Svg from './elements/Svg.js'\nimport Symbol from './elements/Symbol.js'\nimport Text from './elements/Text.js'\nimport Tspan from './elements/Tspan.js'\nimport * as defaults from './modules/core/defaults.js'\nimport * as utils from './utils/utils.js'\nimport * as namespaces from './modules/core/namespaces.js'\nimport * as regex from './modules/core/regex.js'\n\nexport {\n  Morphable,\n  registerMorphableType,\n  makeMorphable,\n  TransformBag,\n  ObjectBag,\n  NonMorphable\n}\n\nexport { defaults, utils, namespaces, regex }\nexport const SVG = makeInstance\nexport { default as parser } from './modules/core/parser.js'\nexport { default as find } from './modules/core/selector.js'\nexport * from './modules/core/event.js'\nexport * from './utils/adopter.js'\nexport {\n  getWindow,\n  registerWindow,\n  restoreWindow,\n  saveWindow,\n  withWindow\n} from './utils/window.js'\n\n/* Animation Modules */\nexport { default as Animator } from './animation/Animator.js'\nexport { Controller, Ease, PID, Spring, easing } from './animation/Controller.js'\nexport { default as Queue } from './animation/Queue.js'\nexport { default as Runner } from './animation/Runner.js'\nexport { default as Timeline } from './animation/Timeline.js'\n\n/* Types */\nexport { default as Array } from './types/SVGArray.js'\nexport { default as Box } from './types/Box.js'\nexport { default as Color } from './types/Color.js'\nexport { default as EventTarget } from './types/EventTarget.js'\nexport { default as Matrix } from './types/Matrix.js'\nexport { default as Number } from './types/SVGNumber.js'\nexport { default as PathArray } from './types/PathArray.js'\nexport { default as Point } from './types/Point.js'\nexport { default as PointArray } from './types/PointArray.js'\nexport { default as List } from './types/List.js'\n\n/* Elements */\nexport { default as Circle } from './elements/Circle.js'\nexport { default as ClipPath } from './elements/ClipPath.js'\nexport { default as Container } from './elements/Container.js'\nexport { default as Defs } from './elements/Defs.js'\nexport { default as Dom } from './elements/Dom.js'\nexport { default as Element } from './elements/Element.js'\nexport { default as Ellipse } from './elements/Ellipse.js'\nexport { default as ForeignObject } from './elements/ForeignObject.js'\nexport { default as Fragment } from './elements/Fragment.js'\nexport { default as Gradient } from './elements/Gradient.js'\nexport { default as G } from './elements/G.js'\nexport { default as A } from './elements/A.js'\nexport { default as Image } from './elements/Image.js'\nexport { default as Line } from './elements/Line.js'\nexport { default as Marker } from './elements/Marker.js'\nexport { default as Mask } from './elements/Mask.js'\nexport { default as Path } from './elements/Path.js'\nexport { default as Pattern } from './elements/Pattern.js'\nexport { default as Polygon } from './elements/Polygon.js'\nexport { default as Polyline } from './elements/Polyline.js'\nexport { default as Rect } from './elements/Rect.js'\nexport { default as Shape } from './elements/Shape.js'\nexport { default as Stop } from './elements/Stop.js'\nexport { default as Style } from './elements/Style.js'\nexport { default as Svg } from './elements/Svg.js'\nexport { default as Symbol } from './elements/Symbol.js'\nexport { default as Text } from './elements/Text.js'\nexport { default as TextPath } from './elements/TextPath.js'\nexport { default as Tspan } from './elements/Tspan.js'\nexport { default as Use } from './elements/Use.js'\n\nextend([\n  Svg,\n  Symbol,\n  Image,\n  Pattern,\n  Marker\n], getMethodsFor('viewbox'))\n\nextend([\n  Line,\n  Polyline,\n  Polygon,\n  Path\n], getMethodsFor('marker'))\n\nextend(Text, getMethodsFor('Text'))\nextend(Path, getMethodsFor('Path'))\n\nextend(Defs, getMethodsFor('Defs'))\n\nextend([\n  Text,\n  Tspan\n], getMethodsFor('Tspan'))\n\nextend([\n  Rect,\n  Ellipse,\n  Gradient,\n  Runner\n], getMethodsFor('radius'))\n\nextend(EventTarget, getMethodsFor('EventTarget'))\nextend(Dom, getMethodsFor('Dom'))\nextend(Element, getMethodsFor('Element'))\nextend(Shape, getMethodsFor('Shape'))\nextend([ Container, Fragment ], getMethodsFor('Container'))\nextend(Gradient, getMethodsFor('Gradient'))\n\nextend(Runner, getMethodsFor('Runner'))\n\nList.extend(getMethodNames())\n\nregisterMorphableType([\n  SVGNumber,\n  Color,\n  Box,\n  Matrix,\n  SVGArray,\n  PointArray,\n  PathArray,\n  Point\n])\n\nmakeMorphable()\n"],
  "mappings": "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",
  "names": ["methods", "names", "registerMethods", "name", "m", "Array", "isArray", "_name", "addMethodNames", "Object", "getOwnPropertyNames", "assign", "getMethodsFor", "getMethodNames", "Set", "_names", "push", "map", "array", "block", "i", "il", "length", "result", "filter", "radians", "d", "Math", "PI", "degrees", "r", "camelCase", "s", "toLowerCase", "replace", "g", "toUpperCase", "unCamelCase", "capitalize", "charAt", "slice", "proportionalSize", "element", "width", "height", "box", "bbox", "getOrigin", "o", "origin", "ox", "originX", "oy", "originY", "x", "y", "condX", "condY", "includes", "svg", "html", "xmlns", "xlink", "svgjs", "globals", "window", "document", "registerWindow", "win", "doc", "save", "saveWindow", "restoreWindow", "withWindow", "fn", "getWindow", "Base", "elements", "root", "create", "ns", "createElementNS", "makeInstance", "isHTML", "adopter", "querySelector", "wrapper", "createElement", "innerHTML", "firstChild", "removeChild", "nodeOrNew", "node", "ownerDocument", "defaultView", "Node", "adopt", "instance", "nodeName", "Fragment", "className", "mockAdopt", "mock", "register", "asRoot", "prototype", "getClass", "did", "eid", "assignNewId", "children", "id", "extend", "modules", "key", "wrapWithAttrCheck", "args", "constructor", "apply", "attr", "siblings", "parent", "position", "index", "next", "prev", "forward", "p", "add", "remove", "backward", "front", "back", "before", "after", "insertBefore", "insertAfter", "numberAndUnit", "hex", "rgb", "reference", "transforms", "whitespace", "isHex", "isRgb", "isBlank", "isNumber", "isImage", "delimiter", "isPathLetter", "classes", "trim", "split", "hasClass", "indexOf", "addClass", "join", "removeClass", "c", "toggleClass", "css", "style", "val", "ret", "arguments", "cssText", "el", "forEach", "t", "cased", "test", "show", "hide", "visible", "data", "a", "v", "attributes", "JSON", "parse", "e", "stringify", "remember", "k", "memory", "forget", "_memory", "sixDigitHex", "substring", "componentHex", "component", "integer", "round", "bounded", "max", "min", "toString", "is", "object", "space", "getParameters", "b", "params", "_a", "_b", "_c", "_d", "z", "h", "l", "cieSpace", "hueToRgb", "q", "Color", "inputs", "init", "isColor", "color", "random", "mode", "u", "sin", "pi", "grey", "Error", "cmyk", "hsl", "isGrey", "delta", "values", "noWhitespace", "exec", "parseInt", "hexParse", "components", "lab", "xyz", "lch", "sqrt", "atan2", "dToR", "cos", "yL", "xL", "zL", "ct", "mx", "nm", "rU", "gU", "bU", "pow", "bd", "toArray", "toHex", "_clamped", "toRgb", "rV", "gV", "bV", "string", "r255", "g255", "b255", "rL", "gL", "bL", "xU", "yU", "zU", "format", "Point", "clone", "base", "source", "transform", "transformO", "Matrix", "isMatrixLike", "f", "point", "screenCTM", "inverseO", "closeEnough", "threshold", "abs", "formatTransforms", "flipBoth", "flip", "flipX", "flipY", "skewX", "skew", "isFinite", "skewY", "scaleX", "scale", "scaleY", "shear", "theta", "rotate", "around", "px", "positionX", "NaN", "py", "positionY", "translate", "tx", "translateX", "ty", "translateY", "relative", "rx", "relativeX", "ry", "relativeY", "fromArray", "matrixMultiply", "cx", "cy", "matrix", "aroundO", "dx", "dy", "translateO", "lmultiplyO", "decompose", "determinant", "ccw", "sx", "thetaRad", "st", "lam", "sy", "equals", "other", "comp", "axis", "flipO", "scaleO", "Element", "matrixify", "parseFloat", "call", "inverse", "det", "na", "nb", "nc", "nd", "ne", "nf", "lmultiply", "multiply", "multiplyO", "rotateO", "shearO", "lx", "skewO", "tan", "ly", "current", "transformer", "valueOf", "ctm", "getCTM", "isRoot", "rect", "getScreenCTM", "parser", "nodes", "size", "path", "parentNode", "body", "documentElement", "addTo", "isNulledBox", "domContains", "contains", "Box", "addOffset", "pageXOffset", "pageYOffset", "left", "top", "w", "x2", "y2", "isNulled", "merge", "xMin", "Infinity", "xMax", "yMin", "yMax", "pts", "getBox", "getBBoxFn", "retry", "getBBox", "rbox", "getRBox", "getBoundingClientRect", "inside", "viewbox", "zoom", "level", "clientWidth", "clientHeight", "zoomX", "zoomY", "zoomAmount", "Number", "MAX_SAFE_INTEGER", "List", "arr", "each", "fnOrMethodName", "concat", "reserved", "reduce", "obj", "attrs", "baseFind", "query", "querySelectorAll", "find", "findOne", "listenerId", "windowEvents", "getEvents", "n", "getEventHolder", "events", "getEventTarget", "clearEvents", "on", "listener", "binding", "options", "bind", "bag", "_svgjsListenerId", "event", "ev", "addEventListener", "off", "namespace", "removeEventListener", "dispatch", "Event", "dispatchEvent", "CustomEvent", "detail", "cancelable", "EventTarget", "type", "j", "defaultPrevented", "fire", "noop", "timeline", "duration", "ease", "delay", "fill", "stroke", "opacity", "offset", "SVGArray", "toSet", "SVGNumber", "convert", "unit", "value", "divide", "number", "isNaN", "match", "minus", "plus", "times", "toJSON", "hooks", "registerAttrHook", "nodeValue", "last", "curr", "removeAttribute", "getAttribute", "defaults", "_val", "hook", "leading", "setAttributeNS", "setAttribute", "rebuild", "Dom", "removeNamespace", "SVGElement", "appendChild", "childNodes", "put", "clear", "hasChildNodes", "lastChild", "deep", "assignNewIds", "writeDataToDom", "nodeClone", "cloneNode", "first", "get", "has", "htmlOrFn", "outerHTML", "xml", "matches", "selector", "matcher", "matchesSelector", "msMatchesSelector", "mozMatchesSelector", "webkitMatchesSelector", "oMatchesSelector", "putIn", "removeElement", "replaceChild", "precision", "factor", "svgOrFn", "outerSVG", "words", "text", "textContent", "wrap", "xmlOrFn", "outerXML", "_this", "well", "fragment", "createDocumentFragment", "len", "firstElementChild", "dom", "hasAttribute", "setData", "center", "defs", "dmove", "move", "parents", "until", "isSelector", "keys", "sugar", "prefix", "extension", "mat", "angle", "direction", "radius", "_element", "getTotalLength", "pointAt", "getPointAtLength", "font", "untransform", "str", "kv", "reverse", "toParent", "pCtm", "toRoot", "decomposed", "cleanRelative", "Container", "flatten", "ungroup", "Defs", "Shape", "Ellipse", "circled", "ellipse", "from", "fx", "fy", "x1", "y1", "to", "Gradient", "targets", "url", "update", "gradiented", "gradient", "Pattern", "pattern", "patternUnits", "Image", "load", "callback", "img", "src", "image", "PointArray", "maxX", "maxY", "minX", "minY", "points", "pop", "toLine", "MorphArray", "Line", "plot", "pointed", "line", "Marker", "orient", "ref", "marker", "makeSetterGetter", "easing", "pos", "bezier", "steps", "stepPosition", "jumps", "beforeFlag", "step", "floor", "jumping", "Stepper", "done", "Ease", "Controller", "stepper", "target", "dt", "recalculate", "_duration", "overshoot", "_overshoot", "eps", "os", "log", "zeta", "wn", "Spring", "velocity", "acceleration", "newPosition", "PID", "windup", "integral", "error", "_windup", "P", "I", "D", "segmentParameters", "M", "L", "H", "V", "C", "S", "Q", "T", "A", "Z", "pathHandlers", "p0", "mlhvqtcsaz", "jl", "makeAbsolut", "command", "segment", "segmentComplete", "startNewSegment", "token", "inNumber", "finalizeNumber", "pathLetter", "lastCommand", "small", "isSmall", "inSegment", "pointSeen", "hasExponent", "finalizeSegment", "absolute", "segments", "isArcFlag", "isArc", "isExponential", "lastToken", "pathParser", "toAbsolute", "arrayToString", "PathArray", "getClassForType", "NonMorphable", "morphableTypes", "ObjectBag", "Morphable", "_stepper", "_from", "_to", "_type", "_context", "_morphObj", "at", "morph", "complete", "_set", "align", "toConsumable", "TransformBag", "sortByKey", "splice", "defaultObject", "toDelete", "objOrArr", "entries", "Type", "sort", "shift", "num", "registerMorphableType", "makeMorphable", "context", "mapper", "Path", "_array", "Polygon", "polygon", "poly", "Polyline", "polyline", "Rect", "Queue", "_first", "_last", "item", "Animator", "nextDraw", "frames", "timeouts", "immediates", "timer", "performance", "Date", "frame", "run", "requestAnimationFrame", "_draw", "timeout", "time", "now", "immediate", "cancelFrame", "clearTimeout", "cancelImmediate", "nextTimeout", "lastTimeout", "nextFrame", "lastFrame", "nextImmediate", "makeSchedule", "runnerInfo", "start", "runner", "end", "defaultSource", "Timeline", "timeSource", "_timeSource", "_startTime", "_speed", "_persist", "_nextFrame", "_paused", "_runners", "_runnerIds", "_lastRunnerId", "_time", "_lastSourceTime", "_lastStepTime", "_step", "_stepFn", "_stepImmediate", "active", "finish", "getEndTimeOfTimeline", "pause", "getEndTime", "lastRunnerInfo", "getLastRunnerInfo", "lastDuration", "lastStartTime", "endTimes", "getRunnerInfoById", "_continue", "persist", "dtOrForever", "play", "updateTime", "yes", "currentSpeed", "speed", "positive", "schedule", "when", "absoluteStartTime", "endTime", "unschedule", "info", "seek", "stop", "immediateStep", "dtSource", "dtTime", "dtToStart", "reset", "runnersLeft", "finished", "_timeline", "Runner", "_queue", "_isDeclarative", "_history", "enabled", "_lastTime", "_reseted", "transformId", "_haveReversed", "_reverse", "_loopsDone", "_swing", "_wait", "_times", "_frameId", "sanitise", "swing", "wait", "addTransform", "animate", "loop", "clearTransform", "clearTransformsFromQueue", "isTransform", "during", "queue", "_prepareRunner", "loops", "loopDuration", "loopsDone", "relativeTime", "whole", "partial", "swinging", "backwards", "uncliped", "clipped", "swingForward", "forwards", "progress", "initFn", "runFn", "retargetFn", "initialiser", "retarget", "initialised", "running", "_lastPosition", "justStarted", "justFinished", "declarative", "converged", "_initialise", "_run", "needsIt", "_rememberMorpher", "method", "morpher", "caller", "positionOrDt", "allfinished", "_tryRetarget", "extra", "FakeRunner", "mergeWith", "getRunnerTransform", "mergeTransforms", "runners", "_transformationRunners", "netTransform", "RunnerArray", "ids", "clearBefore", "deleteCnt", "edit", "newRunner", "getByID", "lastRunner", "condition", "by", "_clearTransformRunnersBefore", "currentRunner", "_currentTransform", "_addRunner", "difference", "styleAttr", "nameOrAttrs", "newToAttrs", "newKeys", "differences", "addedFromAttrs", "oldFromAttrs", "oldToAttrs", "newLevel", "newPoint", "affine", "isMatrix", "currentAngle", "startTransform", "setup", "undefined", "rTarget", "rCurrent", "possibilities", "distances", "shortest", "affineParameters", "newTransforms", "_queueNumber", "_queueNumberDelta", "newTo", "_queueObject", "Svg", "version", "nested", "Symbol", "symbol", "plain", "_build", "createTextNode", "getComputedTextLength", "ax", "ay", "amove", "build", "Text", "_rebuild", "self", "blankLineOffset", "fontSize", "getComputedStyle", "getPropertyValue", "newLined", "firstLine", "nodeType", "newLine", "textable", "Tspan", "tspan", "Circle", "circle", "ClipPath", "unclip", "clip", "clipper", "clipWith", "ForeignObject", "foreignObject", "child", "G", "containerGeometry", "group", "link", "unlink", "linker", "linkTo", "Mask", "unmask", "mask", "masker", "maskWith", "Stop", "cssRule", "rule", "Style", "addText", "fontFamily", "fontface", "TextPath", "track", "pathArray", "textPath", "importNodes", "Use", "use", "file", "SVG"]
}
